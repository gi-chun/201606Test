/*! Alopex UI - v2.3.0 - 2015-04-02
* http://ui.alopex.io
* Copyright (c) 2015 alopex.ui; Licensed Copyright. SK C&C. All rights reserved. */
+function(a){function b(a){return Pb[a]||a}function c(a){return String(a).replace(/[&<>"'\s\u00A0]/g,b)}function d(){return Ob+Nb++}function e(){return Nb++}function f(){if(window.getSelection){if(window.getSelection().empty)try{window.getSelection().empty()}catch(a){}else if(window.getSelection().removeAllRanges)try{window.getSelection().removeAllRanges()}catch(a){}}else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(a){}}function g(a){return!(null===a||void 0===a)}function h(a,b){return b>a?a:b}function i(a,b){return a>b?a:b}function j(b){var c="";if(a.isArray(b)){for(var d=0,e=b.length;e>d;d++)c+=j(b[d]);return c}if(!b||!b.tag&&!b.child)return b||"";if(b.tag){if(c+="<"+b.tag,b.attr)for(var f in b.attr){var g=f;"styleclass"==f&&(g="class"),c+=" "+g+'="'+b.attr[f]+'"'}c+=">"}if(a.isArray(b.child))for(var d=0,e=b.child.length;e>d;d++)c+=j(b.child[d]);else b.child&&(c+=j(b.child));return b.tag&&(c+="</"+b.tag+">"),c}function l(b,c,d,e){var f=this;if(a.isArray(b.valid)){for(var g in b.valid)if(b.valid[g]===d)return!0;return!1}if("function"==typeof b.valid)return b.valid.call(f,d,e,b);if(a.isArray(b.rule)){for(var g in b.rule)if(n(b.rule[g],"value")===d)return!0;return!1}return!0}function m(b,c,d,e){if(!b.rule)return null;var f=b.rule||null;return a.isFunction(b.rule)&&(f=b.rule(c,d,e)||null),a.isArray(b.rule)&&(f=b.rule),f}function n(a,b){return a.hasOwnProperty(b)?a[b]:a.hasOwnProperty(b.toUpperCase())?a[b.toUpperCase()]:a.hasOwnProperty(b.toLowerCase())?a[b.toLowerCase()]:void 0}function o(b,c,d){var e=this,f=c.jquery?c:a(c);if(b.editable===!0)return e.option.directEdit?f.text():f.find("input").eq(0).val();var g=b.editable;if(g.type&&(e.option.renderMapping[g.type]||e.option.renderMapping["*"])){var h=e.option.renderMapping[g.type]||e.option.renderMapping["*"];a.isFunction(h)?g=h(g,b):a.isPlainObject(h)&&(g=a.extend({},g,h))}if(g.type){if("text"==g.type){var i=f.find("input").val();return g.rule&&("comma"===g.rule?i=i.replace(/,/g,""):("date"===g.rule||"month"===g.rule)&&(i=i.replace(/-/g,""))),i}if("select"==g.type)return f.find("select option").filter(":selected").val();if("radio"==g.type)return f.find("input").filter(":checked").val();if("textarea"==g.type)return f.find("textarea").val();if("check"==g.type){var j=g.rule,k=f.find("input").eq(0).is(":checked");return a.isArray(j)&&a.each(j,function(a,b){return n(b,"check")===k?(k=n(b,"value"),!1):void 0}),k}if("date"==g.type)return f.find("input").val().replace(/\-/gi,"")}else{var l=null;if((a.isFunction(b.editedValue)||a.isFunction(g.editedValue))&&(l=b.editedValue||g.editedValue),a.isFunction(l))return l(c,a.extend({},d),b)}}function p(b,c,d,e){var f=this,g="";void 0===c&&(c="");var h=b.type||null,i=h;if(h&&(f.option.renderMapping[h]||f.option.renderMapping["*"])){var j=f.option.renderMapping[h]||f.option.renderMapping["*"];a.isFunction(j)?b=j.call(f,b,e):a.isPlainObject(j)&&(b=a.extend({},b,j)),h=b.type||null}if(!h&&!b)throw new Error('[AlopexGrid] Unable to render cell with a renderer of type "'+i+'"');return g+=p.plugin[h||"general"].call(f,b,c,d,e)}function q(b,c){return a.isFunction(b[c])?b[c](b):b[c]}function r(a){return 0===a.state.renderFromRenderedIndex}function s(a){return a.state.renderFromColumnIndex===a.state.visibleColumnMappingList[0].columnIndex}function t(a){if(a.data.self.state.resizing){var b=a.pageX-a.data.prevX;a.data.prevX=a.pageX,a.data.totalMoveAmount=a.data.totalMoveAmount+b,a.data.bar.style.left=parseInt(a.data.bar.style.left)+b+"px"}}function u(b){var c=b.data.self,d=parseInt(c.state.columnIndexToMapping[b.data.columnIndex].width)+b.data.totalMoveAmount;if(10>d&&(d=10),c.state.resizing=!1,b.data.bar.style.display="none",c.state.columnIndexToMapping[b.data.columnIndex].width=d+"px",c.state.headerSelection)for(var e=c.state.headerSelection.from,f=c.state.headerSelection.to,g=e;f>=g;g++){var h=c.state.columnIndexToMapping[g];h&&(h.width=d+"px")}b.data.totalMoveAmount>0&&(c.state.scrollxEnd=!1),c.redraw(),a(document).off(".alopexgridresizeevent"+c.eventns+b.data.self.key),c.$wrapper[0].removeChild(b.data.bar)}function v(b,c,d,e){for(var f in b){var g=b[f];for(var h in c)if(g.hasOwnProperty(h)){if("string"==typeof g[h]&&String(c[h])===g[h])return g;if("number"==typeof g[h]&&Number(c[h])===g[h])return g;if(g[h]===c[h])return g}var i=null;if(a.isFunction(g.multi)&&a.isArray(i=g.multi.call(d,e[g.key],e,g))||a.isArray(g.multi)){var j=v(i||g.multi,c,d,e);if(j)return j}}return!1}function w(a,b,c,d){function e(a,b){var c=document.createElement("span");return c.style.cssText=n,c.textContent=r.substring(a,b),t.appendChild(c),c}function f(){var b=document.body,c=document.defaultView,d=document.documentElement,e=document.createElement("div");e.style.paddingLeft=e.style.width="1px",b.appendChild(e);var f=2==e.offsetWidth;b.removeChild(e),e=a.getBoundingClientRect();var g=d.clientTop||b.clientTop||0,h=d.clientLeft||b.clientLeft||0,i=c.pageYOffset||f&&d.scrollTop||b.scrollTop,j=c.pageXOffset||f&&d.scrollLeft||b.scrollLeft;return{top:e.top+i-g,left:e.left+j-h}}function g(b,c){var d=document.defaultView.getComputedStyle(a,null).getPropertyValue(b);return c?parseFloat(d):d}if(!(a&&"value"in a))return a;if("string"==typeof b&&(b=parseFloat(b)),("number"!=typeof b||isNaN(b))&&(b=0),b=0>b?0:Math.min(a.value.length,b),"string"==typeof c&&(c=parseFloat(c)),("number"!=typeof c||isNaN(c)||b>c)&&(c=b),c=0>c?0:Math.min(a.value.length,c),"function"==typeof a.createTextRange){var h=a.createTextRange();return h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",c-b),h.getBoundingClientRect()}var i=f(),j=i.top,k=i.left,l=g("width",!0),m=g("height",!0),n="white-space:pre;padding:0;margin:0;",o=["direction","font-family","font-size","font-size-adjust","font-variant","font-weight","font-style","letter-spacing","line-height","text-align","text-indent","text-transform","word-wrap","word-spacing"];j+=g("padding-top",!0),j+=g("border-top-width",!0),k+=g("padding-left",!0),k+=g("border-left-width",!0),k+=1;for(var p=0;p<o.length;p++){var q=o[p];n+=q+":"+g(q)+";"}var r=a.value,s=r.length,t=document.createElement("div");b>0&&e(0,b);var u=e(b,c);s>c&&e(c,s),t.style.cssText=n,t.style.position="absolute",t.style.top=j+"px",t.style.left=k+"px",t.style.width=l+"px",t.style.height=m+"px",document.body.appendChild(t);var v=u.getBoundingClientRect();return d||t.parentNode.removeChild(t),v}function x(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}}function y(a,b){var c=a,d=c.scrollTop,e=0,f=c.selectionStart||"0"==c.selectionStart?"ff":document.selection?"ie":!1;if("ie"==f){c.focus();var g=document.selection.createRange();g.moveStart("character",-c.value.length),e=g.text.length}else"ff"==f&&(e=c.selectionStart);var h=c.value.substring(0,e),i=c.value.substring(e,c.value.length);if(c.value=h+b+i,e+=b.length,"ie"==f){c.focus();var g=document.selection.createRange();g.moveStart("character",-c.value.length),g.moveStart("character",e),g.moveEnd("character",0),g.select()}else"ff"==f&&(c.selectionStart=e,c.selectionEnd=e,c.focus());c.scrollTop=d}function z(a,b){return(a._state.recent?a._state.recent[b]:a[b])||""}function A(a,b){return a.state.columnIndexToMapping[b]||null}function B(a,b){return a.state.columnIndexToKeyMap[b]}function C(){var a=document.createElement("div");return a.setAttribute("class","sorting-handle alopexgrid-handle"),a}function D(a,b){var c=b.columnIndex,d=document.createElement("div");return d.setAttribute("class","resizing-handle alopexgrid-handle"),d.setAttribute("data-alopexgrid-resizingcolumnindex",c),d.setAttribute("onmousedown","AlopexGrid.run('"+a.key+"','_columnResizeStart',event,"+c+");"),d}function E(b,c,d,e,f){var g=[],h=["AlopexGrid.run('",b.key,"','_parseFilterHeader','"+f+"', event);"].join("");return g.push('<ul class="alopexgrid-filterdropdown">'),g.push('<li class="header">필터</li>'),g.push('<li class="menu remove"><a'),g.push(' data-key="'+c+'"'),g.push(' value="remove"'),g.push(' onclick="',h,'"'),g.push(">필터해제</a></li>"),g.push('<li class="header">텍스트 필터</li>'),g.push('<li class="menu">텍스트: <input type="text" class="filtertext" name="alopexgrid-filter-textinput" value="'+e+'"/></li>'),g.push('<li class="menu">타입: <select class="filterselect" onchange="',h,'" disabled>'),g.push('<option value="" selected="selected" disabled>선택하세요</option>'),a.each(b.option.filterTypeNameMap,function(a,b){g.push("<option "),g.push(' data-key="'+c+'"'),g.push(' value="',a,'"'),d==a&&g.push(' selected="selected"'),g.push(">",b,"</option>")}),g.push("</select></li>"),g.push('<li class="header">데이터 필터</li>'),g.push("</ul>"),g.join("")}function F(a,b){b?(a.removeClass("af-disabled"),a.removeAttr("disabled")):(a.addClass("af-disabled"),a.attr("disabled","disabled"))}function G(b,c,d,e,f){var g=a.isArray(b.state.filteredDataIndexList),h=[],i=[],j=!1;if(g&&b.state.filter){for(var k in b.state.filter)k!=e?i.push(b.state.filter[k]):j=!0;h=j?0==i.length?b.state.data:b._getFilteredDataList(i,b.state.data):b.state.renderTargetDataList}else h=b.state.data;var l,m,n=g?a.map(b.state.filteredDataIndexList,function(a){return b.state.data[a]}):"",o=0,q=[],r=[];if(h){m=h.length;for(var s=0;m>s;s++)l=h[s],q.indexOf(l[d])<0&&(q[o]=l[d],o++)}if(o=0,g&&n){m=n.length;for(var s=0;m>s;s++)l=n[s],r.indexOf(l[d])<0&&(r[o]=l[d],o++)}b.state.filterColumnIndex=e;var t,u,v,w=b.columnInfo(e),x=w.useRenderToFilter;if(b.state.isFilterRendered=!1,w.render&&x){u=w.render;var y=w.render.type;a.isFunction(w.render)?(b.state.isFilterRendered=!0,t=w.render):y&&(b.option.renderMapping.hasOwnProperty(y)?(t=b.option.renderMapping[y],a.isFunction(t)&&(v=!1,b.state.isFilterRendered=!0,t=t())):p.plugin.hasOwnProperty(y)&&(b.state.isFilterRendered=!0,v=!0,t=p.plugin[y]))}var z;z=w.sorting?w.sorting:!0,c.alopexGrid({width:200,height:200,enableDefaultContextMenu:!1,enableContextMenu:!1,defaultSorting:{sortingColumn:0,sortingDirection:"asc"},columnMapping:[{columnIndex:0,key:"label",width:185,title:"필터 목록",resizing:"self",sorting:z,render:function(a,c){var e=this,f="";return c.isCheckAll?'<input id="'+b.key+d+'_checkAll" type="checkbox" class="alopexgrid-filter-checkbox" data-type="checkbox" name="'+d+'" '+c.checked+'"/><label class="alopexgrid-filter-checkboxlabel">'+c.label+"</label>":(f='<input id="'+b.key+d+"_check_"+c._index.data+'" type="checkbox" class="alopexgrid-filter-checkbox" data-type="checkbox" name="'+d+'" '+c.checked+'"/>',f+='<label class="alopexgrid-filter-checkboxlabel">',void 0==c.label?f+="(필드 값 없음)":b.state.isFilterRendered?e.state.filterRenderFuntion&&e.state.isDefaultRenderType?f+=e.state.filterRenderFuntion(e.state.renderObj,c.label):e.state.filterRenderFuntion&&!e.state.isDefaultRenderType&&(f+=e.state.filterRenderFuntion(c.label)):f+=c.label,f+="</label>")}}],on:{cell:{click:function(b,c){var d=this,e=c.target.tagName,g=a(c.target),h=!0;"DIV"==e?(h=!1,g=a(c.target.children[0])):"LABEL"==e&&(h=!1,g=a(c.target).siblings());g.siblings().text();if(1!=d.dataGet().length)if(h)if(b.isCheckAll)g.prop("checked")?(d.dataEdit({checked:'checked="checked"'}),F(f,!0)):(d.dataEdit({checked:""}),F(f,!1));else{var i=d.dataGet().length-1,j=d.dataGet({checked:'checked="checked"'}).length;g.prop("checked")?(i==j+1?d.dataEdit({checked:'checked="checked"'},{isCheckAll:!0}):d.dataEdit({checked:""},{isCheckAll:!0}),d.dataEdit({checked:'checked="checked"'},{_index:{data:b._index.data}}),F(f,!0)):(0==i||1==j||1==i&&2==j?F(f,!1):F(f,!0),d.dataEdit({checked:""},{_index:{data:b._index.data}}),d.dataEdit({checked:""},{isCheckAll:!0}))}else if(b.isCheckAll)g.prop("checked")?(d.dataEdit({checked:""}),F(f,!1)):(d.dataEdit({checked:'checked="checked"'}),F(f,!0));else{var i=d.dataGet().length-1,j=d.dataGet({checked:'checked="checked"'}).length;g.prop("checked")?(0==i||1==j||1==i&&2==j?F(f,!1):F(f,!0),d.dataEdit({checked:""},{_index:{data:b._index.data}}),d.dataEdit({checked:""},{isCheckAll:!0})):(i==j+1?d.dataEdit({checked:'checked="checked"'},{isCheckAll:!0}):d.dataEdit({checked:""},{isCheckAll:!0}),d.dataEdit({checked:'checked="checked"'},{_index:{data:b._index.data}}),F(f,!0))}}}}});var A=c.data(Qb.KEY_NAME);null==A.state.filterDuplicateMap&&(A.state.filterDuplicateMap={}),A.state.filterRenderFuntion=t,A.state.isDefaultRenderType=v,A.state.renderObj=u;var B=[{isCheckAll:!0,checked:'checked="checked"',label:"(Select All)"}];o=1;for(var C,D,E="",G=q.length,H=0;G>H;H++){if(C='checked="checked"',E=q[H],b.state.isFilterRendered){if(A.state.filterRenderFuntion&&A.state.isDefaultRenderType?D=A.state.filterRenderFuntion(A.state.renderObj,E):A.state.filterRenderFuntion&&null!==A.state.isDefaultRenderType&&(D=A.state.filterRenderFuntion(E)),A.state.filterDuplicateMap.hasOwnProperty(D)){A.state.filterDuplicateMap[D].push(E);continue}A.state.filterDuplicateMap[D]=[]}g&&r.indexOf(E)<0&&(B[0].checked="",C=""),B[o]={checked:C,label:E},o++}A.dataSet(B),A.dataPin({isCheckAll:!0})}function H(a){var b=String(a).split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}function I(a,b){var c=null,d=Number(b);return isNaN(d)?("c"==b.charAt(0)&&(d=Number(b.split("c").pop()),c=B(a,d)),null===c&&(c=b)):c=B(a,d),c}function J(b){return!b||a.isEmptyObject(b)}function K(a,b,c){var d=a[a.length-1];if(d){var e=d[b];if(!e)return!1;var f=Number(e.from),g=Number(e.to),h=Number(b);return f===h?c?e:g-f:h>f&&g>h?c?e:!0:!1}}function L(b,c){var d=null;return b&&b.length?(a.each(b,function(a,b){if(b)if(d){var e=K(b,Number(c),!0);Math.abs(e.to-e.from)>Math.abs(d.to-d.from)&&(d=e)}else d=K(b,Number(c),!0)}),d):d}function M(b,c,d){if(!c)return null;var e=[];a.isArray(c)||(c=[c]);var f=a.map(c,function(a){return a&&a._index?a._index.id:void 0});if(a.each(b.state.data,function(b,c){a.inArray(c._index.id,f)>=0&&e.push(c)}),d)for(var g=b.state.data.length;g--;){var h=b.state.data[g];a.inArray(h._index.id,f)>=0&&b.state.data.splice(g,1)}return e}function N(a,b){var c={left:0,middle:50,right:100};b&&(c={top:0,middle:50,bottom:100});var d=null;return c.hasOwnProperty(a)?d=c[a]:"string"==typeof a&&a.indexOf("%")>=0?d=Number(a.split("%")[0]):isNaN(Number(a))||(d=Number(a)),d}function O(a,b,c){var d=c.option.rowFixCount,e=0,f=0;if(100==b||50==b){var g=0;100==b&&c.state.scrollyRenderedItemMaxLength!=c.state.scrollyRenderedItemLength&&(g=c.state.scrollyRenderedItemMaxLength-c.state.scrollyRenderedItemLength);var h=Math.ceil(c.state.scrollyRenderedItemLength*(b/100));f=a-h+g,0>=f&&(f=0),e=f*c.state.rowHeight*c.state.scrollyRatio,e>=c.state.scrollbaryTrackLength-c.state.scrollbaryHeight?(c.state.scrollyEnd=!0,c.state.renderFromRenderedIndex=c.state.lastScrollyIndex,e=c.state.scrollbaryTrackLength-c.state.scrollbaryHeight):(c.state.scrollyEnd=!1,c.state.renderFromRenderedIndex=f)}else c.state.renderFromRenderedIndex=a-d,e=c.state.renderFromRenderedIndex*c.state.rowHeight*c.state.scrollyRatio,e>=c.state.scrollbaryTrackLength-c.state.scrollbaryHeight?(c.state.scrollyEnd=!0,c.state.renderFromRenderedIndex=c.state.lastScrollyIndex,e=c.state.scrollbaryTrackLength-c.state.scrollbaryHeight):c.state.scrollyEnd=!1;c.state.translateY=e}function P(a,b,c){var d=c.state.fixedColumnMapping.length,e=0,f=0;if(100==b||50==b){var g=c.state.wrapperWidth*(b/100),h=0;c.state.scrollxEnd=!1;for(var i=a;i>=0;i--)if(h+=c.state.columnWidthMap[i],c.state.renderFromColumnIndex=i,h>g){c.state.renderFromColumnIndex=i+1;break}f=c._generateTranslatex(c.state.renderFromColumnIndex)*c.state.scrollxRatio,f>=c.state.scrollbarxTrackLength-c.state.scrollbarxWidth&&(c.state.scrollxEnd=!0,c.state.renderFromColumnIndex=c.state.lastScrollxIndex,f=c.state.scrollbarxTrackLength-c.state.scrollbarxWidth)}else e=c.state.columnIndexArr[c.state.columnIndexArr.indexOf(a)-d],(null==e||0>=e)&&(e=0),f=c._generateTranslatex(e)*c.state.scrollxRatio,f>=c.state.scrollbarxTrackLength-c.state.scrollbarxWidth?(c.state.scrollxEnd=!0,c.state.renderFromColumnIndex=c.state.lastScrollxIndex,f=c.state.scrollbarxTrackLength-c.state.scrollbarxWidth):(c.state.scrollxEnd=!1,c.state.renderFromColumnIndex=e);c.state.translateX=f}function Q(a){return g(a.columnIndex)&&a.hidden!==!0}function R(a,b){for(var c=0,d=a.length;d>c;c++){var e=a[c];if(Number(e.columnIndex)===Number(b)||"string"==typeof e.key&&e.key===b)return!!e.hidden}return!1}function S(a,b){for(var c=0,d=a.length;d>c;c++){var e=a[c],f=e.columnIndex;if(g(f)&&e.key===b)return f}return null}function T(a){return!a||a&&a[Vb]||a&&!a._state?!1:!0}function U(b,c,d,e,f){e=e||{};var g=c[d];if(!T(g))return!1;if(f&&(g=a.extend({},g,g._state.recent)),e._index){if(e._index.hasOwnProperty("id"))return e._index.id===g._index.id?!0:!1;if(e._index.hasOwnProperty("data"))return e._index.data===d?!0:!1;if(e._index.hasOwnProperty("row"))return b.state.renderTargetDataIndexList[e._index.row]===g._index.data?!0:!1;if(e._index.hasOwnProperty("rendered"))return b.state.renderTargetDataIndexList[e._index.rendered]===g._index.data?!0:!1}if(a.isPlainObject(e._state))for(var h in e._state)if(e._state[h]!==g._state[h])return!1;var i=Qb.trimData(e);if(!a.isEmptyObject(i)){var j=!1;if(a.each(i,function(a,b){return g[a]!==b?(j=!0,!1):void 0}),j)return!1}return!0}function V(a){delete a._state.recent,delete a._state._editableStarted,delete a._state._beforeEditing}function W(b){return a.isPlainObject(b)||a.isArray(b)?b:void 0}function X(b){return"boolean"===a.type(b)||null===b?b:void 0}function Y(b){return"string"===a.type(b)?b:void 0}function Z(b,c){for(var d=b.state.pinnedDataIdList.length-1;d>=0;d--)if(a.inArray(d,c)>=0){var e=b.state.pinnedDataIdList[d];delete b.state.pinnedDataStateMapById[e],b.state.pinnedDataIdList.splice(d,1)}}function $(a,b,c){if("boolean"==typeof c.readonly||"function"==typeof c.readonly){var d=c.readonly;if("function"==typeof d&&(d=c.readonly.call(a,b[c.key],b,c)),"boolean"==typeof d)return d===!0}if(a.option.rowOption&&("boolean"==typeof a.option.rowOption.readonly||"function"==typeof a.option.rowOption.readonly)){var d=a.option.rowOption.readonly;if("function"==typeof d&&(d=d.call(a,b,a.option.rowOption)),"boolean"==typeof d)return d===!0}return!1}function _(a){return!!a.state.cellSelection&&(a.state.cellSelection.rightBoundaryColumnIndex-a.state.cellSelection.leftBoundaryColumnIndex||a.state.cellSelection.bottomBoundaryRenderedIndex-a.state.cellSelection.topBoundaryRenderedIndex)}function ab(a){delete a.state.cellSelection}function bb(a,b){return Math.min(Math.max(a.state.renderTargetDataIndexList.length-1,0),b)}function cb(a,b){return Math.min(Math.max(0,b),a.state.maxColumnIndex)}function db(a,b,c){delete a.state.cellSelection,a.state.cellSelection={},a.state.cellSelection.renderedIndexMap={},a.state.cellSelection.columnIndexMap={},b=bb(a,b),c=cb(a,c),a.state.cellSelection.focusRenderedIndex=b,a.state.cellSelection.focusColumnIndex=c,a.state.cellSelection.focusRowspanInfo=ob(a,bb(a,b),cb(a,c)),a.state.cellSelection.renderedIndexMap[b]=!0,a.state.cellSelection.columnIndexMap[c]=!0,a.state.cellSelection.rightBoundaryColumnIndex=a.state.cellSelection.focusColumnIndex,a.state.cellSelection.leftBoundaryColumnIndex=a.state.cellSelection.focusColumnIndex,a.state.cellSelection.bottomBoundaryRenderedIndex=a.state.cellSelection.focusRenderedIndex,a.state.cellSelection.topBoundaryRenderedIndex=a.state.cellSelection.focusRenderedIndex}function eb(a){a.$wrapper.find(".cell-selected").removeClass(Wb)}function fb(a){if(a.state.cellSelection){a.state.cellSelection.rightBoundaryColumnIndex=a.state.cellSelection.focusColumnIndex,a.state.cellSelection.leftBoundaryColumnIndex=a.state.cellSelection.focusColumnIndex,a.state.cellSelection.topBoundaryRenderedIndex=a.state.cellSelection.focusRenderedIndex,a.state.cellSelection.bottomBoundaryRenderedIndex=a.state.cellSelection.focusRenderedIndex;for(var b in a.state.cellSelection.renderedIndexMap){var c=parseInt(b);for(var d in a.state.cellSelection.columnIndexMap){var e=parseInt(d);a.state.visibleIndexMapByColumnIndex[e]>=0&&(a.state.cellSelection.rightBoundaryColumnIndex=Math.max(a.state.cellSelection.rightBoundaryColumnIndex,e),a.state.cellSelection.leftBoundaryColumnIndex=Math.min(a.state.cellSelection.leftBoundaryColumnIndex,e),a.state.cellSelection.bottomBoundaryRenderedIndex=Math.max(a.state.cellSelection.bottomBoundaryRenderedIndex,c),a.state.cellSelection.topBoundaryRenderedIndex=Math.max(0,Math.min(a.state.cellSelection.topBoundaryRenderedIndex,c)))}}}}function gb(a){return a.state.cellSelection?a.state.cellSelection.focusColumnIndex<=a.state.fixupto:!1}function hb(a){return a.state.cellSelection?a.state.cellSelection.focusRenderedIndex<a.option.rowFixCount:!1}function ib(a){return a.state.cellSelection?a.state.cellSelection.leftBoundaryColumnIndex<=a.state.fixupto&&a.state.cellSelection.rightBoundaryColumnIndex>a.state.fixupto:!1}function jb(a){return a.state.cellSelection?a.state.cellSelection.topBoundaryRenderedIndex<a.option.rowFixCount&&a.state.cellSelection.bottomBoundaryRenderedIndex>=a.option.rowFixCount:!1}function kb(a,b){return b<a.option.rowFixCount}function lb(a,b){return b<=a.state.fixupto}function mb(a,b,c,d,e){db(a,b,c);for(var f=Math.min(b,d),g=Math.max(b,d),h=Math.min(c,e),i=Math.max(c,e),j=h;i>=j;j++)for(var k=f;g>=k;k++)if(null!=a.state.visibleIndexMapByColumnIndex[j]){var l=sb(a,k,j);"number"==typeof l&&(k=l)}rb(a),fb(a),eb(a),nb(a),Ab(a)}function nb(b){if(b.state.cellSelection&&b.state.refreshbodycell)for(var c=0,d=b.state.refreshbodycell.renderedDataIndexList.length;d>c;c++){var e=b.state.refreshbodycell.renderedDataIndexList[c],f=b.state.data[e];if(f){var g=f._index.rendered;if(!(g<b.state.cellSelection.topBoundaryRenderedIndex||g>b.state.cellSelection.bottomBoundaryRenderedIndex))for(var h=0,i=b.state.refreshbodycell.renderedColumnMappingList.length;i>h;h++){var j=b.state.refreshbodycell.renderedColumnMappingList[h],k=j.columnIndex;if(!(k<b.state.cellSelection.leftBoundaryColumnIndex)&&!(k>b.state.cellSelection.rightBoundaryColumnIndex)&&b.state.visibleIndexMapByColumnIndex[k]>=0){var l=a("#"+b._cellIdFromRendered(g,k));if(l&&l.length){{l.css("color"),l.css("background-color"),a.trim(l.prop("className").split("cell-selected")[0])}l.addClass("cell-selected");var m=b.state.cellSelection.focusRowspanInfo&&b.state.cellSelection.focusRowspanInfo.from<=g&&b.state.cellSelection.focusRowspanInfo.to>=g,n=pb(b,f,k),o=n>=k&&k<=b.state.cellSelection.focusColumnIndex&&b.state.cellSelection.focusColumnIndex<=n;k===b.state.cellSelection.focusColumnIndex&&g===b.state.cellSelection.focusRenderedIndex?l.addClass("cell-selected-focus"):m&&b.state.cellSelection.focusColumnIndex===k?l.addClass("cell-selected-focus"):o&&g===b.state.cellSelection.focusRenderedIndex?l.addClass("cell-selected-focus"):o&&m&&l.addClass("cell-selected-focus"),k===b.state.cellSelection.leftBoundaryColumnIndex&&l.addClass("cell-selected-leftline"),k===b.state.cellSelection.rightBoundaryColumnIndex&&l.addClass("cell-selected-rightline"),g===b.state.cellSelection.topBoundaryRenderedIndex&&l.addClass("cell-selected-topline"),g===b.state.cellSelection.bottomBoundaryRenderedIndex&&l.addClass("cell-selected-bottomline")}}}}}}function ob(a,b,c){var d=A(a,c);if(!d)return null;if(a.option.grouping&&a.option.grouping.useGroupRowspan!==!0)return null;var e=null;d.rowspan===!0?e=d.key:d.rowspan&&"string"==typeof d.rowspan.by&&(e=d.rowspan.by);var f=a.state.groupingLookupTable;if(!f)return null;var g=f[e];if(!g)return null;for(var h=a.state.renderTargetDataIndexList[b],i=g[h],j=i.from,k=i.to,l=void 0,m=void 0,n=j;k>=n;n++){var o=a.state.renderTargetDataIndexList.indexOf(n);o>=0&&(l=void 0===l?o:Math.min(o,l),m=void 0===m?o:Math.max(o,m))}return void 0!==l&&void 0!==m?{from:l,to:m}:null}function pb(b,c,d){var e="number"==typeof d?b.state.columnIndexToMapping[d]:d;if(e.colspan){var f=qb(b,c,e);if(f){var g=b.state.visibleIndexMapByColumnIndex[e.columnIndex],h=Math.min(b.state.visibleColumnCount-1,g+f-1);return b.state.visibleColumnMappingList[h].columnIndex}}else if(e.colspanTo){if("string"==typeof e.colspanTo){var g=b.state.visibleIndexMapByColumnIndex[e.columnIndex],h=b.state.visibleIndexMapByKey[e.colspanTo];return b.state.visibleColumnMappingList[h].columnIndex}if(!c)return null;var i=a.isFunction(e.colspanTo)?e.colspanTo(c[e.key],c,e):e.colspanTo,j=i;if("string"==typeof j){var h=b.state.visibleIndexMapByKey[j];j=b.state.visibleColumnMappingList[h].columnIndex}return Math.min(b.state.maxColumnIndex,j)}return null}function qb(b,c,d,e){var f=null,g=null;if(d.colspan){var h=Number(a.isNumeric(d.colspan)?d.colspan:a.isFunction(d.colspan)?d.colspan(c[d.key],c,d):null);f=h}else{if(!d.colspanTo)return null;g=b.state.visibleIndexMapByColumnIndex[d.columnIndex];var i=a.isFunction(d.colspanTo)?d.colspanTo(c[d.key],c,d):d.colspanTo;if("string"==typeof i){var j=b.state.visibleIndexMapByKey[i],k=j-g+1;f=k>0?k:null}else{var j=b.state.visibleIndexMapByColumnIndex[i],k=j-g+1;f=k>0?k:null}}if(e){g=g||b.state.visibleIndexMapByColumnIndex[d.columnIndex];var j=b.state.visibleIndexMapByColumnIndex[e],k=j-g+1;f=k>0?Math.min(f,k):null}return g+f>b.state.visibleColumnCount&&(f=b.state.visibleColumnCount-g),f}function rb(a){for(var b=a.state.cellSelection.topBoundaryRenderedIndex,c=a.state.cellSelection.bottomBoundaryRenderedIndex,d=a.state.cellSelection.leftBoundaryColumnIndex,e=a.state.cellSelection.rightBoundaryColumnIndex,f=d;e>=f;f++)for(var g=b;c>=g;g++)if(a.state.visibleIndexMapByColumnIndex[f]>=0){var h=sb(a,g,f);"number"==typeof h&&(g=h)}}function sb(a,b,c){var d=(a.state.renderTargetDataIndexList[b],A(a,c));if(d){a.state.cellSelection.renderedIndexMap[b]=!0,a.state.cellSelection.columnIndexMap[c]=!0;var e=d.rowspan&&a.option.grouping&&a.option.grouping.useGroupRowspan===!0?ob(a,b,c):!1;if(e){for(var f=e.from,g=e.to,h=Math.min(g,f,a.state.renderTargetDataIndexList.length-1),i=Math.min(Math.max(g,f),a.state.renderTargetDataIndexList.length-1),j=h;i>=j;j++){a.state.cellSelection.renderedIndexMap[j]=!0;for(var k=a._getRenderedDataFromRenderedIndex(j),l=c;l>=0;l--)if(a.state.visibleIndexMapByColumnIndex[l]>=0){var d=A(a,l);if(d&&Q(d)&&(d.colspan||d.colspanTo)){var m=pb(a,k,d);if(m&&!(c>m))for(var n=l;m>=n&&n<=a.state.maxColumnIndex;n++)a.state.visibleIndexMapByColumnIndex[n]>=0&&(a.state.cellSelection.columnIndexMap[n]=!0)}}}return i}for(var k=a._getRenderedDataFromRenderedIndex(b),l=c;l>=0;l--){var d=A(a,l);if(d&&Q(d)&&(d.colspan||d.colspanTo)){var m=pb(a,k,d);if(m&&!(c>m))for(var n=l;m>=n&&n<=a.state.maxColumnIndex;n++)a.state.cellSelection.columnIndexMap[n]=!0}}}}function tb(b,c,d){var e=a("#"+b._cellIdFromRendered(c,d));if(e.length)return e;if(b.state.groupRowspanned&&b.option.grouping&&b.option.grouping.useGroupRowspan===!0){var f=A(b,d);if(f&&f.rowspan){var g=ob(b,c,d);if(!g)return null;if(g.from!==c){var h=c-1;return g.from<c&&(h=g.from||0),h===c?null:tb(b,h,d)}}}for(var i=b._getRenderedDataFromRenderedIndex(c),j=d;j>=0;j--){var f=A(b,j);if(f){if(!Q(f))return;var k=pb(b,i,f);if(k>=d)return d===f.columnIndex?null:tb(b,c,f.columnIndex)}}return null}function ub(a,b,c){var d={},e={};if(g(b)){d.renderedIndex=b;var f=e["data-alopexgrid-dataindex"]=a.state.renderTargetDataIndexList[b];e["data-alopexgrid-dataid"]=a.state.data[f]._index.id}g(c)&&(d.columnIndex=c,e["data-alopexgrid-columnindex"]=c),a.$focusfixture.prop(d).attr(e);var h=a.$focusfixture[0],i=document.createRange(),j=window.getSelection(),k=document.createTextNode("");h.appendChild(k),i.setStart(h.childNodes[0],0),i.collapse(!0),j.removeAllRanges(),j.addRange(i)}function vb(a,b,c){a.state.cellSelection&&(b=bb(a,b),c=cb(a,c),a.state.cellSelection.focusRenderedIndex=b,a.state.cellSelection.focusColumnIndex=c,a.state.cellSelection.focusRowspanInfo=ob(a,a.state.cellSelection.focusRenderedIndex,a.state.cellSelection.focusColumnIndex),sb(a,b,c),fb(a),zb(a,a.state.cellSelection.focusRenderedIndex,a.state.cellSelection.focusColumnIndex),eb(a),nb(a),setTimeout(function(){ub(a,b,c)},0))}function wb(a,b,c,d){b=bb(a,b),c=cb(a,c),db(a,b,c),sb(a,b,c),fb(a),"up"===d?a.state.cellSelection.focusRenderedIndex=a.state.cellSelection.topBoundaryRenderedIndex:"down"===d?a.state.cellSelection.focusRenderedIndex=a.state.cellSelection.bottomBoundaryRenderedIndex:"left"===d?a.state.cellSelection.focusColumnIndex=a.state.cellSelection.leftBoundaryColumnIndex:"right"===d&&(a.state.cellSelection.focusColumnIndex=a.state.cellSelection.rightBoundaryColumnIndex),a.state.cellSelection.focusRowspanInfo=ob(a,a.state.cellSelection.focusRenderedIndex,a.state.cellSelection.focusColumnIndex),zb(a,a.state.cellSelection.focusRenderedIndex,a.state.cellSelection.focusColumnIndex),eb(a),nb(a),setTimeout(function(){a.state.cellSelection&&ub(a,a.state.cellSelection.focusRenderedIndex,a.state.cellSelection.focusColumnIndex)},0)}function xb(a,b,c){if(a.state.cellSelection){var d=a.state.cellSelection.focusRenderedIndex,e=a.state.cellSelection.focusColumnIndex,f=d+b,g=e;c>0?g=Fb(a,e,c):0>c&&(g=Eb(a,e,-c)),_(a)?(b?(f>a.state.cellSelection.bottomBoundaryRenderedIndex?(f=a.state.cellSelection.topBoundaryRenderedIndex,g=Fb(a,g,1)):f<a.state.cellSelection.topBoundaryRenderedIndex&&(f=a.state.cellSelection.bottomBoundaryRenderedIndex,g=Eb(a,g,1)),g>a.state.cellSelection.rightBoundaryColumnIndex?g=a.state.cellSelection.leftBoundaryColumnIndex:g<a.state.cellSelection.leftBoundaryColumnIndex&&(g=a.state.cellSelection.rightBoundaryColumnIndex)):c&&(g>a.state.cellSelection.rightBoundaryColumnIndex?(g=a.state.cellSelection.leftBoundaryColumnIndex,f++):g<a.state.cellSelection.leftBoundaryColumnIndex&&(g=a.state.cellSelection.rightBoundaryColumnIndex,f--),f>a.state.cellSelection.bottomBoundaryRenderedIndex?f=a.state.cellSelection.topBoundaryRenderedIndex:f<a.state.cellSelection.topBoundaryRenderedIndex&&(f=a.state.cellSelection.bottomBoundaryRenderedIndex)),vb(a,f,g)):wb(a,f,g)}}function yb(a,b,c,d,e){if(a.state.cellSelection.extendedRenderedIndex=a.state.cellSelection.focusRenderedIndex,a.state.cellSelection.extendedColumnIndex=a.state.cellSelection.focusColumnIndex,b)if(a.state.cellSelection.focusColumnIndex<a.state.cellSelection.rightBoundaryColumnIndex)delete a.state.cellSelection.columnIndexMap[a.state.cellSelection.rightBoundaryColumnIndex],a.state.cellSelection.extendedColumnIndex=Math.max(0,Eb(a,a.state.cellSelection.rightBoundaryColumnIndex,1)),a.state.cellSelection.rightBoundaryColumnIndex=a.state.cellSelection.extendedColumnIndex;else{var f=Math.max(Eb(a,a.state.cellSelection.leftBoundaryColumnIndex,1),0);a.state.cellSelection.columnIndexMap[f]=!0,a.state.cellSelection.leftBoundaryColumnIndex=Math.max(0,Math.min(a.state.cellSelection.leftBoundaryColumnIndex,f)),a.state.cellSelection.extendedColumnIndex=f}else if(c)if(a.state.cellSelection.focusColumnIndex>a.state.cellSelection.leftBoundaryColumnIndex)delete a.state.cellSelection.columnIndexMap[a.state.cellSelection.leftBoundaryColumnIndex],a.state.cellSelection.extendedColumnIndex=Fb(a,a.state.cellSelection.leftBoundaryColumnIndex,1),a.state.cellSelection.leftBoundaryColumnIndex=a.state.cellSelection.extendedColumnIndex;else{var f=Math.min(Fb(a,a.state.cellSelection.rightBoundaryColumnIndex,1),a.state.maxColumnIndex);a.state.cellSelection.columnIndexMap[f]=!0,a.state.cellSelection.rightBoundaryColumnIndex=Math.min(a.state.maxColumnIndex,Math.max(a.state.cellSelection.rightBoundaryColumnIndex,f)),a.state.cellSelection.extendedColumnIndex=f}else if(d){d=d===!0?1:d;for(var g=a.state.cellSelection.focusRenderedIndex,h=a.state.cellSelection.leftBoundaryColumnIndex;h<=a.state.cellSelection.rightBoundaryColumnIndex;h++){var i=(A(a,h),ob(a,a.state.cellSelection.focusRenderedIndex,h));if(i){var j=i.to-i.from;j&&(g=i.to)}}var k=g<a.state.cellSelection.bottomBoundaryRenderedIndex;if(k){for(var l=Math.max(0,a.state.cellSelection.bottomBoundaryRenderedIndex-d),m=l,h=a.state.cellSelection.leftBoundaryColumnIndex;h<=a.state.cellSelection.rightBoundaryColumnIndex;h++){var i=(A(a,h),ob(a,m,h));i&&i.to-i.from>0&&(l=Math.max(Math.min(l,i.from-1),a.state.cellSelection.focusRenderedIndex))}for(var n=a.state.cellSelection.bottomBoundaryRenderedIndex;n>a.state.cellSelection.focusRenderedIndex&&n>l;n--)delete a.state.cellSelection.renderedIndexMap[n];
a.state.cellSelection.extendedRenderedIndex=l,a.state.cellSelection.bottomBoundaryRenderedIndex=l}else{for(var o=Math.max(a.state.cellSelection.topBoundaryRenderedIndex-d,0),m=o,h=a.state.cellSelection.leftBoundaryColumnIndex;h<=a.state.cellSelection.rightBoundaryColumnIndex;h++){var i=(A(a,h),ob(a,m,h));i&&i.to-i.from>0&&(o=Math.max(Math.min(o,i.from),0))}for(var n=a.state.cellSelection.topBoundaryRenderedIndex;n>=o&&n>=0;n--)a.state.cellSelection.renderedIndexMap[n]=!0;a.state.cellSelection.extendedRenderedIndex=o,a.state.cellSelection.topBoundaryRenderedIndex=o}}else if(e){e=e===!0?1:e;for(var p=a.state.cellSelection.focusRenderedIndex,h=a.state.cellSelection.leftBoundaryColumnIndex;h<=a.state.cellSelection.rightBoundaryColumnIndex;h++){var i=(A(a,h),ob(a,a.state.cellSelection.focusRenderedIndex,h));if(i){var j=i.to-i.from;j&&(p=i.from)}}var k=p>a.state.cellSelection.topBoundaryRenderedIndex;if(k){for(var l=Math.min(a.state.cellSelection.topBoundaryRenderedIndex+e,Math.max(a.state.renderTargetDataIndexList.length-1,0)),m=l,h=a.state.cellSelection.leftBoundaryColumnIndex;h<=a.state.cellSelection.rightBoundaryColumnIndex;h++){var i=(A(a,h),ob(a,m,h));i&&i.to-i.from>0&&(l=Math.min(Math.max(l,i.to+1),a.state.cellSelection.focusRenderedIndex))}for(var n=a.state.cellSelection.topBoundaryRenderedIndex;n<a.state.cellSelection.focusRenderedIndex&&l>n;n++)delete a.state.cellSelection.renderedIndexMap[n];a.state.cellSelection.extendedRenderedIndex=l,a.state.cellSelection.topBoundaryRenderedIndex=l}else{for(var o=Math.min(a.state.renderTargetDataIndexList.length-1,a.state.cellSelection.bottomBoundaryRenderedIndex+e),m=o,h=a.state.cellSelection.leftBoundaryColumnIndex;h<=a.state.cellSelection.rightBoundaryColumnIndex;h++){var i=(A(a,h),ob(a,m,h));i&&i.to-i.from>0&&(o=Math.min(Math.max(o,i.to),a.state.renderTargetDataIndexList.length-1))}for(var n=a.state.cellSelection.bottomBoundaryRenderedIndex;o>=n&&n<a.state.renderTargetDataIndexList.length;n++)a.state.cellSelection.renderedIndexMap[n]=!0;a.state.cellSelection.extendedRenderedIndex=o,a.state.cellSelection.bottomBoundaryRenderedIndex=o}}rb(a),fb(a),eb(a),nb(a);tb(a,a.state.cellSelection.extendedRenderedIndex,a.state.cellSelection.extendedColumnIndex);zb(a,a.state.cellSelection.extendedRenderedIndex,a.state.cellSelection.extendedColumnIndex)}function zb(a,b,c,d){var e=(a.state.columnWidthMap,a.state.rowHeight,a.state.wrapperWidth,a.state.wrapperHeight,a.state.renderFromRenderedIndex),f=a.state.renderFromColumnIndex,g=a.state.renderToRenderedIndex,h=a.state.renderToColumnIndex,i=!1,j=!1;if(a.state.fixupto>=0){var k=a.state.refreshbodycell.renderedColumnMappingList,l=a.state.refreshbodycell.renderedFixedColumnMappingList;f=k[l.length].columnIndex,c<=a.state.fixupto&&d!==!0&&(i=!0)}if(a.option.rowFixCount>0){b<a.option.rowFixCount&&d!==!0&&(j=!0);for(var m=0;m<a.option.rowFixCount;m++){var n=a.state.renderTargetDataIndexList[m],o=a.state.data[n];o&&e++}}else if(a.state.refreshbodycell&&a.state.refreshbodycell.renderedPinnedDataIndexList){b<a.state.refreshbodycell.renderedPinnedDataIndexList.length&&d!==!0&&(j=!0);for(var m=0;m<a.state.refreshbodycell.renderedPinnedDataIndexList.length;m++){var n=a.state.refreshbodycell.renderedPinnedDataIndexList[m],o=a.state.data[n];o&&e++}}var p=a.state.visibleIndexMapByColumnIndex;if(!i)if(f>c)a._scrollLeftEvent(p[f]-p[c],!1);else if(c>=h){for(var q=0,r=a.state.columnWidthMap[h],s=c-h+1,t=0,u=0,m=f;m<=a.state.maxColumnIndex,s>u;m++,u++){var v=A(a,m);if(v&&(t+=a.state.columnWidthMap[m],q++,t>r))break}a._scrollRightEvent(q,!1)}j||(e>b&&!(b<a.option.rowFixCount)?a._scrollUpEvent(e-b,!1):b>=g&&!(b<a.option.rowFixCount)&&a._scrollDownEvent(b-g+1,!1)),a._refreshBoard()}function Ab(a){if(!a.state.cellSelection)return a.$root.trigger("cellSelectionEmpty");for(var b=a.state.cellSelection.topBoundaryRenderedIndex,c=a.state.cellSelection.bottomBoundaryRenderedIndex,d=a.state.cellSelection.leftBoundaryColumnIndex,e=a.state.cellSelection.rightBoundaryColumnIndex,f=[],g=b;c>=g;g++)for(var h=a._getRenderedDataFromRenderedIndex(g),i=d;e>=i;i++){var j=A(a,i);j&&h&&(!h._meta&&j.key&&f.push(h[j.key]),h._meta&&f.push(h[j.columnIndex]))}var k="cellSelectionChange";b===c&&d===e&&(k="cellSelectionStart");var l=jQuery.Event(k);l.selectionValueList=f,l.fromSelectionRow=b,l.toSelectionRow=c,l.fromSelectionColumn=d,l.toSelectionColumn=e,a.$root.trigger(l)}function Bb(a){if(a.state.cellSelection){if(a.state.cellSelection.leftBoundaryColumnIndex===a.state.cellSelection.rightBoundaryColumnIndex&&a.state.cellSelection.topBoundaryRenderedIndex===a.state.cellSelection.bottomBoundaryRenderedIndex){var b=a._getRenderedDataFromRenderedIndex(a.state.cellSelection.focusRenderedIndex),c=A(a,a.state.cellSelection.focusColumnIndex);if(b&&c&&c.key)return b[c.key]}for(var d="<table><!-- Alopex UI Grid Table Conversion -->",e=a.state.cellSelection.topBoundaryRenderedIndex,f=a.state.cellSelection.bottomBoundaryRenderedIndex,h=[],i=a.state.cellSelection.leftBoundaryColumnIndex;i<=a.state.cellSelection.rightBoundaryColumnIndex;i++){var c=a.state.columnIndexToMapping[i];c&&Q(c)&&h.push(c)}d+="<colgroup>";for(var i=0,j=h.length;j>i;i++){var c=h[i];d+='<col style="width:'+c.width+';">'}d+="</colgroup>",d+="<tbody>";var k=a.state.cellSelection;a.state.cellSelection=null;for(var l=[],m=e;f>=m;m++){var b=a._getRenderedDataFromRenderedIndex(m);if(b){d+="<tr>";for(var i=0,j=h.length;j>i;i++)if(l[i]=l[i]||0,l[i]>0)l[i]--;else{var c=h[i],n=ob(a,m,c.columnIndex),o=pb(a,b,c),p=a._generateCellAttribute(b,c);p.styleclass="cell bodycell "+p.styleclass;var q=b[c.key],r=0;if(n&&(r=n.to-m+1,l[i]=r-1,p.rowspan=r),o>c.columnIndex){for(var s=1,t=i+1;j>t;t++){var u=h[t];if(u.columnIndex<=o&&s++,u.columnIndex>=o)break}p.colspan=s,i+=s-1}d+="<td";var v=document.createElement("div");v.className=p.styleclass,a.$wrapper[0].appendChild(v);var w=window.getComputedStyle(v);p.style=(p.style||"")+"background-color:"+w.getPropertyValue("background-color")+";color:"+w.getPropertyValue("color")+";",a.$wrapper[0].removeChild(v),v=null,w=null;for(var x in p){var y=x,z=p[x];"styleclass"===y&&(y="class"),d+=" "+y+'="'+z+'"'}d+=">",d+=g(q)?String(q).replace(/\n/g,'<br style="mso-data-placement:same-cell;"/>'):"",d+="</td>"}d+="</tr>"}}return a.state.cellSelection=k,d+="</tbody></table>"}}function Cb(a){var b=document.createElement("textarea");return b.innerHTML=a,b.value}function Db(b,c){var d=[];if(c.indexOf("&lt;table")>=0&&c.indexOf("table&gt;")>=0&&(c=Cb(c)),c.indexOf("<table")>=0){c=c.slice(c.indexOf("<table")),c.lastIndexOf("</table>")>=0&&(c=c.slice(0,c.lastIndexOf("</table>"))+"</table>");var e=a(c),f=e.find("tr");f.each(function(a){d[a]=[]}),f.each(function(b,c){a(c).children().each(function(a,c){if(c.rowSpan>1)for(var e=b+parseInt(c.rowSpan),f=b+1;e>f;f++)d[f][a]=null;if(c.colSpan>1)for(var g=a+1;a+colSpan>g;g++)d[b][g]=null;null!==d[b][a]&&(d[b][a]=c.innerText)})})}if(!d.length)return!1;var g=b.state.visibleIndexMapByColumnIndex[b.state.cellSelection.focusColumnIndex];db(b,b.state.cellSelection.focusRenderedIndex,b.state.cellSelection.focusColumnIndex);for(var h=0;h<d.length;h++)for(var i=b.state.cellSelection.focusRenderedIndex+h,j=0;j<d[h].length;j++){var k=b.state.visibleColumnMappingList[g+j];if(k){var l=k.columnIndex,m=d[h][j];sb(b,i,l),void 0!==m&&null!==m&&b._endCellEdit({renderedIndex:i,columnIndex:l,value:d[h][j]},!0)}}return b._refreshBoard(!0),fb(b),eb(b),nb(b),Ab(b),!0}function Eb(a,b,c){var d=a.state.visibleIndexMapByColumnIndex[b];return c=c||1,a.state.visibleColumnMappingList[Math.max(d-c,0)].columnIndex}function Fb(a,b,c){var d=a.state.visibleIndexMapByColumnIndex[b];return c=c||1,a.state.visibleColumnMappingList[Math.min(d+c,a.state.visibleColumnCount-1)].columnIndex}function Gb(a){a.state.headerSelection&&(delete a.state.headerSelection.from,delete a.state.headerSelection.to,a.$wrapper.find(".headercell").removeClass("header-selected"))}function Hb(b){return a(b).data(Qb.KEY_NAME)}function Ib(b){a.isPlainObject(b)&&(Qb.commonOption=Qb.commonOption||{},Qb.commonOption=a.extend({},Qb.commonOption,b))}window.console||(window.console={history:[],historyLimit:200,log:function(){for(this.history.push(Array.prototype.join.call(arguments," "));this.history.length>this.historyLimit;)this.history.shift()}});{var Jb=a(window),Kb=(a(window.top),"ontouchstart"in document.documentElement||"ontouchstart"in window),Lb=(/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),function(){for(var a=3,b=document.createElement("b"),c=b.all||[];b.innerHTML="<!--[if gt IE "+ ++a+"]><i><![endif]-->",c[0];);return h(a>4?a:document.documentMode,document.documentMode)}(),function(){var a,b=document.createElement("div"),c=null,d=["{45EA75A0-A269-11D1-B5BF-0000F8051515}","{3AF36230-A269-11D1-B5BF-0000F8051515}","{89820200-ECBD-11CF-8B85-00AA005B4383}"];try{b.style.behavior="url(#default#clientcaps)"}catch(e){}for(a=0;a<d.length;a++){try{c=b.getComponentVersion(d[a],"componentid").replace(/,/g,".")}catch(e){}if(c)break}return"string"==typeof c?Number(c.split(".")[0]):null}(),a.fn.hasOwnProperty("tap")||a.fn.hasOwnProperty("singletap")),Mb=Kb&&Lb;"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;var f=+b||0;if(1/0===Math.abs(f)&&(f=0),f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);e>c;){if(c in d&&d[c]===a)return c;c++}return-1}),Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(null==this)throw new TypeError(" this is null or not defined");var f=Object(this),g=f.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=new Array(g),e=0;g>e;){var h,i;e in f&&(h=f[e],i=a.call(c,h,e,f),d[e]=i),e++}return d});var Nb=Number(Math.random().toString().split(".").pop().slice(-3)),Ob="alopexgrid";a.inArray("dataTransfer",a.event.props)<0&&a.event.props.push("dataTransfer"),a.inArray("clipboardData",a.event.props)<0&&a.event.props.push("clipboardData");var Pb={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"," ":"&nbsp;"};p.plugin={},p.plugin.general=function(b,c,d,e){var f="";if("string"==typeof b)f+=b;else if(a.isFunction(b))f+=b.call(this,c,d,e,b);else if(a.isPlainObject(b)&&b.rule){var g=a.isFunction(b.rule)?b.rule(c,d,e,b):b.rule;for(var h in g)n(g[h],"value")==c&&(f+=n(g[h],"text"))}return f},p.plugin.href=function(a,b){var c="";if(c+='<a href="'+(b||"#")+'" class="',a.styleclass&&(c+=a.styleclass),c+='" ',"object"==typeof a.attr)for(var d in a.attr)c+=d+'="'+a.attr[d]+'" ';return c+=">",a.text&&(c+=a.text),c+="</a>"},p.plugin.string=function(b,d,e,f){d=c(d);var g={tag:"div",attr:{},child:d};g.attr=a.extend(g.attr,a.isPlainObject(b.attr)?b.attr:null),"string"==typeof b.styleclass&&(g.attr.styleclass=b.styleclass);var h=m(b,d,e,f);if("string"==typeof h){var i=h.split(" "),k=d;a.each(i,function(a,b){"comma"===b?k=H(k):"ellipsis"===b&&(g.attr.style=g.attr.style||"",g.attr.style+="text-overflow: ellipsis; white-space: nowrap; overflow: hidden;")}),g.child=k}else if(a.isArray(b.rule)||a.isFunction(b.rule)){for(var k=d,i=(a.isFunction(b.rule)?b.rule(d,e,f):b.rule)||[],l=0,o=i.length;o>l;l++){var p=i[l];void 0!==n(p,"value")&&String(n(p,"value"))===String(d)&&void 0!==n(p,"text")&&(k=n(p,"text"))}g.child=k}return j(a.isEmptyObject(g.attr)?g.child:g)},p.plugin.textarea=function(b,c,e,f){var g={tag:"textarea",attr:{name:(this.option.editableNameWithKey?f.key:null)||d()},child:c};return g.attr=a.extend(g.attr,a.isPlainObject(b.attr)?b.attr:null),"string"==typeof b.styleclass&&(g.attr.styleclass=b.styleclass),g.attr.style&&-1!==g.attr.style.indexOf("width")||(g.attr.style=(g.attr.style||"")+"width:100%;max-width:100%;height:100%;padding:0;"),j(g)},p.plugin.text=function(b,c,e,f){var g=this,h='<input type="text" value="';h+=(void 0===c?"":c)+'" ',h+='name="'+((this.option.editableNameWithKey?f.key:null)||d())+'" ',b.styleclass&&(h+='class="'+b.styleclass+'" '),b.readonly&&(h+=' disabled="disabled"');var i=g.option.innerAlignForEditableText?b.align:"",j=i||b.textAlign?"text-align:"+(i||b.textAlign)+";":"",k=!1;if("object"==typeof b.attr)for(var l in b.attr)"style"==l?(k=!0,h+=l+'="',b.attr[l].toLowerCase().indexOf("width")<0&&(h+="width:100%;"),h+=b.attr[l]+j+'" '):h+=l+'="'+b.attr[l]+'" ';k||(h+='style="width:100%;'+j+'"');var m=null;return"string"==typeof b.rule?m=b.rule.split(" "):a.isArray(b.rule)?m=b.rule:a.isFunction(b.rule)&&(m=b.rule(c,e,f)),a.isArray(m)&&a.each(m,function(a,b){"number"===b?h+=' onkeypress="AlopexGrid._renderNumberOnlyHandler(event);"':("comma"===b||"date"===b||"month"===b)&&(h+=" onkeypress=\"if(AlopexGrid._renderNumberOnlyHandler(event)===false){return false;};return AlopexGrid._renderReplaceHandler(this,event,'"+b+"');\"")}),h+="/>"},p.plugin.select=function(a,b,c,e){var f='<select name="',g=a.rule;if("function"==typeof g&&(g=g(b,c,e)),f+=((this.option.editableNameWithKey?e.key:null)||d())+'" ',a.styleclass&&(f+='class="'+a.styleclass+'" '),"object"==typeof a.attr)for(var h in a.attr)"style"==h?(f+='="',a.attr[h].toLowerCase().indexOf("width")<0&&(f+="width:100%;"),f+=a.attr[h]+'" '):f+=h+'="'+a.attr[h]+'" ';else f+='style="width:100%;"';a.readonly&&(f+=' disabled="disabled"'),f+=">";for(var i in g){var j=g[i];f+='<option value="'+n(j,"value")+'"',n(j,"value")==b&&(f+=' selected="selected"'),f+=">"+(n(j,"text")||n(j,"value"))+"</option>"}return f+="</select>"},p.plugin.radio=function(a,b,c,e){var f="",g=(this.option.editableNameWithKey?e.key:null)||d(),h=a.rule;"function"==typeof h&&(h=h(b,c,e));for(var i in h){var j=h[i];if(f+="<label ","object"==typeof a.attr)for(var k in a.attr)f+=k+'="'+a.attr[k]+'" ';f+='><input type="radio" name="'+g+'" value="'+n(j,"value")+'"',a.readonly&&(f+=' disabled="disabled" '),a.styleclass&&(f+=' class="'+a.styleclass+'" '),n(j,"value")==b&&(f+=' checked="checked"'),f+="/><span>"+(n(j,"text")||n(j,"value"))+"</span>",f+="</label>"}return f},p.plugin.check=function(b,c,e,f){var g="",h=(this.option.editableNameWithKey?f.key:null)||d(),i=b.rule;if("function"==typeof i&&(i=i(c,e,f)),g+='<input type="checkbox" name="'+h+'"',b.styleclass&&(g+=' class="'+b.styleclass+'" '),"object"==typeof b.attr)for(var j in b.attr)g+=j+'="'+b.attr[j]+'" ';if((c===!0||"true"===c)&&(g+=' checked="checked"'),a.isArray(i))for(var k in i){var l=i[k];if(n(l,"value")===c&&n(l,"check")){g+=' checked="checked"';break}}return b.readonly&&(g+=' disabled="disabled"'),g+="/>"},p.plugin.date=function(a,b){var c='<input type="text" data-type="dateinput" ';if("object"==typeof a.attr)for(var d in a.attr)"style"==d?(c+=d+'="',a.attr[d].toLowerCase().indexOf("width")<0&&(c+="width:100%;"),c+=a.attr[d]+'" '):c+=d+'="'+a.attr[d]+'" ';var e=b.substr(0,4)+"-"+b.substr(4,2)+"-"+b.substr(6,2);return c+=' value="'+(0!=b.length?e:"")+'" ',c+="/>"};var Qb=function(b,c){var f=this==window?{}:this,g=window.AlopexGrid,h=a(b).data(g.KEY_NAME);if(h)return f.updateOption(c),f;var i=d();return f.key=i,f.eventns="."+f.key+"t"+Math.random().toString().slice(-5).split(".").join(""),f.unique=e(),f.serial=Qb.serial++,f.state={progressStack:0,data:[],metaData:{},deletedData:[],rendered:[],renderTargetDataIndexList:[],_paddingDataLength:0,footerData:{}},f.option=a.extend(!0,{},g.defaultOption,g.commonOption),f.root=b,f.$root=a(b),f.lastWindowHeight=a(window).height(),f.lastWindowWidth=a(window).width(),f.viewInit(),f.$title=this.$root.find(">.title"),f.$pager=this.$root.find(">.pager"),f.$pagerleft=f.$pager.find(".pagerleft"),f.$pagerright=f.$pager.find(".pagerright"),f.$wrapper=f.$root.find(".wrapper"),f.$footer=f.$root.find(">.footer"),f.$focusfixture=f.$root.find(".fixed-focus-catch"),f.$scrollbarx=a('<div class="scrollbar x"></div>').appendTo(f.$wrapper),a('<div class="scrollbutton leftbutton">').appendTo(f.$scrollbarx),a('<div class="scrollbutton rightbutton">').appendTo(f.$scrollbarx),a('<div class="scrollhandle">').appendTo(f.$scrollbarx),f.$scrollbary=a('<div class="scrollbar y"></div>').appendTo(f.$wrapper),a('<div class="scrollbutton upbutton">').appendTo(f.$scrollbary),a('<div class="scrollbutton downbutton">').appendTo(f.$scrollbary),a('<div class="scrollhandle">').appendTo(f.$scrollbary),f.state.bodyCellList=f.$wrapper[0].getElementsByClassName("bodycell"),f.state.nodataCell=f.$wrapper[0].getElementsByClassName("nodatacell"),f.state.bodyFixedColumnCellList=f.$wrapper[0].getElementsByClassName("bodycell-fixcol"),f.state.bodyPinnedCellList=f.$wrapper[0].getElementsByClassName("bodycell-pinned"),f.state.bodyRowspanCellList=f.$wrapper[0].getElementsByClassName("cell-rowspan-column"),f.state.bodyColspanCellList=f.$wrapper[0].getElementsByClassName("cell-colspan-column"),f.state.headerCellList=f.$wrapper[0].getElementsByClassName("headercell"),f.updateOption(c),f.option.pager&&a.isPlainObject(f.option.paging)&&a.isFunction(f.option.paging.pageSet)&&setTimeout(function(){f.pageSet(1)},0),a(b).data(g.KEY_NAME,f).attr("data-alopexgrid",i),f.state.loaded=!0,g.instances[i]=f,setTimeout(function(){f._triggerGridEvent("dataChanged",{api:"init"})},0),f};a.extend(Qb,{KEY_NAME:d(),serial:0,instances:{},i18n:function(a){return Qb.i18nLocaleSet[Qb.locale][a]},locale:"ko",i18nLocaleSet:{ko:{freezePanes:"틀고정"},en:{freezePanes:"Freeze Panes"}},markup:{child:[{tag:"div",attr:{styleclass:"title"}},{tag:"div",attr:{styleclass:"wrapper",style:"width:100%;"},child:""},{tag:"div",attr:{contentEditable:"true",style:"position:absolute;left:-1px;top:-1px;width:1px;height:1px;outline:none;padding:0;margin:0;border:none;overflow:hidden;",styleclass:"fixed-focus-catch focus"}},{tag:"div",attr:{styleclass:"footer",style:"position:relative;"},child:[]},{tag:"div",attr:{styleclass:"pager",style:"position:relative;"},child:[{tag:"div",attr:{styleclass:"pagerleft",style:""},child:""},{tag:"div",attr:{styleclass:"pagercenter"},child:[{tag:"div",attr:{styleclass:"pagination first-page","data-to-page":"first"}},{tag:"div",attr:{styleclass:"pagination prev-page","data-to-page":"prev"}},{tag:"ul",attr:{styleclass:"pagination page-list","data-to-page":"list"}},{tag:"div",attr:{styleclass:"pagination next-page","data-to-page":"next"}},{tag:"div",attr:{styleclass:"pagination last-page","data-to-page":"last"}}]},{tag:"div",attr:{styleclass:"pagerright",style:""},child:""}]}]},markupTemplate:{colgroup:{tag:"colgroup"},col:{tag:"col"},row:{tag:"tr",attr:{styleclass:"row"}},cell:{tag:"td",attr:{styleclass:"cell"}},headerRow:{tag:"tr",attr:{styleclass:"row header"}},headerCell:{tag:"td",attr:{styleclass:"cell header"}}},defaultOption:{width:null,height:null,header:!0,scroll:!0,title:!1,pager:!1,data:[],dataLengthLimit:null,paging:{left:!1,right:!1},defaultColumnMapping:{width:"100px"},columnMapping:[],rowOption:{},footer:{position:null,footerMapping:[]},on:{cell:{},row:{},headercell:{},headerrow:{},invalidEdit:null,scrollBottom:null,sortToggle:null,sortClear:null,pageSet:null,perPageChange:null,data:{add:null,set:null,edit:null,empty:null,"delete":null,undelete:null,select:null,selected:null,changed:null}},autoResize:!0,autoResizeDelay:200,minColumnWidth:10,floatingHeader:!0,message:{nodata:null,dataLengthLimit:null,valueFilter:null,pagerTotal:null},rowClickSelect:!1,rowSingleSelect:!1,rowInlineEdit:!1,rowspanGroupSelect:!0,rowspanGroupEdit:!0,useClassHovering:!0,progressDelay:null,scrollBottomDelay:50,numberingColumnFromZero:!0,defaultState:{dataAdd:{},dataSet:{}},defaultUIComponent:{check:{},select:{},radio:{},text:{},textarea:{}},eventMapping:{},renderMapping:{},rowHeightCompensate:0,valueFilter:null,endInlineEditByOuterClick:!1,mappingStyleclassToHeader:!0,mappingStyleclassToBody:!0,hideSortingHandle:!1,disableHeaderClickSorting:!1,useValidateTooltip:null,getEditingDataOnEvent:!0,fitTableWidth:!0,directEdit:!1,ellipsisText:!1,autoSortingType:!1,lastActionRowClass:"row-last-action",lastActionCellClass:"cell-last-action",clientSortingOnDynamicDataSet:!1,disableFocusedState:!1,useTabindexOnEditable:!1,tabindexBase:2,editableNameWithKey:!1,parseNullValueCell:!1,limitSelectorColumnClickArea:!1,mergeEditingImmediately:!1,fullCompareForEditedState:!1,renderInternallyMerged:!1,fixcolumnTopCompensate:0,grouping:{by:[],useSummary:!0,useGroupRowspan:!1,useGrouping:!1,useGroupRearrange:!1,summaryRender:{sum:function(a){return"합계 : "+a},count:function(a){return"건수 : "+a},groupName:function(a){return a},average:function(a){return"평균 :"+a}},foldShowLength:1},enableHeaderSelect:!1,filteringHeader:!1,filterTypeNameMap:{equal:"일치",notequal:"불일치",contain:"포함",notcontain:"포함하지 않음",lt:"보다 작은",lte:"보다 작거나 같은",gt:"보다 큰",gte:"보다 크거나 같은"},hidePinnedData:!1,rowFixCount:0,cellSelectable:!1,cellInlineEdit:!1,enableDefaultContextMenu:!0,enableContextMenu:!0,defaultContextMenu:[{title:function(){return[Qb.i18n("freezePanes")]},processor:function(b,c,d){{var e=parseInt(c.attr("data-alopexgrid-columnindex"));d.state.columnIndexToMapping[e]}a.each(d.option.columnMapping,function(a,b){b.fixed=b.columnIndex<e});var f=b._index.rendered;d.updateOption({rowFixCount:f})},use:function(a,b){return b.hasClass("bodycell")&&!b.hasClass("summarycell")}},{title:function(){return["틀고정(행)"]},processor:function(b,c,d){a.each(d.option.columnMapping,function(a,b){b.fixed=!1}),d.updateOption(),a(this).alopexGrid("rowFix",b._index.rendered,!0)},use:function(a,b){return b.hasClass("bodycell")&&!b.hasClass("summarycell")}},{title:function(){return"틀고정"},processor:function(b,c,d){a(this).alopexGrid("dataUnpin");var e=parseInt(c.attr("data-alopexgrid-columnindex"));a.each(d.option.columnMapping,function(a,b){b.fixed=b.columnIndex<e}),d.updateOption()},use:function(a,b){return b.hasClass("headercell")&&b.attr("data-alopexgrid-columnindex")}},{title:"틀고정 취소",processor:function(b,c,d){a.each(d.option.columnMapping,function(a,b){b.fixed=!1}),d.updateOption({rowFixCount:0})},use:function(){return!0}},{title:"이 위치에 행 삽입",use:function(a,b){return b.hasClass("bodycell")&&b.attr("data-alopexgrid-renderedindex")},processor:function(b,c,d){var e=a.extend(!0,{},d.state.emptyData),f=parseInt(c.attr("data-alopexgrid-renderedindex")),g=b._index.data;if(b._meta){for(;b._meta&&b;)b=d._getRenderedDataFromRenderedIndex(--f);g=b._index.data+1}if(b){if(d.option.grouping&&d.option.grouping.by&&d.option.grouping.useGrouping)for(var h=0;h<d.option.grouping.by.length;h++){var i=d.option.grouping.by[h];"string"==typeof i&&(e[i]=b[i])}d._showProgress(function(){d.dataAdd(e,{_index:{data:g}})},5)}}},{title:"확대보기",processor:function(b,c,d){if($grid=d.$root,d.state.isZoomed)return void alert("확대보기 실행중입니다.");Jb=a(window);var e,f=a(document.body),g=Jb.scrollTop(),h=$grid.parent();a("#blocker_"+d.key).length>0?(e=a("#blocker_"+d.key),e.show()):(e=a('<div id="blocker_'+d.key+'"></div>'),e.css({overflow:"hidden",display:"block","z-index":"99998",position:"absolute",left:"0",top:"0",width:"100%",height:"100%",background:"#FFFFFF"}),f.append(e));var i,j;a("#content_"+d.key).length>0?(i=a("#content_"+d.key),j=i.find("button"),i.show()):(i=a('<div id="content_'+d.key+'"></div>'),i.css({display:"block","z-index":"99999",position:"absolute",left:"0",top:"0",width:"100%",height:"100%"}),j=a('<a id="closebutton_'+d.key+'">X</a>'),j.css({position:"relative",margin:"5px",border:"1px solid #707070",width:"15px",height:"15px",display:"inline-block","border-width":"thin","border-radius":"3px","line-height":"15px","background-color":"#fff",cursor:"pointer","text-align":"center"}),j.click(function(){f.css("overflow",""),e.hide(),i.hide(),h.append($grid),d.suppressRender(!0),d.updateOption({height:k}),d.suppressRender(!1),d.redraw(),d.state._vspLastLeft=-1,Jb.scrollTop(g),d.state.isZoomed=!1}),i.append(j),f.append(i));var k=d.option.height;i.append($grid),f.css("overflow","hidden"),Jb.scrollTop(0),d.suppressRender(!0),d.updateOption({height:Jb.height()-$grid.offset().top}),d.suppressRender(!1),d.redraw(),d.state.isZoomed=!0}},{title:"필터제거",processor:function(a,b,c){c.clearFilter(!1)},use:function(a,b){return b.hasClass("headercell")||b.hasClass("filtercell")}}],contextMenu:[],contextMenuTitleMapper:null,alwaysShowVerticalScrollBar:!1,alwaysShowHorizontalScrollBar:!1,allowSelectorColumnTitle:!0,extendStateOnSet:!0,extendStateOnAdd:!0,fillUndefinedKey:!1,forceEditedOnEdit:!1,trimUnmappedKey:!1,readonlyRender:!0,disableCellTitle:!1,disableValueEscape:!1,defaultSortingOnDataSet:!0,currentPageInCenter:!1,validateOnchangeForAnyEvent:!1,innerAlignForEditableText:!0,enableHeaderGroupResizing:!0,evaluateAllowEditWithMergedData:!0,setOriginalFromStart:!1},getter:{},trimObject:function(b){var c=a.extend({},b);return delete c._state,delete c._index,delete c._edited,delete c._invalid,delete c._key,delete c._original,c},trimData:function(b){if(a.isArray(b)){for(var c=[],d=0,e=b.length;e>d;d++)a.isPlainObject(b[d])&&c.push(Qb.trimObject(b[d]));return c}return Qb.trimObject(b)},extractElement:function(b){if(!b)return null;var c=b;b.target&&b.target.nodeType&&b.hasOwnProperty("currentTarget")&&b.hasOwnProperty("type")?c=b.target:b.jquery&&b.length&&(c=b[0]);var d=null,e=null;do{if(c.getAttribute("data-alopexgrid-dataid")&&!d&&(d=c),c.getAttribute("data-alopexgrid")&&!e&&(e=a.data(c,Qb.KEY_NAME)),d&&e)break;c=c.parentNode}while(c);return{cell:d,grid:e}},extractGrid:function(a){return Qb.extractElement(a).grid},extractData:function(a){var b=Qb.extractElement(a),c=b.cell,d=b.grid;if(!c&&!d)return null;var e=c.getAttribute("data-alopexgrid-dataid"),f=d.state.dataIdToIndexMap[e],g=d.state.data[f];if(g){var h=c.getAttribute("data-alopexgrid-columnindex"),i=c.getAttribute("data-alopexgrid-key")||(A(self,h)||{}).key;void 0!==i&&null!==i&&i&&(g._key=i),void 0===h||null===h||isNaN(parseInt(h))||(g._index.column=parseInt(h))}return g||null},currentData:function(a){if(!a)return null;if("object"!=typeof a)return null;var b={};for(var c in a)a.hasOwnProperty(c)&&0!==c.indexOf("_")&&(b[c]=a[c]);if(a._state.editing&&a._state.recent)for(var c in a._state.recent)a._state.recent.hasOwnProperty(c)&&(b[c]=a._state.recent[c]);return b},extractCurrentData:function(a){return this.currentData(this.extractData(a))},escapeHTML:function(a){return c(a)},_renderNumberOnlyHandler:function(a){var b=a||window.event,c=b.keyCode||b.which;c=String.fromCharCode(c);var d=/[0-9]|\./;return d.test(c)?void 0:(b.returnValue=!1,b.preventDefault&&b.preventDefault(),!1)},_renderReplaceHandler:function(a,b,c){var d=a,e=d.value;b=b||window.event;var f="number"==typeof b.which?b.which:b.keyCode;if(f&&f>32){var g,h,i=String.fromCharCode(f);if("number"==typeof d.selectionStart&&"number"==typeof d.selectionEnd)g=d.selectionStart,h=d.selectionEnd,e=e.slice(0,g)+i+e.slice(h),d.value=Qb["_"+c+"Formatter"](e),d.selectionStart=d.selectionEnd=g+1+(e.length!==d.value.length?d.value.length-e.length:0);else if(document.selection&&document.selection.createRange){var j=document.selection.createRange(),k=d.createTextRange(),l=d.createTextRange(),m=j.getBookmark();k.moveToBookmark(m),l.setEndPoint("EndToStart",k),g=l.text.length,h=g+j.text.length,e=e.slice(0,g)+i+e.slice(h),d.value=Qb["_"+c+"Formatter"](e),g++,g+=e.length!==d.value.length?d.value.length-e.length:0,k=d.createTextRange(),k.collapse(!0),k.move("character",g-(d.value.slice(0,g).split("\r\n").length-1)),k.select()}return!1}},_commaFormatter:function(a){for(a=a.replace(/,/g,"");/(\d+)(\d{3})/.test(a.toString());)a=a.toString().replace(/(\d+)(\d{3})/,"$1,$2");return a},_dateFormatter:function(a){return a},_monthFormatter:function(a){return a},dragObject:null,clipboard:{},generateKey:d}),window.AlopexGrid=Qb,Qb.run=function(a,b){var c=Qb.instances[a];if(c){var d=Array.prototype.slice.call(arguments,2);return c[b].apply(c,d)}},Qb.prototype.readOption=function(){return a.extend(!0,{},this.option)},Qb.prototype.updateOption=function(b){{var c=this,d=c.option=a.extend(!0,{},c.option,b?b:{});c.$wrapper,c.$pager,c.$title,c.$root}a.isPlainObject(b)&&(b.rowPadding||b.rowpadding)&&(c.option.rowPadding=b.rowPadding||b.rowpadding);var e=["columnMapping","headerGroup"];if(a.each(e,function(c,e){b&&b.hasOwnProperty(e)&&(d[e]=a.extend(!0,[],b[e]))}),b&&b.hasOwnProperty("footer")&&(d.footer=a.extend({},d.footer,b.footer)),c.option.columnMapping){c.state.mappedKey=[],c.state.columnIndexToKeyMap={},c.state.columnKeyToIndexMap={},c.state.columnIndexToMapping={},a.each(c.option.columnMapping,function(a,b){b.hasOwnProperty("key")&&(c.state.mappedKey.push(b.key),c.state.columnKeyToIndexMap[b.key]=parseInt(b.columnIndex)),b.hasOwnProperty("columnIndex")&&(c.state.columnIndexToKeyMap[b.columnIndex]=String(b.key),c.state.columnIndexToMapping[b.columnIndex]=b)}),c.option.columnMapping.sort(function(a,b){var c=g(a.columnIndex)?Number(a.columnIndex):1/0,d=g(b.columnIndex)?Number(b.columnIndex):1/0;return c>d?1:d>c?-1:0});var f=-1,h=0,i=[];a.each(c.option.columnMapping,function(a,b){return null!==b.columnIndex&&void 0!==b.columnIndex&&b.hidden!==!0?b.fixed?(f=b.columnIndex,h+=parseInt(b.width),i.push(b),void 0):!1:void 0}),c.state.fixupto=f,c.state.fixedColumnWidth=h,c.state.fixedColumnMapping=i;var j=-1,k=Number.POSITIVE_INFINITY;c.state.hasNumberingColumn=!1,c.state.hasSelectorColumn=!1,c.state.hasRowindexColumn=!1,c.state.hasAllowEdit=!1,c.state.dataCompositorMap=[],c.state.dataKeyList=[],c.state.hasColspan=!1,c.state.visibleColumnMappingList=[],c.state.visibleIndexMapByColumnIndex={},c.state.visibleIndexMapByKey={};var l=!1;c.state.hasLeftColspanMapByColumnIndex={},a.each(c.option.columnMapping,function(b,d){d.hasOwnProperty("columnIndex")&&(j=Math.max(j,d.columnIndex||0),k=Math.min(k,d.columnIndex)),d.hasOwnProperty("key")&&(c.state.dataKeyList.push(d.key),d.hasOwnProperty("value")&&g(d.key)&&g(d.value)&&c.state.dataCompositorMap.push(d)),(d.colspan||d.colspanTo)&&(c.state.hasColspan=!0,l=!0),d&&Q(d)&&(c.state.visibleColumnMappingList.push(d),c.state.hasLeftColspanMapByColumnIndex[d.columnIndex]=l),d.numberingColumn&&(c.state.hasNumberingColumn=!0),d.selectorColumn&&(c.state.hasSelectorColumn=!0),d.rowindexColumn&&(c.state.hasRowindexColumn=!0),d.allowEdit&&(c.state.hasAllowEdit=!0),a.isPlainObject(c.option.defaultColumnMapping)&&a.each(c.option.defaultColumnMapping,function(a,b){d.hasOwnProperty(a)||(d[a]=b)})});var m=0;a.each(c.state.visibleColumnMappingList,function(a,b){c.state.visibleIndexMapByColumnIndex[b.columnIndex]=a,c.state.visibleIndexMapByKey[b.key]=a,m+=parseInt(b.width)}),c.state.visibleColumnCount=c.state.visibleColumnMappingList.length,c.state.visibleTableWidth=m,c._calcCellWidth(),c.state.emptyData={_index:{},_state:{}};for(var n in c.state.dataKeyList){var o=c.state.dataKeyList[n];c.state.emptyData[o]=""}c.state.dataCompositor=null,c.state.dataCompositorMap.length&&(c.state.dataCompositor=function(b,c){for(var d in b.state.dataCompositorMap){var e=b.state.dataCompositorMap[d];c[e.key]=a.isFunction(e.value)?e.value(c[e.key],c,e):e.value,c._state&&c._state.editing&&c._state.recent&&c._state.recent.hasOwnProperty(e.key)&&(c._state.recent[e.key]=c[e.key])}return c});var p=c.option.fillUndefinedKey!==!1||!!a.map(c.option.columnMapping,function(a){return a.defaultValue}).length,q=c.option.trimUnmappedKey;c.state.dataFilltrimmer=null,(q||p)&&(c.state.dataFilltrimmer=function(b,c){if(p)for(var d in b.option.columnMapping){var e=b.option.columnMapping[d];!g(e.key)||c.hasOwnProperty(e.key)||b.option.fillUndefinedKey===!1&&void 0===e.defaultValue||(c[e.key]=(a.isFunction(e.defaultValue)?e.defaultValue(c):e.defaultValue)||(b.option.fillUndefinedKey===!0?"":b.option.fillUndefinedKey))}if(q)for(var f in c)c.hasOwnProperty(f)&&"_state"!=f&&"_index"!=f&&"_key"!=f&&"_edited"!=f&&a.inArray(f,b.state.mappedKey)<0&&delete c[f]
}),c.state.maxColumnIndex=j}c.state.rowHeightMapByDataId=c.state.rowHeightMapByDataId||{},a.isArray(this.option.data)&&(this.dataSet(this.option.data,!0),this.option.data=null),c.option.cellSelectable||c.option.enableheaderSelect||c.state.hasRowindexColumn?c.$wrapper.addClass("text-selection-disabled").attr("unselectable","on"):c.$wrapper.removeClass("text-selection-disabled").removeAttr("unselectable"),c.state.testRowAllowSelect=!(!c.option.rowOption||!a.isFunction(c.option.rowOption.allowSelect)),c.state.renderingSuppressed||(Gb(c),ab(c),c.pageInfo(),c.calcAndRedraw(),c.viewEventUpdate())},Qb.prototype.updateColumnMapping=function(b,c,d){if(g(b)&&g(c)&&a.isPlainObject(c)&&!a.isEmptyObject(c)){var e=this,f=e.option;if(a.isArray(b))return a.each(b,function(a,b){e.updateColumnMapping(b,c,!0)}),void e.updateOption();var h=f.columnMapping;a.each(h,function(d,e){(Number(e.columnIndex)===Number(b)||"string"==typeof e.key&&e.key===b)&&a.each(c,function(a,b){null===b?delete e[a]:e[a]=b})}),d||e.updateOption()}},Qb.prototype._processSortingMulti=function(b){var c=this;a.isArray(b)&&(c.state.sortingMulti=[],a.each(b,function(b,d){a.isPlainObject(d)&&(d.hasOwnProperty("sortingColumn")||d.hasOwnProperty("sortingKey"))&&c.state.sortingMulti.push(a.extend({},d))}))},Qb.prototype._processDefaultSorting=function(){var b=this;delete b.state.sortingColumn,delete b.state.sortingDirection,delete b.state.sortingMulti;for(var c in b.option.columnMapping){var d=b.option.columnMapping[c],e=d.sorting;if(e)if("desc"==e||"asc"==e)b.state.sortingColumn=b.columnIndex,b.state.sortingDirection=e;else if(b.option.defaultSorting){var f=Number(g(b.option.defaultSorting.columnIndex)?b.option.defaultSorting.columnIndex:b.option.defaultSorting.sortingColumn);Number(d.columnIndex)===f&&(b.state.sortingColumn=d.columnIndex,b.state.sortingDirection=b.option.defaultSorting.sorting||b.option.defaultSorting.sortingDirection)}}a.isPlainObject(b.option.defaultSorting)&&a.isArray(b.option.defaultSorting.sortingMulti)&&b._processSortingMulti(b.option.defaultSorting.sortingMulti)},Qb.prototype.viewInit=function(){var b=this;b.option.defaultSortingOnDataSet||b._processDefaultSorting(),a(b.root).addClass("alopexgrid positioner").html(j(Qb.markup))},Qb.prototype.viewUpdate=function(b){{var c=this,d=(c.$root,c.option),e=c.state,f=c.$title,g=c.$pager;c.$wrapper}if(!e.renderingSuppressed){if(f[d.title?"show":"hide"](),d.title){var h=d.title;"function"==typeof h&&(h=h.call(c)),h&&f.html(h)}c.$footer[c._hasFooter("bottom")?"show":"hide"](),g[d.pager?"show":"hide"](),c._calcCellWidth();var i=0;a.each(c.state.visibleColumnMappingList,function(a,b){i+=parseInt(b.width)});var j=a('<div class="alopexgrid positioner"><div class="wrapper"></div></div>'),k=a('<div class="cell bodycell" style="top:-999px;left:-999px;">&nbsp;</div>'),l=a('<div class="cell headercell" style="top:-999px;left:-999px;">&nbsp;</div>');c.$root.is(":visible")?c.$wrapper.append(k,l):(j.css("position","absolute").css("top","-9999px").css("left","-9999px").appendTo(document.body),j.children().append(k,l)),e.rowHeight=k.outerHeight(),e.rowContentHeight=k.height(),e.headerRowHeight=l.outerHeight(),e.headerRowContentHeight=l.height(),e.cellUpdownBorderWidth=e.rowHeight-e.rowContentHeight,e.cellSideBorderWidth=k.outerWidth()-k.width(),e.headerCellSideBorderWidth=l.outerWidth()-l.width(),e.headerCellUpdownBorderWidth=e.headerRowHeight-e.headerRowContentHeight,k.remove(),l.remove(),j.remove();var m=!1;if(d.height&&!isNaN(Number(d.height))){m=!0,c.$root.css("overflow-y","");var n=parseInt(d.height),o=c.$title.prop("offsetHeight"),p=c.$pager.prop("offsetHeight"),q=n-(c.$wrapper.prop("offsetHeight")-c.$wrapper.prop("clientHeight"))-p-o;c.$root.css("height",n+"px"),c.$wrapper.css("height",q+"px")}else c.$root.css("overflow-y","visible"),c.$root.css("height",""),c.$wrapper.css("height","");if(d.height&&"string"==typeof d.height&&isNaN(Number(d.height))&&d.height.indexOf("row")>=0){var r=parseInt(d.height.split("row")[0]);if("rowpadding"===d.height.toLowerCase()&&c.option.rowPadding&&(r=c.option.rowPadding),r){var s=parseInt(c.state.headerHeight+c.state.rowHeight*r);c.$wrapper.css("height",s+c.state.scrollbarxHeight+"px"),m=!0}}d.width?c.$root.css("width",d.width+"px"):c.$root.css("width","");var t=c.$scrollbary.find(".upbutton"),u=c.$scrollbary.find(".downbutton"),v=c.$scrollbarx.find(".leftbutton"),w=c.$scrollbarx.find(".rightbutton");c.option.alwaysShowVerticalScrollBar?(c.$scrollbary.css({width:"",overflow:""}),w.css("right","")):d.height?(c.$scrollbary.css({width:"",overflow:""}),w.css("right","")):(c.$scrollbary.css({width:"0px",overflow:"hidden"}),w.css("right","0px")),c.state.scrollbaryWidth=c.$scrollbary.outerWidth(),c.state.wrapperWidth=Math.round(c.$wrapper.width()-c.state.scrollbaryWidth),c.option.alwaysShowHorizontalScrollBar?(c.$scrollbarx.css({height:"",overflow:"hidden"}),u.css("bottom","")):i<c.state.wrapperWidth?(c.$scrollbarx.css({height:"0px",overflow:"hidden"}),u.css("bottom","0px")):(c.$scrollbarx.css({height:"",overflow:"hidden"}),u.css("bottom","")),c.state.scrollbaryTrackTop=parseInt(t.position().top+t.outerHeight()),c.state.scrollbaryTrackBottom=parseInt(u.position().top),c.state.scrollbaryTrackLength=parseInt(c.state.scrollbaryTrackBottom-c.state.scrollbaryTrackTop)+1,c.state.scrollbarxTrackLeft=parseInt(v.position().left+v.outerWidth()),c.state.scrollbarxTrackRight=parseInt(w.position().left),c.state.scrollbarxTrackLength=parseInt(c.state.scrollbarxTrackRight-c.state.scrollbarxTrackLeft)+1,c.state.scrollbarxHeight=c.$scrollbarx.outerHeight(),c.state.wrapperHeight=m?Math.round(c.$wrapper.height()-c.state.scrollbarxHeight):Number.POSITIVE_INFINITY,c._setScrollInfo();var x=!0;b&&b.viewOnly===!0&&(x=!1),c._refreshBoard(x),d.height||(c.state.wrapperHeight=(c.state.headerHeight||0)+(c.state.bodyHeight||0),c.$wrapper.css("height",c.state.wrapperHeight+c.state.scrollbarxHeight+"px"),m=!0)}},Qb.prototype._refreshHeaderCells=function(b){{var c=this,e=c.state.headerCellList,f=c.state.visibleColumnMappingList,g=(c.state.visibleColumnCount,c.state.visibleIndexMapByColumnIndex),h={},i=!1;c.state.fixupto}b=b===!0,b===!0&&delete c.state.refreshheadercell,c.state.refreshheadercell=c.state.refreshheadercell||{};var k=c.state.renderFromColumnIndex||0,l=c.state.refreshheadercell.prevRenderFrom,m=k,n=(c.state.wrapperWidth,c.state.scrollxEnd),o=0,p=[],r=[],s=0;if(c.option.header!==!1){for(var t=0,u=c.option.columnMapping.length;u>t;t++){var v=c.option.columnMapping[t];if(v&&parseInt(v.columnIndex)>=0&&v.hidden!==!0&&(v.columnIndex<=c.state.fixupto?(o+=parseInt(v.width),p.push(v),r.push(v),v.columnIndex<k&&s++):v.columnIndex>=k&&(s?s--:(o+=parseInt(v.width),p.push(v))),o>c.state.wrapperWidth&&!n))break}m=(p[Math.max(p.length-1,0)]||{}).columnIndex;var w=1;o<=c.state.wrapperWidth&&(n=!1),o&&c.option.fitTableWidth&&o<c.state.wrapperWidth&&(w=c.state.wrapperWidth/o),!b&&c.option.fitTableWidth&&w!==c.state.refreshheadercell.fitRatio&&(b=!0);for(var x=-(n?o-c.state.wrapperWidth:0),y=[0],z={},A={},B=0,E=p.length;E>B;B++){var v=p[B];A[v.columnIndex]=!0;var F=y[y.length-1];z[v.columnIndex]=F;var G=F+parseInt(v.width)*w;y.push(G)}for(var H={},I=k;m>=I;I++)c.state.columnIndexToMapping[I]&&!A[I]&&(H[I]=!0);for(var F=0,y=[0],J={},B=0,E=p.length;E>B;B++){var v=p[B],K=y[y.length-1];J[v.columnIndex]=K,y.push(K+parseInt(v.width))}for(var L=0,M=f.length;M>L;L++){var v=f[L],N={};N.mapping=v,N.columnIndex=v.columnIndex,N.visibleIndex=L,N.isGroup=!1,h[v.columnIndex]=[N]}if(c.option.headerGroup&&c.option.headerGroup.length)for(var t=c.option.headerGroup.length-1;t>=0;t--){var O=c.option.headerGroup[t];if(O)if(parseInt(O.fromIndex)>=0&&parseInt(O.toIndex)>=0){var N={};if(N.mapping=a.extend(!0,{},O),N.columnIndex=O.fromIndex,N.toColumnIndex=O.toIndex,N.visibleIndex=g[O.fromIndex],N.isGroup=!0,N.colspan=0,c.option.enableHeaderGroupResizing===!0){for(var P=[],Q=O.fromIndex;Q<=O.toIndex;Q++){var R=c.state.columnIndexToMapping[Q];R&&R.columnIndex>=0&&R.hidden!==!0&&R.resizing&&P.push(R.columnIndex)}P.length&&(N.mapping.resizing=P)}for(var Q=O.fromIndex;Q<=O.toIndex;Q++){var R=c.state.columnIndexToMapping[Q];R&&R.columnIndex>=0&&R.hidden!==!0&&(N.colspan+=1,O.hideSubTitle===!0&&(h[R.columnIndex]=[]),h[R.columnIndex].unshift(N))}}else O.hideSubTitle===!0&&(i=!0)}var S=0;for(var t in h){var T=h[t];i&&T.splice(1,T.length-1),S=Math.max(T.length,S)}for(var t in h){for(var T=h[t],Q=0,U=T.length-1;U>Q;Q++){var N=T[Q];N.mapping&&N.mapping.resizing&&(N.disableResizing=!0)}if(T.length<S){var V=T[T.length-1];V.rowspan=S-T.length+1;for(var Q=1;Q<V.rowspan;Q++)T.push(null)}}if(c.option.filteringHeader){for(var t in h){var T=h[t],N={filter:!0,columnIndex:parseInt(t)};T.push(N)}S+=1}for(var t=0,u=p.length;u>t;t++)for(var v=p[t],T=h[v.columnIndex],W=0,X=T.length;X>W;W++){var N=T[W];if(N&&N.colspan>1)for(var Y=g[N.columnIndex],Z=Y+parseInt(N.colspan)-1,$=v.columnIndex+1,_=(c.state.visibleColumnMappingList[Z]||c.state.visibleColumnMappingList[c.state.visibleColumnMappingList.length-1]).columnIndex,Q=$,U=_;U>=Q;Q++){var ab=h[Q];ab&&(ab[W]?ab[W]=null:0)}}for(var I in h)A[I]||delete h[I];for(var bb={},cb=c.state.visibleIndexMapByColumnIndex,db=(cb[k]-cb[l],[]),t=0,u=e.length;u>t;t++)db.push(e[t]);for(var t=0,u=db.length;u>t;t++){var eb=db[t],fb=parseInt(eb.getAttribute("data-alopexgrid-columnindex")),W=parseInt(eb.getAttribute("data-alopexgrid-columndepth"));if(!(fb>=0&&W>=0)||fb>m||W>=S)c.$wrapper[0].removeChild(eb);else{var T=h[fb];T&&T[W]?bb[fb+","+W]=!0:c.$wrapper[0].removeChild(eb)}}for(var t=0,u=p.length;u>t;t++)for(var v=p[t],fb=v.columnIndex,T=h[v.columnIndex],W=0;S>W;W++){var N=T[W];if(!bb[fb+","+W]&&N){var eb=document.createElement("div");eb.className="cell headercell",eb.setAttribute("data-alopexgrid-columnindex",fb),eb.setAttribute("data-alopexgrid-columndepth",W),c.$wrapper[0].appendChild(eb)}}db=[];for(var t=0,u=e.length;u>t;t++)db.push(e[t]);for(var gb=[],hb=[0],W=0;S>W;W++)gb[W]=(c.option.headerRowHeight?"number"==typeof c.option.headerRowHeight?c.option.headerRowHeight:c.option.headerRowHeight[W]:null)||c.state.headerRowHeight,hb.push(hb[hb.length-1]+gb[W]);for(var t=0,u=db.length;u>t;t++){var eb=db[t],fb=parseInt(eb.getAttribute("data-alopexgrid-columnindex")),W=parseInt(eb.getAttribute("data-alopexgrid-columndepth")),T=h[fb],N=T[W],v=N.mapping;b&&(eb.className="cell headercell");var ib=z[fb];n&&fb>c.state.fixupto&&(ib+=x);var jb=hb[W],kb=c.state.columnWidthMap[fb]*w,lb=gb[W];if(N.rowspan>1){var mb=W,nb=W+parseInt(N.rowspan)-1;lb=0;for(var ob=mb;nb>=ob;ob++)lb+=gb[ob]}if(N.colspan>1&&N.isGroup){kb=0;for(var pb=N.mapping.fromIndex;pb<=N.mapping.toIndex;pb++)kb+=c.state.columnWidthMap[pb]*w||0,void 0!==c.state.visibleIndexMapByColumnIndex[pb]&&fb>pb&&(ib-=c.state.columnWidthMap[pb]*w)}var qb=ib+"px",rb=jb+"px";eb.style.left!==qb&&(eb.style.left=qb),eb.style.top!==rb&&(eb.style.top=rb);var sb=kb+"px",tb=lb+"px";if(eb.style.width!==sb&&(eb.style.width=sb),eb.style.height!==tb&&(eb.style.height=tb),!eb.isHeaderCellRendered||b){var ub="",vb=document.createDocumentFragment(),wb=document.createElement("span"),xb=!1,yb=!1;if(N.filter){var zb=c.state.columnIndexToMapping[N.columnIndex];if(zb&&zb.key){var Ab=c._filterCellRender(zb,!0);vb.appendChild(Ab)}yb=!0,ub+=" filtercell"}if(fb<=c.state.fixupto&&(ub+=" fixed cell-fixcol",fb===c.state.fixupto&&(ub+=" cell-fixcol-lastcolumn")),N.isGroup&&(ub+=" header-group",N.rowspan>1&&(ub+=" header-group-rowspan"),N.colspan>1&&(ub+=" header-group-colspan"),c.state.fixupto>=0&&v.fromIndex<=c.state.fixupto&&v.toIndex>=c.state.fixupto&&(ub+=" cell-fixcol-lastcolumn")),v){{a(eb)}if(v.styleclass&&c.option.mappingStyleclassToHeader){var Bb=v.styleclass;"function"==typeof Bb&&(Bb=Bb.call(c,null,null,v)||""),"string"==typeof Bb&&(ub+=" "+Bb)}if(v.headerStyleclass){var Bb=v.headerStyleclass;a.isFunction(Bb)&&(Bb=Bb.call(c,v)||""),"string"==typeof Bb&&(ub+=" "+Bb)}if(c.state.headerSelection){var Cb=Math.min(c.state.headerSelection.from,c.state.headerSelection.to),Db=Math.max(c.state.headerSelection.from,c.state.headerSelection.to);v.columnIndex>=Cb&&v.columnIndex<=Db&&(ub+=" header-selected")}if((v.columnIndex||v.fromIndex)+N.colspan>=c.state.maxColumnIndex&&(ub+=" lastcolumn lastcell"),!v.selectorColumn||"string"==typeof v.title&&c.option.allowSelectorColumnTitle||(ub+=" selector-column","only"===c.option.rowClickSelect||c.option.rowSingleSelect||eb.setAttribute("onclick","AlopexGrid.run('"+c.key+"','_rowSelectAll',event,this);")),!v.selectorColumn||"string"==typeof v.title&&c.option.allowSelectorColumnTitle){var Eb=v.title;a.isFunction(Eb)&&(Eb=Eb.call(c,v)),wb.innerHTML=Eb||"&nbsp;"}else{var Fb={tag:"input",attr:{type:"checkbox",name:d()}};("only"===c.option.rowClickSelect||c.option.rowSingleSelect)&&(Fb.attr.disabled="disabled"),c.state.selectAll&&(Fb.attr.checked="checked"),wb.innerHTML=j(Fb)}var Gb=v.sorting,P=q(v,"resizing");if(Gb||P){if(xb=!0,Gb&&v.key&&!v.selectorColumn){var Hb=null;if(ub+=" sorting",c.option.disableHeaderClickSorting!==!0&&(ub+=" click-sortable"),c.option.hideSortingHandle!==!0&&(Hb=C(c),vb.appendChild(Hb),void 0!==c.state.sortingColumn)){if(Number(v.columnIndex)===Number(c.state.sortingColumn)){var Ib=c.state.sortingDirection||"asc";if(ub+=" "+Ib,c.state.sortingMulti&&c.state.sortingMulti.length&&Hb){var Jb=document.createElement("span"),Kb=document.createTextNode("1");Jb.className="multi-sorting-order",Jb.appendChild(Kb),Hb.appendChild(Jb)}}c.state.sortingMulti&&a.each(c.state.sortingMulti,function(a,b){if(b.sortingColumn===Number(v.columnIndex)||b.sortingKey===v.key){ub+=" "+(b.sortingDirection||"asc");var c=document.createElement("span"),d=document.createTextNode(String(a+2));c.className="multi-sorting-order",c.appendChild(d),Hb.appendChild(c)}})}c.option.disableHeaderClickSorting?String(eb.getAttribute("onclick")).indexOf("_sortToggle")>=0&&eb.removeAttribute("onmousedown"):eb.setAttribute("onmousedown","event.preventDefault();AlopexGrid.run('"+c.key+"','_sortToggle',"+v.columnIndex+",null,event);")}if(P&&!N.disableResizing)if(a.isArray(P))for(var Lb=c.state.columnWidthMap,Mb=0,Nb=[],Ob=v.toIndex;Ob>=v.fromIndex;Ob--){var Hb=D(c,{columnIndex:Ob});Ob!==v.toIndex&&(Hb.style.right=Mb+"px"),Nb.push(Ob),Mb+=Lb[Ob],a.inArray(Ob,P)>=0&&vb.appendChild(Hb)}else vb.appendChild(D(c,{columnIndex:fb}))}}for(;eb.firstChild;)eb.removeChild(eb.firstChild);if(xb){var Pb=document.createElement("div");Pb.className="relative-wrap",yb||Pb.appendChild(wb),Pb.appendChild(vb),eb.appendChild(Pb)}else yb||eb.appendChild(wb),eb.appendChild(vb);yb||(wb.className="column-title"),eb.className+=ub,eb.isHeaderCellRendered=!0}}c.state.refreshheadercell.prevRenderFrom=k,c.state.refreshheadercell.fitRatio=w,c.state.headerHeight=gb.length?gb.reduce(function(a,b){return a+b}):0,h=null}else{c.state.headerHeight=0;for(var db=[],u=e.length||0,t=0;u>t;t++)db.push(e[t]);u=db.length;for(var t=0;u>t;t++){var eb=db[t];eb.parentNode&&eb.parentNode.removeChild(eb)}}},Qb.prototype._generateCellAttribute=function(a,b){var c=this,d={styleclass:["alopexgrid-cell"]},e=b.key,f=c.state;if(a){if(d["data-alopexgrid-renderedindex"]=a._index.rendered,d["data-alopexgrid-columnindex"]=b.columnIndex,d["data-alopexgrid-dataindex"]=a._index.data,d["data-alopexgrid-dataid"]=a._index.id,d.styleclass.push(a._index.id),d.styleclass.push(a._index.rendered%2?"row-odd":"row-even"),a._state.selected&&d.styleclass.push("selected"),a._state.edited&&d.styleclass.push("edited"),a._state.focused&&d.styleclass.push("focused"),a._state.deleted&&d.styleclass.push("deleted"),a._state.editing&&d.styleclass.push("editing"),a._state.added&&d.styleclass.push("added"),!c.option.disableCellTitle&&b.key&&a&&b.tooltip){var g=a[b.key],h=g;"function"==typeof b.tooltip?h=b.tooltip(g,a,b)||"":"string"==typeof b.tooltip&&(h=b.tooltip),d.title=Qb.escapeHTML(h||"")}if(c.option.rowOption){if(c.option.rowOption.styleclass){var i=c.option.rowOption.styleclass;"function"==typeof i&&(i=i.call(c,a,c.option.rowOption)),i&&"string"==typeof i&&d.styleclass.push(i)}if(c.option.rowOption.highlight){var i=c.option.rowOption.highlight;"function"==typeof i&&(i=i.call(c,a,c.option.rowOption)),i&&(d.styleclass.push("row-highlight"),"string"==typeof i&&d.styleclass.push(i))}}if(b.styleclass&&c.option.mappingStyleclassToBody){var j=b.styleclass;"function"==typeof j&&(j=j.call(c,a[e],a,b)),j&&"string"==typeof j&&d.styleclass.push(j)}if(b.highlight){var j=b.highlight;"function"==typeof j&&(j=j.call(c,a[e],a,b)),j&&(d.styleclass.push("cell-highlight"),"string"==typeof j&&d.styleclass.push(j))}if(b.bodyStyleclass){var j=b.bodyStyleclass;"function"==typeof j&&(j=j.call(c,a[e],a,b)),j&&"string"==typeof j&&d.styleclass.push(j)}b.columnIndex<=c.state.fixupto&&(d.styleclass.push("cell-fixcol"),b.columnIndex===c.state.fixupto&&d.styleclass.push("cell-fixcol-lastcolumn")),c.state.pinnedDataIdMap&&c.state.pinnedDataIdMap[a._index.id]&&d.styleclass.push("pinnedcell"),a._index.rendered>=0&&a._index.rendered<c.option.rowFixCount&&(d.styleclass.push("cell-fixrow"),a._index.rendered===c.option.rowFixCount-1&&d.styleclass.push("cell-fixrow-lastrow"));var k=c.state.visibleColumnMappingList[0],l=c.state.visibleColumnMappingList[c.state.visibleColumnMappingList.length-1];k&&k.columnIndex===b.columnIndex&&d.styleclass.push("cell-firstcolumn"),l&&l.columnIndex===b.columnIndex&&d.styleclass.push("cell-lastcolumn"),b.align&&d.styleclass.push("align-"+b.align),b.selectorColumn&&d.styleclass.push("selector-column"),b.groupingColumn&&d.styleclass.push("grouping-column"),b.key&&a._original&&a._original[b.key]!==z(a,b.key)&&d.styleclass.push("cell-edited"),b.key&&(d["data-alopexgrid-key"]=b.key),b.editable&&(a._state.editing||c._isEditingCell(a._index.rendered,b.columnIndex))&&d.styleclass.push("editingcell"),c.option.ellipsisText===!0&&d.styleclass.push("cell-ellipsis-text"),f.cellSelection&&(f.cellSelection.focusColumnIndex===b.columnIndex&&f.cellSelection.focusRenderedIndex===a._index.rendered?d.styleclass.push("cell-selected-focus"):f.cellSelection.focusRowspanInfo&&f.cellSelection.focusRowspanInfo.from<=a._index.rendered&&f.cellSelection.focusRowspanInfo.to>=a._index.rendered&&f.cellSelection.focusColumnIndex===b.columnIndex&&d.styleclass.push("cell-selected-focus"),f.cellSelection.columnIndexMap[b.columnIndex]&&f.cellSelection.renderedIndexMap[a._index.rendered]&&(d.styleclass.push("cell-selected"),f.cellSelection.leftBoundaryColumnIndex===b.columnIndex&&d.styleclass.push("cell-selected-leftline"),f.cellSelection.rightBoundaryColumnIndex===b.columnIndex&&d.styleclass.push("cell-selected-rightline"),f.cellSelection.topBoundaryRenderedIndex===a._index.rendered&&d.styleclass.push("cell-selected-topline"),f.cellSelection.bottomBoundaryRenderedIndex===a._index.rendered&&d.styleclass.push("cell-selected-bottomline")))}else d.styleclass.push("emptycell");return d.styleclass=d.styleclass.join(" "),d},Qb.prototype._generateCellContent=function(a,b){var e=this,f=e.state,g=e.option,h="";if(!a)return h;if(b.selectorColumn){var i=!!a._state.selected,k=!1;(e._triggerGridEvent("dataSelect",{data:a,select:i})===!1||f.testRowAllowSelect&&g.rowOption.allowSelect(a)===!1)&&(i=!1,k=!0),h='<div class="cell-wrapper"><div class="selector-column-wrapper" style="text-align:center;"><input type="checkbox" class="selector-checkbox" name="'+d()+'" '+(i?'checked="checked"':"")+(k?' disabled="disabled"':"")+"></div></div>"}else if(b.groupingColumn){if(g.grouping&&g.grouping.useGrouping)if(g.rowOption&&g.rowOption.allowFolding&&g.rowOption.allowFolding(a)===!1);else{var l=g.grouping.by;l[0]===!0&&(l=l.slice(1));var m={},n=g.grouping.foldingButtonKey;if(g.grouping.foldingButtonKey){"string"==typeof n&&(n=[n]);for(var o=0,q=n.length;q>o;o++)m[n[o]]=!0}for(var r={},o=0;o<l.length;o++)r[l[o]]=o,g.grouping.foldingButtonKey||(m[l[o]]=!0);for(var s=f.groupingLookupTable,o=0;o<l.length;o++){var t=l[o],u=!1,v=!1,w=e._isDataFolded(a);if(m[t]){var x={tag:"div",attr:{styleclass:"alopexgrid-group-icon alopexgrid-handle group-depth-"+o+" group-key-"+t,"data-alopexgrid-groupkey":t}},y=a;if(y._index&&y._index.id){var A=s[l[o]],B=A[y._index.data];w=e._isDataFolded(y,o),"unfold"===w||"unfold-line"===w?(x.attr.styleclass+="unfold"===w?" alopexgrid-group-unfold":B.from===y._index.data?" alopexgrid-group-start":" alopexgrid-group-line",v=!0):y._index.data===B.to?(x.attr.styleclass+=g.grouping.useSummary?" alopexgrid-group-line":" alopexgrid-group-fold",u=!0):y._index.data===B.from?(x.attr.styleclass+=" alopexgrid-group-start",u=!0):g.grouping.useSummary||y._index.data!==B.to?(x.attr.styleclass+=B.from===y._index.data?" alopexgrid-group-start":" alopexgrid-group-line",w===!0?v=!0:u=!0):(x.attr.styleclass+=" alopexgrid-group-fold",u=!0);for(var C=[],D=0;o>=D;D++)C.push(y[l[D]]);x.attr.title=c(C.join(", "))}var E=[];if(u||v)for(var D=0;o>=D;D++)E.push(y[l[D]]);if(u){var F="AlopexGrid.run('"+this.key+"','foldGroup',['"+E.join("','")+"']);";x.attr.onclick=F,x.attr.styleclass+=" alopexgrid-group-action-fold"}if(v){var F="AlopexGrid.run('"+this.key+"','unfoldGroup',['"+E.join("','")+"']);";x.attr.onclick=F,x.attr.styleclass+=" alopexgrid-group-action-unfold"}if(h+=j(x),w&&!g.grouping.useSummary&&!y._meta)break}}}}else if(b.rowindexColumn){var G=" onmousedown=\"AlopexGrid.run('"+e.key+"', '_rowResizeStart',event,"+a._index.rendered+');"';h=a._index.rendered+'<div class="rowindex-column-resizing-handle resizing-handle alopexgrid-handle"'+G+"></div>"}else if(b.numberingColumn){var H=a._index.data+(e.option.numberingColumnFromZero?0:1);h='<div class="numbering-column-wrapper" style="text-align:center;">'+H+"</div>"}else if(b.editable&&(a._state.editing||e._isEditingCell(a._index.rendered,b.columnIndex))){var I=b.editable===!0?{type:"text"}:b.editable;h=p.call(e,I,f.editingCellInfo?f.editingCellInfo.value:z(a,b.key),a,b);var J="AlopexGrid.run('"+e.key+"','_cellEditUpdate',this,'"+a._index.id+"',"+b.columnIndex+",event);",K="$1";K+=' onkeyup="'+J+'"'+(' onclick="'+J+'"')+(' onchange="'+J+'"'),"string"==typeof h&&(h=h.replace(/(<input|<select|<textarea)/g,K))}else{var I=b.render,L=a[b.key];if("editable"===I&&b.editable){var M=b.editable===!0?{type:"text"}:b.editable;I=M,L=f.editingCellInfo?f.editingCellInfo.value:z(a,b.key)}g.readonlyRender&&I&&(I.readonly=!0);var N="&nbsp;";N=b.render?p.call(e,I,L,a,b):a.hasOwnProperty(b.key)&&void 0!==L?g.disableValueEscape?L:c(L):"&nbsp;",h=N}return h},Qb.prototype._createCell=function(a,b,c){var d=this;c||(c=document.createElement("div")),c.className||(c.className="cell bodycell");var e=d._generateCellAttribute(a,b);for(var f in e)"styleclass"===f?c.className+=" "+e[f]:c.setAttribute(f,e[f]);var g=d._generateCellContent(a,b);if("string"==typeof g)c.innerHTML=g;else if(g&&g.nodeType)c.appendChild(g);else if(g&&g.length){for(var h=[],i=0,j=g.length;j>i;i++)h.push(g[i]);for(var i=0,j=h.length;j>i;i++)g=h[i],g&&g.nodeType&&c.appendChild(g)}return c.isCellAttributeGenerated=!0,c.isCellContentGenerated=!0,c},Qb.prototype._refreshBodyCells=function(b){var c=this,d=c.state.bodyCellList,e={dataIndexList:null,columnIndexList:null,dataIndexMap:{},columnIndexMap:{}};if(b&&a.isPlainObject(b)){if(e.dataIndexList=b.dataIndexList,e.dataIndexList)for(var f=0,g=e.dataIndexList.length;g>f;f++)e.dataIndexMap[e.dataIndexList[f]]=!0;if(e.columnIndexList=b.columnIndexList,e.columnIndexList)for(var f=0,g=e.columnIndexList.length;g>f;f++)e.columnIndexMap[e.columnIndexList[f]]=!0;b=!1}if(b===!0&&c.state.refreshbodycell){for(var h in c.state.refreshbodycell)delete c.state.refreshbodycell[h];delete c.state.refreshbodycell}c.state.refreshbodycell=c.state.refreshbodycell||{},c.state.bodyHeight=0;var i=c.state.headerHeight||0,j=c.state.wrapperHeight,k=0,l=c.state.wrapperWidth,m=c.state.scrollxEnd,n=c.state.scrollyEnd,o=k,p=i,q=c.state.renderFromColumnIndex||0,r=c.state.renderFromRenderedIndex||0,s=c.state.refreshbodycell.prevColumnIndex,t=c.state.refreshbodycell.prevRenderedIndex;c.state.refreshbodycell.prevRowFixCount!==c.option.rowFixCount&&(b=!0);var u=1,v=0,w=0;c.state.fixupto>=0&&(o+=c.state.fixedColumnWidth);var x=[];if(c._hasPinnedData())for(var f=0,g=c.state.pinnedDataIdList.length;g>f;f++){var y=c.state.pinnedDataIdList[f],z=c.state.data[c.state.dataIdToIndexMap[y]];z&&(a.inArray(z._index.data,c.state.renderTargetDataIndexList)<0||(p+=c.state.rowHeightMapByDataId[y]||c.state.rowHeight,x.push(z._index.data)))}else if(c.option.rowFixCount>0)for(var f=0,g=c.option.rowFixCount;g>f;f++){var A=c.state.renderTargetDataIndexList[f],z=c.state.data[A];z&&(x[f]=A,p+=c.state.rowHeightMapByDataId[z._index.id]||c.state.rowHeight)}for(var B=[],f=0,g=d.length;g>f;f++)B.push(d[f]);for(var C=0,D=[],E=[],F=0,f=0,g=c.option.columnMapping.length;g>f;f++){var G=c.option.columnMapping[f];if(G&&G.columnIndex>=0&&G.hidden!==!0&&(G.columnIndex<=c.state.fixupto?(C+=parseInt(G.width),D.push(G),E.push(G),G.columnIndex<q&&F++):G.columnIndex>=q&&(F?F--:(C+=parseInt(G.width),D.push(G))),C>c.state.wrapperWidth&&!m))break}v=(D[Math.max(D.length-1,0)]||{}).columnIndex;for(var H={},f=0,g=D.length;g>f;f++)H[D[f].columnIndex]=f;for(var I=0,J=[],K=[],L=0,f=r,g=c.state.renderTargetDataIndexList.length;g>f;f++,L++){var A=L<x.length?x[L]:c.state.renderTargetDataIndexList[f],z=c.state.data[A],M=c.state.rowHeightMapByDataId[z._index.id]||c.state.rowHeight;if(I+=M,J.push(A),L<x.length&&K.push(A),I>j-i&&!n)break}var N=K[K.length-1];N>=0||(N=-1),w=r+J.length-1,c.state.renderToRenderedIndex=w,c.state.renderToColumnIndex=v,l-k>=C&&(m=!1),j-i>=I&&(n=!1),C&&C<=c.state.wrapperWidth&&c.option.fitTableWidth&&(u=c.state.wrapperWidth/C),!b&&c.option.fitTableWidth&&u!==c.state.refreshbodycell.fitRatio&&(b=!0);for(var O={},P=r-t,R=c.state.visibleIndexMapByColumnIndex,S=R[q]-R[s],f=0,g=B.length;g>f;f++){var T=B[f],U=T.getAttribute("data-localbody-x"),V=T.getAttribute("data-localbody-y"),W=parseInt(T.getAttribute("data-alopexgrid-columnindex"));if(U<E.length){var X=E[U];if(W>=0&&X.columnIndex!==W){c.$wrapper[0].removeChild(T);continue}}else if(S){if(U-=S,U<E.length){c.$wrapper[0].removeChild(T);continue}T.setAttribute("data-localbody-x",U)}if(V<K.length);else if(P){if(V-=P,V<K.length){c.$wrapper[0].removeChild(T);continue}T.setAttribute("data-localbody-y",V)}U>=D.length||V>=J.length?c.$wrapper[0].removeChild(T):null===U||null===V||0>U||0>V?c.$wrapper[0].removeChild(T):O[U+","+V]=!0}for(;c.state.nodataCell.length;)c.$wrapper[0].removeChild(c.state.nodataCell[0]);if((!c.state.data||!c.state.data.length)&&c.option.message&&c.option.message.nodata){var Y=document.createElement("div");Y.className="cell emptycell nodata nodatacell",Y.style.top=i+"px",Y.style.left=k+"px",Y.style.width=Math.min(C,l-k)+"px",Y.style.height=c.state.rowHeight+"px";var Z=document.createElement("div");Z.className="cell-wrapper",Z.innerHTML=c.option.message.nodata,Y.appendChild(Z),c.$wrapper[0].appendChild(Y),J.push("emptycell")}if(c.option.rowPadding){var $=c.option.rowPadding;$===!0&&($=c.option.paging.perPage);for(var f=J.length;$>f;f++)J.push(null)}for(var _=[k],ab=[i],bb=0,cb=0,db=D.length;db>cb;cb++){var G=D[cb];_.push(_[_.length-1]+parseInt(G.width)*u);for(var eb=0,fb=0,gb=J.length;gb>fb;fb++){var A=J[fb],z=c.state.data[A],M=(z?c.state.rowHeightMapByDataId[z._index.id]:0)||c.state.rowHeight;if(eb+=M,ab.push(ab[ab.length-1]+parseInt(M)),!O[cb+","+fb]){var Y=document.createElement("div");Y.className="cell bodycell",Y.setAttribute("data-localbody-x",cb),Y.setAttribute("data-localbody-y",fb),c.$wrapper[0].appendChild(Y)}}bb=Math.max(bb,eb)}B=[];for(var f=0,g=d.length;g>f;f++)B.push(d[f]);for(var hb=[],f=0,g=D.length;g>f;f++)hb.push([]);for(var ib={},jb=-(m?C-c.state.wrapperWidth:0),kb=-(n?I+c.state.headerHeight-c.state.wrapperHeight:0),f=0,g=B.length;g>f;f++){var T=B[f],U=parseInt(T.getAttribute("data-localbody-x")),V=parseInt(T.getAttribute("data-localbody-y")),A=J[V];"emptycell"===A&&(ib[U+","+V]=!0);var G=D[U],z=c.state.data[A],lb=!!(b||e.dataIndexMap[A]&&!e.columnIndexList||e.dataIndexMap[A]&&e.columnIndexMap[G.columnIndex]);if(hb[U][V]=T,z&&G?T.id=c._cellIdFromData(z,G.columnIndex):T.removeAttribute("id"),lb===!0&&(T.className="cell bodycell"),ib[U+","+V])c.$wrapper[0].removeChild(T);else{var mb=c.state.hasLeftColspanMapByColumnIndex[G.columnIndex],nb=0;if(!T.cellWidthProcessed||lb||S||isNaN(S)||mb){var ob=G.columnIndex,qb=parseInt(G.width)*u;if(z){var rb=c.state.fixupto>=0&&G.columnIndex===c.state.fixupto,sb=0;if(mb)for(var tb=ob;tb>=0;){var ub=c.state.columnIndexToMapping[tb--];if(ub&&Q(ub)&&(ub.colspan||ub.colspanTo)){var vb=pb(c,z,ub);if(vb>=ob){qb=parseInt(ub.width)||0,ub.columnIndex<ob&&(nb-=qb),vb===c.state.fixupto&&(rb=!0);for(var wb=ub.columnIndex+1;vb>=wb;wb++){var xb=c.state.columnIndexToMapping[wb];if(xb&&Q(xb)){qb+=parseInt(xb.width)||0,sb++,ob>wb&&(nb-=parseInt(xb.width)||0);var yb=H[wb];void 0!==yb&&wb>ob&&(ib[yb+","+V]=!0)}}G=ub;break}}}sb&&(T.className.indexOf("cell-colspan-column")<0?T.className+=" cell-colspan-column":""),rb&&T.className.indexOf("cell-fixcol-lastcolumn")<0&&(T.className+=" cell-fixcol-lastcolumn")}T.style.width!==qb+"px"&&(T.style.width=qb+"px"),T.cellWidthProcessed=!0}if(!T.cellHeightProcessed||lb||P||isNaN(P)){var M=(z?c.state.rowHeightMapByDataId[z._index.id]:0)||c.state.rowHeight;if(z){var zb=z._index.data===N,Ab=0,Bb=!1;if(G.rowspan&&c.option.grouping&&c.option.grouping.useGroupRowspan){var Cb=c._getGroupingRangeByMapping(A,G);if(Cb){if(Ab++,Cb.from===A)Bb=!0;else if(A===J[K.length])Bb=!0;else if(A===J[0])Bb=!0;else{for(var Db=!1,Eb=V<K.length,Fb=V-1;Fb>=0&&(Eb||!(Fb<K.length));Fb--){var Gb=J[Fb];if(null!==Gb&&Cb.from<=Gb&&Gb<=Cb.to){Db=!0;break}}Db||(Bb=!0)}for(var Fb=V+1,Hb=J.length;Hb>Fb;Fb++){var Ib=J[Fb];if(null!==Ib&&Cb.from<=Ib&&Ib<=Cb.to){var Jb=c.state.data[Ib];if(z._index.rendered<c.option.rowFixCount&&Jb._index.rendered>=c.option.rowFixCount)continue;var Kb=Jb?Jb._index.id:null;if(M+=c.state.rowHeightMapByDataId[Kb]||c.state.rowHeight,Ab++,z._index.rendered<c.option.rowFixCount&&Ib===N){zb=!0;break}}}}}if(Ab){if(!Bb){ib[U+","+V]=!0,c.$wrapper[0].removeChild(T);continue}T.className.indexOf("cell-rowspan-column")<0?T.className+=" cell-rowspan-column":"",T.isCellRowspanned=!0}zb&&T.className.indexOf("cell-fixrow-lastrow")<0&&(T.className+=" cell-fixrow-lastrow")}T.style.height=M+"px",T.cellHeightProcessed=!0}var cb=_[U];m&&G.columnIndex>c.state.fixupto&&(cb+=jb);var Lb=cb+nb+"px";T.style.left!==Lb&&(T.style.left=Lb);var fb=ab[V];n&&V>=x.length&&(fb+=kb);var Mb=fb+"px";if(T.style.top!==Mb&&(T.style.top=Mb),!T.isCellAttributeGenerated||lb===!0){var Nb=c._generateCellAttribute(z,G);for(var h in Nb)"styleclass"===h?T.className+=" "+Nb[h]:T.setAttribute(h,Nb[h]);T.isCellAttributeGenerated=!0}if(!T.isCellContentGenerated||lb===!0){var Ob=c._generateCellContent(z,G);"string"==typeof Ob?T.innerHTML=Ob:Ob&&Ob.nodeType&&T.appendChild(Ob),T.isCellContentGenerated=!0}}}for(var h in ib)if(h){var U=h.split(",")[0],V=h.split(",")[1];if(hb[U]&&hb[U][V]){var T=hb[U][V];T.parentNode&&T.parentNode.removeChild(T)}}_=null,ab=null,B=null,d=null,hb=null,O=null,ib=null,c.state.refreshbodycell.prevColumnIndex=c.state.renderFromColumnIndex,c.state.refreshbodycell.prevRenderedIndex=c.state.renderFromRenderedIndex,c.state.refreshbodycell.renderedDataIndexList=J,c.state.refreshbodycell.renderedColumnMappingList=D,c.state.refreshbodycell.renderedFixedColumnMappingList=E,c.state.refreshbodycell.renderedPinnedDataIndexList=x,c.state.refreshbodycell.prevRowFixCount=c.option.rowFixCount,c.state.refreshbodycell.fitRatio=u,c.state.bodyHeight=bb},Qb.prototype._refreshPagingUnit=function(a){for(var b=this,c=b.pageInfo(),d=b.$pager[0].getElementsByClassName("pagination"),e=0,f=d.length;f>e;e++){var g=d[e],i=g.getAttribute("data-to-page");switch(i){case"first":case"prev":case"next":case"last":g.children.length&&a!==!0||(g.innerHTML='<a class="pageset" href="#'+i+'"></a>');break;case"list":var j=1,k=c.total,l=Number(c.pagerCount)||5;if(b.option.currentPageInCenter&&k-j>=l)j=c.current-(l/2|0),k=j+l-1,1>j&&(j=1,k=j+l-1),k>c.total&&(k=c.total,j=c.total-l+1);else{for(k=h(k,l);k<c.current;)j+=l,k+=l;k>c.total&&(k=c.total)
}for(var m=g.getElementsByTagName("li"),n=[],o=0,p=m.length;p>o;o++)n.push(m[o]);for(var q=null,r=null,s=null,o=0,p=n.length;p>o;o++){var t=n[o];if(t.children.length){var u=parseInt(t.firstChild.getAttribute("href").split("#").pop());j>u?g.removeChild(t):u>k?g.removeChild(t):u>=j&&k>=u&&(q=null===q?u:Math.min(q,u),q===u&&(r=t),s=null===s?u:Math.max(s,u),t.className=u===c.current?"current":"")}else g.removeChild(t)}for(var v=j;k>=v;v++)if(!(null!==q&&v>=q&&s>=v)){var t=document.createElement("li");t.setAttribute("data-alopexgrid-pagenumber",v),v===c.current&&(t.className="current"),t.innerHTML='<a class="pageset" href="#'+v+'">'+v+"</a>",null!==q&&q>v?g.insertBefore(t,r):g.appendChild(t)}}}},Qb.prototype._refreshTimerActivate=function(a){var b=this;a===!0?b.state.gridRefreshTimer||(b.state.gridRefreshTimer=setInterval(function(){b._refreshBoard()},40)):a===!1&&(b.state.gridRefreshTimer&&(b._refreshBoard(),clearInterval(b.state.gridRefreshTimer)),b.state.gridRefreshTimer=null)},Qb.prototype._generateTranslatex=function(a){var b=this,c=0,d=0;if(null!=b.state.fixedColumnMapping&&(d=b.state.fixedColumnMapping.length),null!=b.state.standardColumnWidthMap){var e,f;for(var g in b.state.standardColumnWidthMap){if(e=b.state.standardColumnWidthMap[g],f=b.state.columnIndexArr[b.state.columnIndexArr.indexOf(Number(g))-d],0>=a||f>=a)break;c+=e}}return c},Qb.prototype._getColumnIndex=function(a){var b=this,c=0,d=0,e=0;if(null!=b.state.fixedColumnMapping&&(e=b.state.fixedColumnMapping.length),null!=b.state.standardColumnWidthMap)for(var f in b.state.standardColumnWidthMap)if(c+=b.state.standardColumnWidthMap[f],c*b.state.scrollxRatio>=a){d=b.state.columnIndexArr[b.state.columnIndexArr.indexOf(Number(f))-e],null==d&&(d=b.state.columnIndexArr[0]);break}return d},Qb.prototype._setScrollInfo=function(){var a=this;if(0==a.state.renderTargetDataIndexList.length)return a.state.renderFromColumnIndex=0,a.state.translatexX=0,a.state.renderFromRenderedIndex=0,void(a.state.translateY=0);var b=0;if(a.state.scrollxEnd===!0){if(a.state.wrapperWidth>=a.state.columnWidth)a.state.scrollxMoveable=!1,a.state.renderFromColumnIndex=a.state.columnIndexArr[0],b=0;else{a.state.scrollxRatio=a.state.wrapperWidth/a.state.columnWidth;var c=a.state.scrollbarxTrackLength*a.state.scrollxRatio;b=a.state.scrollbarxTrackLength-c,a.state.renderFromColumnIndex=a._getColumnIndex(b)}}else{for(var d=a.state.columnIndexArr.indexOf(a.state.renderFromColumnIndex);0>d&&null!=a.state.prevColumnIndexArr;){if(a.state.renderFromColumnIndex=a.state.prevColumnIndexArr[a.state.prevColumnIndexArr.indexOf(a.state.renderFromColumnIndex)+1],null==a.state.renderFromColumnIndex){a.state.renderFromColumnIndex=a.state.columnIndexArr[0];break}d=a.state.columnIndexArr.indexOf(a.state.renderFromColumnIndex)}b=a._generateTranslatex(a.state.renderFromColumnIndex)*a.state.scrollxRatio}a.state.translateX=b;var e=0;if(a.state.renderFromRenderedIndex-1>a.state.renderTargetDataIndexList.length)a.state.renderFromRenderedIndex=0,a.state.scrollyEnd=!1;else{var f=a.$scrollbary.find(".upbutton"),g=a.state.renderTargetDataIndexList.length*a.state.rowHeight;a.state.scrollyRatio=a.state.scrollbaryTrackLength/g;var h=a.state.scrollbaryTrackLength*a.state.scrollyRatio,i=2*f.height();if(i>h){var j=i-h;h=i,a.state.scrollyRatio=(a.state.scrollbaryTrackLength-j)/g}a.state.scrollbaryHeight=h,e=a.state.scrollyEnd?a.state.scrollbaryTrackLength-a.state.scrollbaryHeight:a.state.renderFromRenderedIndex*a.state.rowHeight*a.state.scrollyRatio}a.state.translateY=e},Qb.prototype._scrollRightEvent=function(a,b){var c=this;null==b&&(b=!0);var d=0,e=0;c.state.scrollxEnd||c.state.wrapperWidth>=c.state.standardColumnWidth||(e=c.state.columnIndexArr[c.state.columnIndexArr.indexOf(c.state.renderFromColumnIndex)+a],d=c._generateTranslatex(e)*c.state.scrollxRatio,d>=c.state.scrollbarxTrackLength-c.state.scrollbarxWidth?(c.state.scrollxEnd=!0,c.state.renderFromColumnIndex=c.state.lastScrollxIndex,d=c.state.scrollbarxTrackLength-c.state.scrollbarxWidth):c.state.renderFromColumnIndex=e,c.state.translateX=d,b&&c._refreshBoard())},Qb.prototype._scrollLeftMostEvent=function(a){return this._scrollLeftEvent(1/0,a)},Qb.prototype._scrollLeftEvent=function(a,b){var c=this;null==b&&(b=!0);var d=0,e=c.state.columnIndexArr[c.state.columnIndexArr.indexOf(c.state.renderFromColumnIndex)-a];null==e||1/0===a?(d=0,c.state.renderFromColumnIndex=c.state.columnIndexArr[0]):(d=c._generateTranslatex(e)*c.state.scrollxRatio,c.state.renderFromColumnIndex=e),c.state.scrollxEnd=!1,c.state.translateX=d,b&&c._refreshBoard()},Qb.prototype._scrollTopEvent=function(a){return this._scrollUpEvent(this.state.renderFromRenderedIndex,a)},Qb.prototype._scrollUpEvent=function(a,b){var c=this;null==b&&(b=!0);var d=c.state.scrollyRatio*c.state.rowHeight*(c.state.renderFromRenderedIndex-a);c.state.renderFromRenderedIndex-=a,c.state.scrollyEnd=!1,c.state.renderFromRenderedIndex<=0?(c.state.renderFromRenderedIndex=0,c.state.translateY=0):c.state.translateY=d,b&&c._refreshBoard()},Qb.prototype._scrollDownEvent=function(a,b){var c=this,d=0;if(null==b&&(b=!0),!c.state.scrollyEnd){var e=c.state.renderTargetDataIndexList.length*c.state.rowHeight,f=c.state.wrapperHeight-c.state.headerRowHeight;f>=e||(d=c.state.scrollyRatio*c.state.rowHeight*(c.state.renderFromRenderedIndex+a),d>=c.state.scrollbaryTrackLength-c.state.scrollbaryHeight?(c.state.scrollyEnd=!0,c.state.renderFromRenderedIndex=c.state.renderTargetDataIndexList.length-c.state.scrollyRenderedItemLength-1,d=c.state.scrollbaryTrackLength-c.state.scrollbaryHeight):c.state.renderFromRenderedIndex+=a,c.state.translateY=d,b&&c._refreshBoard())}},Qb.prototype._activateBoardScrollEvent=function(){function b(a){var b=Math.floor(a/(i.state.scrollyRatio*i.state.rowHeight));return b}function c(a,b){var c=0,d=0;if(-1==a.attr("class").indexOf("leftbutton")){if(i.state.scrollxEnd)return;d=i.state.columnIndexArr[i.state.columnIndexArr.indexOf(i.state.renderFromColumnIndex)+1],c=i._generateTranslatex(d)*i.state.scrollxRatio,c>=i.state.scrollbarxTrackLength-b?(i.state.scrollxEnd=!0,i.state.renderFromColumnIndex=i.state.lastScrollxIndex,c=i.state.scrollbarxTrackLength-b):i.state.renderFromColumnIndex=d,i.state.translateX=c}else i.state.scrollxEnd?c=i.state.scrollbarxTrackLength-(b+i.state.lastScrollxPixcel*i.state.scrollxRatio):(d=i.state.columnIndexArr[i.state.columnIndexArr.indexOf(i.state.renderFromColumnIndex)-1],null==d?(c=0,i.state.renderFromColumnIndex=i.state.columnIndexArr[0]):(c=i._generateTranslatex(d)*i.state.scrollxRatio,i.state.renderFromColumnIndex=d)),i.state.scrollxEnd=!1,i.state.translateX=c;i._refreshBoard()}function d(a,b,c){var d=2,e=0,f=0;if(a-b>0){if(i.state.scrollxEnd)return;f=i.state.columnIndexArr[i.state.columnIndexArr.indexOf(i.state.renderFromColumnIndex)+d],e=i._generateTranslatex(f)*i.state.scrollxRatio,e>=i.state.scrollbarxTrackLength-c?(i.state.scrollxEnd=!0,i.state.renderFromColumnIndex=i.state.lastScrollxIndex,e=i.state.scrollbarxTrackLength-c):i.state.renderFromColumnIndex=f,i.state.translateX=e}else i.state.scrollxEnd?e=i.state.scrollbarxTrackLength-(c+i.state.lastScrollxPixcel*i.state.scrollxRatio):(f=i.state.columnIndexArr[i.state.columnIndexArr.indexOf(i.state.renderFromColumnIndex)-d],null==f?(e=0,i.state.renderFromColumnIndex=i.state.columnIndexArr[0]):(e=i._generateTranslatex(f)*i.state.scrollxRatio,i.state.renderFromColumnIndex=f)),i.state.scrollxEnd=!1,i.state.translateX=e;i._refreshBoard()}function e(a,b){var c=0;if(-1==a.attr("class").indexOf("upbutton")){if(i.state.scrollyEnd)return;c=i.state.scrollyRatio*i.state.rowHeight*(i.state.renderFromRenderedIndex+1),c>=i.state.scrollbaryTrackLength-b?(i.state.scrollyEnd=!0,i.state.renderFromRenderedIndex=i.state.lastScrollyIndex,c=i.state.scrollbaryTrackLength-b):i.state.renderFromRenderedIndex+=1,i.state.translateY=c}else i.state.scrollyEnd?0===i.state.lastScrollyPixel?(i.state.renderFromRenderedIndex-=1,c=i.state.scrollyRatio*i.state.rowHeight*i.state.renderFromRenderedIndex):c=i.state.scrollbaryTrackLength-(b+i.state.lastScrollyPixel*i.state.scrollyRatio):(i.state.renderFromRenderedIndex-=1,c=i.state.scrollyRatio*i.state.rowHeight*i.state.renderFromRenderedIndex),i.state.scrollyEnd=!1,i.state.renderFromRenderedIndex<=0?(i.state.renderFromRenderedIndex=0,i.state.translateY=0):i.state.translateY=c;i._refreshBoard()}function f(a,b,c){var d=i.state.scrollyRenderedItemLength,e=0;if(a-b>0){if(i.state.scrollyEnd)return;e=(i.state.renderFromRenderedIndex+d)*i.state.rowHeight*i.state.scrollyRatio,e>=i.state.scrollbaryTrackLength-c?(i.state.scrollyEnd=!0,i.state.renderFromRenderedIndex=i.state.lastScrollyIndex,e=i.state.scrollbaryTrackLength-c):i.state.renderFromRenderedIndex+=d,i.state.translateY=e}else i.state.scrollyEnd=!1,i.state.renderFromRenderedIndex-=d,e=i.state.renderFromRenderedIndex*i.state.rowHeight*i.state.scrollyRatio,i.state.renderFromRenderedIndex<=0?(i.state.renderFromRenderedIndex=0,i.state.translateY=0):i.state.translateY=e;i._refreshBoard()}function g(a,b){var c=Math.ceil(Math.abs(a)/100),d=0,e=0;if(a>=0){if(i.state.scrollxEnd)return;e=i.state.columnIndexArr[i.state.columnIndexArr.indexOf(i.state.renderFromColumnIndex)+c],d=i._generateTranslatex(e)*i.state.scrollxRatio,d>=i.state.scrollbarxTrackLength-b?(i.state.scrollxEnd=!0,i.state.renderFromColumnIndex=i.state.lastScrollxIndex,d=i.state.scrollbarxTrackLength-b):i.state.renderFromColumnIndex=e,i.state.translateX=d}else i.state.scrollxEnd?d=i.state.scrollbarxTrackLength-(b+i.state.lastScrollxPixcel*i.state.scrollxRatio):(e=i.state.columnIndexArr[i.state.columnIndexArr.indexOf(i.state.renderFromColumnIndex)-c],null==e?(d=0,i.state.renderFromColumnIndex=i.state.columnIndexArr[0]):(d=i._generateTranslatex(e)*i.state.scrollxRatio,i.state.renderFromColumnIndex=e)),i.state.scrollxEnd=!1,i.state.translateX=d;return!0}function h(a,b){var c=Math.ceil(Math.abs(a)/100);if(a>=0){if(i.state.scrollyEnd)return;translateY=(i.state.renderFromRenderedIndex+c)*i.state.rowHeight*i.state.scrollyRatio,translateY>=i.state.scrollbaryTrackLength-b?(i.state.scrollyEnd=!0,i.state.renderFromRenderedIndex=i.state.renderTargetDataIndexList.length-i.state.scrollyRenderedItemLength-1,translateY=i.state.scrollbaryTrackLength-b):i.state.renderFromRenderedIndex+=c,i.state.translateY=translateY}else translateY=(i.state.renderFromRenderedIndex-c)*i.state.rowHeight*i.state.scrollyRatio,i.state.renderFromRenderedIndex-=c,i.state.scrollyEnd=!1,i.state.renderFromRenderedIndex<=0?(i.state.renderFromRenderedIndex=0,i.state.translateY=0):i.state.translateY=translateY;return!0}var i=this,j=".alopexgridScrollbarEvent";a(document).off(j+i.key),i.$scrollbarx.off(j),i.$scrollbary.off(j),i.$wrapper.off(j);var k=(i.state.renderTargetDataIndexList.length,i.$scrollbarx.find(".scrollhandle")),l=i.$scrollbary.find(".scrollhandle");i.$wrapper.on("wheel"+j,{self:i},function(a){a.preventDefault();var b=a.data.self;if(a.originalEvent){var c,d,e=a.originalEvent.deltaX,f=a.originalEvent.deltaY;0!==e&&b.state.scrollxMoveable&&(c=g(e,b.state.scrollbarxWidth)),0!==f&&b.state.scrollyMoveable&&(d=h(f,b.state.scrollbaryHeight)),(null!=c||null!=d)&&b._refreshBoard()}}),i.$scrollbarx.on("mousedown"+j,{self:i},function(b){var c=b.data.self;if(c.state.scrollxMoveable&&b.target===this){a(document).off(j+c.key);var e=c.state.scrollbarxWidth,f=b.pageX,g=k.offset().left+e;d(f,g,e);var h=null,i=null;h=setTimeout(function(){i=setInterval(function(){g=k.offset().left+e,f>g&&g-f>0&&e>=g-f||g>f&&g-f>0&&e>=g-f||d(f,g,c.state.scrollbarxWidth)},50),h=null},200),a(document).on("mouseup"+j+c.key,{self:c},function(b){h&&clearTimeout(h),i&&clearInterval(i),a(document).off(j+b.data.self.key)})}}),i.$scrollbarx.on("mousedown"+j,".scrollhandle",{self:i},function(b){var c=b.data.self;if(c.state.scrollxMoveable){b.preventDefault(),a(document).off(j+c.key);var d=b.pageX,e=c.$scrollbarx.find(".leftbutton"),f=e.offset().left+e.width(),g=k.offset().left-f,h=d-f;c._refreshTimerActivate(!0),a(document).on("mousemove"+j+c.key,{self:c,scrollxHandlePosition:g,scrollbarxStartPosition:f,startPositionDff:h},function(a){a.preventDefault();var b=a.data.self,c=k.width(),d=a.data.scrollxHandlePosition,e=a.data.scrollbarxStartPosition,f=a.data.startPositionDff;b.state.scrollxEnd=!1;var g=a.pageX-f-e+d;return 0>=g?(b.state.renderFromColumnIndex=b.state.columnIndexArr[0],void(b.state.translateX=0)):g+c>=b.state.scrollbarxTrackLength?(b.state.scrollxEnd=!0,b.state.renderFromColumnIndex=b.state.lastScrollxIndex,void(b.state.translateX=b.state.scrollbarxTrackLength-c)):(b.state.renderFromColumnIndex=b._getColumnIndex(g),void(b.state.translateX=g))}).on("mouseup"+j+c.key,{self:c},function(b){b.data.self._refreshTimerActivate(!1),a(document).off(j+b.data.self.key)})}}),i.$scrollbarx.on("mousedown"+j,".scrollbutton",{self:i},function(b){var d=b.data.self;if(d.state.scrollxMoveable){a(document).off(j+d.key);var e=a(b.target);c(e,d.state.scrollbarxWidth);var f=null,g=null;f=setTimeout(function(){g=setInterval(function(){c(e,d.state.scrollbarxWidth)},50),f=null},200),a(document).on("mouseup"+j+d.key,{self:d},function(b){f&&clearTimeout(f),g&&clearInterval(g),a(document).off(j+b.data.self.key)})}}),i.$scrollbary.on("mousedown"+j,{self:i},function(b){var c=b.data.self;if(c.state.scrollyMoveable&&b.target===this){a(document).off(j+c.key);var d=c.state.scrollbaryHeight,e=b.pageY,g=l.offset().top+d;f(e,g,d);var h=null,i=null;h=setTimeout(function(){i=setInterval(function(){g=l.offset().top+d,e>g&&g-e>0&&d>=g-e||g>e&&g-e>0&&d>=g-e||f(e,g,d)},50),scrollbarxTimer=null},200),a(document).on("mouseup"+j+c.key,{self:c},function(b){h&&clearTimeout(h),i&&clearInterval(i),a(document).off(j+b.data.key)})}}),i.$scrollbary.on("mousedown."+j,".scrollhandle",{self:i},function(c){var d=c.data.self;if(d.state.scrollyMoveable){c.preventDefault(),a(document).off("."+j+d.key);var e=c.pageY,f=d.$scrollbary.find(".upbutton"),g=f.offset().top+f.height(),h=l.offset().top-g,i=e-g;d._refreshTimerActivate(!0),a(document).on("mousemove."+j+d.key,{self:d,scrollyHandlePosition:h,scrollbaryStartPosition:g,startPositionDff:i},function(a){a.preventDefault();var c=a.data.self,d=l.height(),e=a.data.scrollyHandlePosition,f=a.data.scrollbaryStartPosition,g=a.data.startPositionDff;c.state.scrollyEnd=!1;var h=a.pageY-g-f+e;0>=h?(c.state.renderFromRenderedIndex=0,c.state.translateY=0):h+d>=c.state.scrollbaryTrackLength?(c.state.scrollyEnd=!0,c.state.renderFromRenderedIndex=c.state.lastScrollyIndex,c.state.translateY=c.state.scrollbaryTrackLength-d):(c.state.renderFromRenderedIndex=b(h),c.state.translateY=h)}).on("mouseup."+j+d.key,{self:d},function(b){b.data.self._refreshTimerActivate(!1),a(document).off("."+j+b.data.self.key)})}}),i.$scrollbary.on("mousedown"+j,".scrollbutton",{self:i},function(b){var c=b.data.self;if(c.state.scrollyMoveable&&b.target===this){var d=a(b.target);a(document).off(j+c.key),e(d,c.state.scrollbaryHeight);var f=null,g=null;f=setTimeout(function(){g=setInterval(function(){e(d,c.state.scrollbaryHeight)},50),f=null},200),a(document).on("mouseup"+j+c.key,{self:c},function(b){f&&clearTimeout(f),g&&clearInterval(g),a(document).off(j+b.data.self.key)})}})},Qb.prototype._refreshScrollbar=function(){var a=this,b=a.$scrollbarx.find(".scrollhandle"),c=a.$scrollbary.find(".leftbutton");if(a.state.scrollxMoveable=!0,a.state.wrapperWidth>=a.state.columnWidth)b.width(a.state.scrollbarxTrackLength),a.state.scrollbarxWidth=b.width(),a.state.scrollxMoveable=!1,a.state.translateX=0,a.state.renderFromColumnIndex=a.state.columnIndexArr[0];else{a.state.scrollxRatio=a.state.wrapperWidth/a.state.columnWidth;var d,e=a.state.columnWidth-a.state.wrapperWidth,f=0;for(var g in a.state.standardColumnWidthMap)if(d=a.state.standardColumnWidthMap[g],f+=d,f>e){f-=d,a.state.lastScrollxIndex=a.state.columnIndexArr[a.state.columnIndexArr.indexOf(Number(g))-a.state.fixedColumnMapping.length],a.state.lastScrollxPixcel=e-f;break}var d=a.state.scrollbarxTrackLength*a.state.scrollxRatio,h=2*c.width();if(h>d){var i=h-d;d=h,a.state.scrollxRatio=(a.state.wrapperWidth-i)/a.state.columnWidth}b.width(d),a.state.scrollbarxWidth=d}b.css("transform","translateX("+a.state.translateX+"px)");var j=a.state.renderTargetDataIndexList.length*a.state.rowHeight,k=a.$scrollbary.find(".scrollhandle"),l=a.$scrollbary.find(".upbutton"),m=a.state.wrapperHeight-a.state.headerRowHeight;if(a.option.header||(m=a.state.wrapperHeight),a.state.scrollyMoveable=!0,m>=j)k.height(a.state.scrollbaryTrackLength),a.state.scrollyMoveable=!1,a.state.translateY=0,a.state.scrollyRenderedItemLength=a.state.scrollyRenderedItemMaxLength=a.state.renderTargetDataIndexList.length;else{a.state.scrollyRenderedItemLength=Math.floor(m/a.state.rowHeight),a.state.scrollyRenderedItemMaxLength=Math.ceil(m/a.state.rowHeight);var n=a.state.scrollyRenderedItemLength*a.state.rowHeight;m>n?(a.state.lastScrollyPixel=m-n,a.state.lastScrollyIndex=a.state.renderTargetDataIndexList.length-a.state.scrollyRenderedItemLength-1):(a.state.lastScrollyPixel=0,a.state.lastScrollyIndex=a.state.renderTargetDataIndexList.length-a.state.scrollyRenderedItemLength),a.state.scrollyRatio=a.state.scrollbaryTrackLength/j;var o=a.state.scrollbaryTrackLength*a.state.scrollyRatio,p=2*l.height();if(p>o){var q=p-o;o=p,a.state.scrollyRatio=(a.state.scrollbaryTrackLength-q)/j}k.height(o),a.state.scrollbaryHeight=o}k.css("transform","translateY("+a.state.translateY+"px)")},Qb.prototype._refreshBoard=function(a){var b=this;b.state.renderingSuppressed||(a===!0||b.state.prevRenderFromRenderedIndex!==b.state.renderFromRenderedIndex||b.state.prevRenderFromColumnIndex!==b.state.renderFromColumnIndex||b.state.prevWrapperWidth!==b.state.wrapperWidth||b.state.prevWrapperHeight!==b.state.wrapperHeight||b.state.prevScrollxEnd!==b.state.scrollxEnd||b.state.prevScrollyEnd!==b.state.scrollyEnd||b.state.prevTranslateX!==b.state.translateX||b.state.prevTranslateY!==b.state.translateY||b.state.prevColumnIndexArr!==b.state.columnIndexArr)&&(b.state.prevRenderFromRenderedIndex=b.state.renderFromRenderedIndex,b.state.prevRenderFromColumnIndex=b.state.renderFromColumnIndex,b.state.prevWrapperWidth=b.state.wrapperWidth,b.state.prevWrapperHeight=b.state.wrapperHeight,b.state.prevScrollxEnd=b.state.scrollxEnd,b.state.prevScrollyEnd=b.state.scrollyEnd,b.state.prevTranslateX=b.state.translateX,b.state.prevTranslateY=b.state.translateY,b.state.prevColumnIndexArr=b.state.columnIndexArr,b._refreshPagingUnit(a),b._refreshHeaderCells(a),b._refreshBodyCells(a),b._refreshScrollbar(a))},Qb.prototype.calcAndRedraw=function(){var a=this;a.state.renderingSuppressed||(a._sortInternalData(),a._generateRenderTarget(),a.viewUpdate())},Qb.prototype.filterAndRedraw=function(){var a=this;a.state.renderingSuppressed||(a._generateRenderTarget(),a.viewUpdate())},Qb.prototype.redraw=function(){var a=this;a.state.renderingSuppressed||a.viewUpdate()},Qb.prototype._getFilteredDataList=function(b,c){for(var d=this,e=[],f=b.length,g=!1,h=0,i=c.length;i>h;h++){var j=c[h];g=!1;for(var k=0;f>k;k++){var l=b[k];a.isPlainObject(l)&&(l=d._filterDataToFunction(l)),a.isFunction(l)&&l(j)!==!0&&(g=!0)}g||e.push(j)}return e},Qb.prototype._generateRenderTarget=function(){var b=this,c=b.state.data,d=[],e=[],f=[],g=[],h={enabled:null,current:null,total:null,dataLength:null,pageDataLength:null,perPage:null,pagerCount:null},i=b.option.paging||{},j=i.customPaging,k=h.enabled=!!b.option.pager;h.pagerCount=i.pagerCount||10,h.current=(j?j.current:i.current)||1,h.perPage=j?j.perPage:i.perPage;var l=a.isPlainObject(b.state.filter);b.state.filterApplied=!1;for(var m=b.state.folded&&b.state.folded.length,n=0,o=c.length;o>n;n++){var p=c[n];if(delete p._index.row,delete p._index.rendered,l){var q=!1;if(a.each(b.state.filter,function(c,d){return a.isPlainObject(d)&&(d=b._filterDataToFunction(d)),a.isFunction(d)&&d(p)!==!0?(q=!0,!1):void 0}),q){b.state.filterApplied=!0;continue}}if(m){var r=b.option.grouping.by;r=a.isArray(r)?r:[r];for(var s=r.length,t=!0,u=0;s>u;u++){var v=b._isDataFolded(p,u);if(v===!0){t=!1;break}if("unfold"===v||"unfold-line"===v){t=!0;break}}if(!t)continue}d.push(n),e.push(p)}h.total=j?j.total:d.length?Math.floor(d.length/h.perPage)+(d.length%h.perPage?1:0):0;var w=null,x=null;k&&(w=(h.current-1)*h.perPage,x=h.current*h.perPage-1);for(var y=0,z=0,A=e.length;A>z;z++)if(!k||j||!(w>z||z>x)){var p=e[z];p._index.row=p._index.rendered=y++,f.push(d[z]),g.push(p)}h.dataLength=j?j.dataLength:d.length,h.pageDataLength=f.length,l?(b.state.filteredDataIndexList=d,b.state.filteredDataList=e):(delete b.state.filteredDataIndexList,delete b.state.filteredDataList),b.state.renderTargetDataIndexList=f,b.state.renderTargetDataList=g,b.state.pagingInfo=h},Qb.prototype._rowResizeStart=function(b,c){if(b&&b.type){var d=this;if(!d.state.rowResizing&&(b=a.event.fix(b),1===b.which)){d.state.$rowResizeBar&&(d.state.$rowResizeBar.remove(),d.state.$rowResizeBar=null),d.state.rowHeightMapByDataId=d.state.rowHeightMapByDataId||{};var e=a(b.target),f=e.closest(".bodycell"),g=f.attr("data-alopexgrid-dataid");if("dblclick"!==b.type){var h=b.pageY,i=f.offset().top-d.$wrapper.offset().top+f.height(),j=a('<div class="resize-align">');j.css({position:"absolute",top:"0px","z-index":"99998",transform:"translateY("+i+"px)",left:"0px",border:"1px dotted black",width:Math.round(1.5*d.$wrapper.prop("clientWidth"))+"px"});var k=j.clone();k.css("border","1px dashed #afafaf").appendTo(d.$wrapper),j.appendTo(d.$wrapper),d.state.$rowResizeBar=j,a(document.body).on("mousemove.alopexgridRowResize."+d.key+d.eventns,{self:d,$bar:j,startPageY:h,startTop:i},function(a){j.css("transform","translateY("+(a.data.startTop+(a.pageY-a.data.startPageY))+"px)")}).on("mouseup.alopexgridRowResize."+d.key+d.eventns,{self:d,$bar:j,$pos:k,startPageY:h,startTop:i,renderedIndex:c,dataId:g,$cell:f},function(b){a(document.body).off(".alopexgridRowResize"),b.data.$bar.remove(),b.data.$pos.remove();var c=parseInt(b.data.$cell.css("height")),d=b.pageY-b.data.startPageY;b.data.self.state.rowHeightMapByDataId[b.data.dataId]=Math.max(3,c+d),b.data.self._refreshBoard(!0)})}}}},Qb.prototype._columnResizeStart=function(b,c){if(b.preventDefault(),b&&b.type){var d=this,e=a(b.target),f=a(b.target).closest(".headercell"),g=f[0],h=a('<div class="resize-align">')[0],i=parseInt(g.style.left)+parseInt(g.style.width)+"px",j=(b.target.offsetWidth,{self:this,bar:h,prevX:0,totalMoveAmount:0,columnIndex:c});e.siblings(".resizing-handle").length>0&&(i=f.position().left+e.position().left+e.width()+"px"),h.style.top="0px",h.style.left=i,h.style.height=parseInt(1.5*d.state.wrapperHeight)+"px",d.$wrapper[0].appendChild(h),d.state.resizing=!0,j.prevX=parseInt(b.pageX),a(document).on("mousemove.alopexgridresizeevent"+d.eventns+d.key,j,t).on("mouseup.alopexgridresizeevent"+d.eventns+d.key,j,u)}},Qb.prototype.sortToggle=function(a,b){if("string"==typeof a)for(var c=0,d=this.option.columnMapping.length;d>c;c++){var e=this.option.columnMapping[c];if(e&&void 0!==e.columnIndex&&null!==e.columnIndex&&"string"==typeof e.key&&e.key===a){a=Number(e.columnIndex);break}}return this._sortToggle(a,b,!1)},Qb.prototype.dataSort=function(b,c,d){var e=this;if(c||(c="asc"),a.isArray(b)){b=a.extend(!0,[],b);var f=b.shift();d=b,b=e.state.columnKeyToIndexMap[f.sortingKey],g(b)||(b=f.sortingColumn),c=f.sortingDirection||"asc",d.length||(d=void 0)}return a.isArray(d)?(d=a.extend(!0,[],d),e.state.sortingColumn=b,e.state.sortingKey=e.state.columnIndexToKeyMap[b],e.state.sortingDirection=c||"asc",e._processSortingMulti(d),void e.calcAndRedraw()):(delete e.state.sortingMulti,e.sortToggle(b,c))},Qb.prototype._sortToggle=function(b,c,d){function e(){h=Number(h),g.state.hasOwnProperty("sortingColumn")&&void 0!==g.state.sortingColumn&&null!==g.state.sortingColumn&&Number(g.state.sortingColumn)!==Number(h)&&delete g.state.sortingDirection,g.state.sortingMulti&&delete g.state.sortingDirection,g.state.sortingDirection="desc"===c||!c&&"asc"===g.state.sortingDirection?"desc":"asc"===c||!c&&"desc"===g.state.sortingDirection?"asc":"asc",g.state.sortingColumn=Number(h)}var g=this,h=b;if(!g.state.disableSort){if(d){d=a.event.fix(d);var i=a(d.target);if(a(d.target).hasClass("resizing-handle"))return;if(void 0===h||null===h){var j=i.hasClass("headercell")?i:i.parentsUntil(g.$wrapper,".cell").eq(0);h=j.attr("data-alopexgrid-columnindex")}if(f(),("click"===d.type||d.type.indexOf("mouse")>=0)&&1!==d.which)return}if(void 0!==h&&null!==h){if(d&&d.shiftKey){g.state.sortingMulti=g.state.sortingMulti||[];var k=g.state.sortingColumn===h?h:a.grep(g.state.sortingMulti,function(a){return a.sortingColumn===h||g.state.columnKeyToIndexMap[a.sortingKey]===h?!0:void 0});"number"===a.type(k)?g.state.sortingDirection="desc"===g.state.sortingDirection?"asc":"desc":k.length?k[0].sortingDirection="desc"===k[0].sortingDirection?"asc":"desc":g.state.sortingMulti.push({sortingColumn:h,sortingDirection:"asc"})}else e(),delete g.state.sortingMulti;g._showProgress(function(){var a=null,b={},c=A(g,g.state.sortingColumn);b.key=c.key,b.column=c.columnIndex,b.direction=g.state.sortingDirection,b.mapping=c,b.paging=g.pageInfo(),a=g._triggerGridEvent("sortToggle",b),a!==!1&&(g._scrollerReset(),g.calcAndRedraw())},10)}}};var Rb=-100,Sb=-100;Qb.prototype._hoverEnter=function(a,b){if(!Qb.dragObject){var c=b.clientY;Rb!==c&&(Rb=c)}},Qb.prototype._hoverLeave=function(b,c){if(!Qb.dragObject){var d=c.clientY;if(Sb!==d){Sb=d;var e=a(b);!e.hasClass("hovering")}}},Qb.prototype.cellElementGet=function(a,b){return this._elementGet(a,b)},Qb.prototype.rowElementGet=function(a){return this._elementGet(a,null)},Qb.prototype._elementGet=function(b,c){var d=this,e=a();if(d.state.refreshbodycell){var f=d.dataGet(b),g=[];for(var h in f)g.push("."+f[h]._index.id);e=d.$wrapper.find(g.join(",")),"number"==typeof c&&c>=0?e=e.filter(function(a,b){return b.getAttribute("data-alopexgrid-columnindex")===String(c)}):"string"==typeof c&&(e=e.filter(function(a,b){return b.getAttribute("data-alopexgrid-key")===String(c)}))}return e},Qb.prototype.refreshRow=function(a){var b=this,c=b.dataGet(a),d=[];if(c&&c.length){for(var e=0,f=c.length;f>e;e++){var g=c[e];g&&d.push(g._index.data)}b._refreshBodyCells({dataIndexList:d})}},Qb.prototype.refreshCell=function(a,b){var c=this,d=c.dataGet(a),e=[];if(d&&d.length){for(var f=0,g=d.length;g>f;f++){var h=d[f];h&&e.push(h._index.data)}var i="number"==typeof b?b:S(c.option.columnMapping,b);c._refreshBodyCells({dataIndexList:e,columnIndexList:[i]})}},Qb.prototype._setCursorUnderPointer=function(a,b,c){try{var d=a.find("input,select,textarea").eq(0);if(d.length)if("SELECT"===d.prop("tagName"))d.focus();else{var e=null,f=0,g=-1,h=-1;do{if(e=w(d[0],f),e.top<=c&&c<=e.bottom&&e.left>b){Math.abs(g-1-b)<=Math.abs(e.left-1-b)&&(f-=1);break}if(g===e.left&&h===e.top)break;g=e.left,h=e.top,f++}while(e);x(d[0],f)}}catch(i){a.find("input,select,textarea").eq(0).focus()}},Qb.prototype._cellEditUpdate=function(b,c,d){var e=this,f=null,h=null,i=null;for(a.isPlainObject(c)&&c._index.id&&(h=c,c=h._index.id,i=h._index.data);!b.attributes["data-alopexgrid-columnindex"];)if(b=b.parentNode,!b)return;if(g(c)&&(h||(h=e.state.data[e.state.dataIdToIndexMap[c]],i=h._index.data),h)){if(void 0===d||null===d||"number"==typeof d){var j="number"==typeof d?d:b.attributes["data-alopexgrid-columnindex"].value;if(void 0===j||null===j)return;j=Number(j),f=A(e,j)}else"object"==typeof d&&d.hasOwnProperty("columnIndex")?f=d:"string"==typeof d&&(f=v(e.option.columnMapping,{key:d},e,h));if(f&&f.editable){if(a.isFunction(f.allowEdit)){var k=e._evaluateAllowEdit(h,f);if(k===!1)return}var l=o.call(e,f,a(b),h),m=[];if(e._isEditingCell(h._index.rendered,f.columnIndex))e.state.editingCellInfo.value=l;else{h._state.recent=h._state.recent||{};var n=h._state.recent.hasOwnProperty(f.key)?h._state.recent[f.key]:h[f.key],p=a.extend(!0,{},h,Qb.trimData(h._state.recent)),q=h._state.recent[f.key]=l,r=a.extend(!0,{},h,Qb.trimData(h._state.recent));if(n!==q){e.option.mergeEditingImmediately&&(h._state._beforeEditing||(h._state._beforeEditing=Qb.trimObject(h)),h._state.edited||(h._original=Qb.trimObject(h),e.rowElementGet(h).addClass("edited"),h._state._beforeEditing._state={edited:!1}),h[f.key]=q,e.option.fullCompareForEditedState?(h._state.edited=!1,h._original&&a.each(h._original,function(a,b){return b!==h[a]?(h._state.edited=!0,!1):void 0})):h._state.edited=!0);for(var s=0;s<e.option.columnMapping.length;s++){var t=e.option.columnMapping[s];if(g(t.columnIndex)&&a.isPlainObject(t)&&Number(t.columnIndex)!==Number(f.columnIndex)&&t.hasOwnProperty("refreshBy")){var u=!1,w=t.refreshBy;if(w===!0)u=!0;else if("string"==typeof w&&w===f.key)u=!0;else if(a.isArray(w)&&(a.inArray(f.key,w)>=0||a.inArray(Number(f.columnIndex),w)>=0))u=!0;else if(a.isFunction(w)){var x={};x.prevData=p,x.newData=r,x._key=t.key,x._column=t.columnIndex,x._index=a.extend({},h._index),x.mapping=t,x.done=function(){var b=e.refreshCell({_index:{data:this._index.data}},this._column);a.isFunction(this._done)?this._done():null,b?b.find("input,select,textarea").trigger("change"):null,this.complete=!0};var y=w.call(x,p,r,t,function(a){return function(){a.done()}}(x));y===!0?u=!0:"async"===y&&!function(a){a.complete||e._showProgress(function(b){a._done=b},0,!0)}(x)}if(u){var z=e.refreshCell({_index:{data:i}},t.columnIndex);m.push(t.columnIndex),z?z.find("input,select,textarea").trigger("change"):null}}}}if(e.state.columnRowspanned&&e.option.rowspanGroupEdit&&e.state.rowspanindex[Number(f.columnIndex)]){var B=K(e.state.rowspanindex[Number(f.columnIndex)],i,!0);if(B)for(var C=B.from;C<B.to;C++)e.state.data[C]._state.editing&&(e.state.data[C]._state.recent=e.state.data[C]._state.recent||{},e.state.data[C]._state.recent[f.key]=q,f.rowspan&&m.length&&C!==i&&a.inArray(C,m)>=0&&e.refreshRow({_index:{data:C}}))}if(e.state.groupRowspanned&&e.option.rowspanGroupEdit&&f.rowspan){var D=e._getGroupingRangeByMapping(i,f);if(D)for(var C=D.from;C<=D.to;C++)e.state.data[C]._state.editing&&(e.state.data[C]._state.recent=e.state.data[C]._state.recent||{},e.state.data[C]._state.recent[f.key]=q,e.option.mergeEditingImmediately&&(e.state.data[C]._state._beforeEditing||(e.state.data[C]._state._beforeEditing=Qb.trimObject(e.state.data[C])),e.state.data[C]._state.edited||(e.state.data[C]._original=Qb.trimObject(e.state.data[C]),e.rowElementGet(e.state.data[C]).addClass("edited"),e.state.data[C]._state._beforeEditing._state={edited:!1}),e.state.data[C][f.key]=q,e.state.data[C]._state.edited=!0))}}}}},Qb.prototype._evaluateAllowEdit=function(b,c){var d=this,e=c.allowEdit!==!1;if(a.isFunction(c.allowEdit)){var f=b;d.option.evaluateAllowEditWithMergedData&&b._state.editing&&(f=a.extend({},f,b._state.recent)),e=c.allowEdit(f[c.key],f,c)}return e},Qb.prototype._triggerGridEvent=function(a,b){var c=null;try{c=new Event(a,{bubbles:!0,cancelable:!0})}catch(d){c=document.createEvent("Event"),c.initEvent(a,!0,!0)}if(b&&"object"==typeof b){c.alopexgrid={};for(var e in b)b.hasOwnProperty(e)&&(c.alopexgrid[e]=b[e])}return this.$root[0].dispatchEvent(c)},Qb.prototype.viewEventUpdate=function(){function b(b){var c=b.data.self,d=parseInt(b.currentTarget.getAttribute("data-alopexgrid-dataindex")),e=parseInt(b.currentTarget.getAttribute("data-alopexgrid-columnindex")),f=A(c,e),g=a.extend(!0,{},c.option.getEditingDataOnEvent?c._getRecentData(d):c.state.data[d]);return f&&f.key&&(g._key=f.key),!isNaN(e)&&e>=0&&(g._index.column=e),g}function c(a){var c=a.data.self,d=b(a),e=a.data.handle,f="function"==typeof e?[e]:e;for(var g in f){var h=f[g];h.call(c,d,a)}}function e(a){return Kb?a.originalEvent.touches[0].pageX:a.pageX}function h(a){return Kb?a.originalEvent.touches[0].pageY:a.pageY}function i(a,b,c,d){return(a-c)*(a-c)+(b-d)*(b-d)}function j(a){return i(a.x,a.y,a.x2,a.y2)}var k=this,l=k.$root,m=k.$wrapper,n=k.option,o=".alopexgridViewEventUpdate",p=a(document).off(o+k.key),q=a(window).off(o+k.key);l.off(o),k.$title.off(o),k.$pager.off(o),m.off(o),k.$focusfixture.off(o),k.$pager.off(o);var r=[{target:"cell",delegate:".bodycell"},{target:"headercell",delegate:".headercell"}];if(a.each(r,function(b,d){n.on&&n.on[d.target]&&a.each(n.on[d.target],function(a,b){m.on((k.option.eventMapping[a]||a)+o,d.delegate,{self:k,handle:b},c)
})}),k.option.on&&k.option.on.focus&&"object"==typeof k.option.on.focus)for(var s in k.option.on.focus)"string"==typeof s&&k.$focusfixture.on(s+o,{self:k,handle:k.option.on.focus[s]},c);if(Mb){var t=Kb?"touchstart":"mousedown",u=Kb?"touchmove":"mousemove",v=Kb?"touchend":"mouseup",w=Kb?"touchcancel":"mouseup",x=".gridtapworkaround";l.off(x).on(t+x,function(b){k.state._tap={target:b.target,x:e(b),y:h(b),x2:e(b),y2:h(b),timestamp:(new Date).getTime()},a(window).off(x).on(u+x+k.eventns,function(a){k.state._tap&&(k.state._tap.x2=e(a),k.state._tap.y2=h(a))}).on(v+x+k.eventns,function(b){k.state._tap&&k.state._tap.target===b.target&&j(k.state._tap)<25&&(new Date).getTime()-k.state._tap.timestamp<750&&a(b.target).parents().add(b.target).filter("[data-gridtap]").each(function(){var c=a(this).attr("data-gridtap");if(c){var d=new Function("event",c);d.call(this,b)}}),k.state._tap=null,a(window).off(x)}).on(w+x+k.eventns,function(){k.state._tap=null,a(window).off(x)})})}if(a(document).off(".alopexgrideventinineedit"+k.key),n.rowInlineEdit){var z="string"==a.type(n.rowInlineEdit)?n.rowInlineEdit:"dblclick";Mb&&(z="doubletap"),m.on("dblclick"+o,".bodycell",{self:k},function(b){if("INPUT"!==b.target.tagName){var c=a(this),d=b.data.self,e=c.attr("data-alopexgrid-dataindex"),f=c.attr("data-alopexgrid-columnindex");if(g(e)&&g(f)){e=parseInt(e),f=parseInt(f);var h=b.pageX,i=b.pageY,j=d.state.data[e];if(j._state.editing)d.endEdit({_index:{data:e}});else{d.endEdit(),d.startEdit({_index:{data:e}});var k=d.cellElementGet({_index:{data:j._index.data}},f);d._setCursorUnderPointer(k,h,i)}}}}),m.on("click"+o,".cell",{self:k},function(b){var c=a(this),d=b.data.self,e=parseInt(c.attr("data-alopexgrid-dataindex")),f=d.state.data[e];if(!f||!f._state.editing){var g=!1;a.each(d.state.data,function(a,b){return b&&b._state.editing?(g=!0,!1):void 0}),g&&d.endEdit()}}),n.endInlineEditByOuterClick&&a(document).on("click"+o+k.key,{self:k},function(b){var c=b.data.self,d=a(b.target),e=d.add(d.parents());e.filter(".alopexgrid")[0]!==c.$root[0]&&(e.filter("input,select,button,textarea,a").length||c._endEditAllIfEditingExist())})}n.rowClickSelect?m.on("click"+o,".bodycell",{self:k},function(a){a.data.self.rowSelect(this,"toggle",a)}):m.on("click"+o,".selector-checkbox",{self:k},function(b){var c=a(this).closest(".bodycell"),d=b.data.self;setTimeout(function(){d.rowSelect(c[0],"toggle",b)},0)}),k.option.disableFocusedState!==!0&&m.on("mousedown"+o,".bodycell",{self:k},function(a){a.data.self._rowFocus(this)}),k.option.cellPopupEdit&&m.on("dblclick"+o,".bodycell",{self:k,$popupWrap:null},function(b){function c(b){var c=b.data.self,d=b.target;if(c.state.activePopupTextarea.length>0){var e=c.state.activePopupTextarea[0];0==a(d).closest(e).length&&(c.state.activePopupTextarea=[],a(document.body).off(".alopexgridCellPopupEdit"+c.key),b.data.$popupWrap&&(b.data.$popupWrap.remove(),b.data.$popupWrap=null))}else c.state.activePopupTextarea.push(n)}var d=b.data.self,e=a(this);if(!e.hasClass("editingcell")){var f=parseInt(e.attr("data-alopexgrid-renderedindex")),g=parseInt(e.attr("data-alopexgrid-columnindex"));if(-1!==a.inArray(g,d.option.cellPopupEdit)){void 0==d.state.activePopupTextarea?d.state.activePopupTextarea=[]:d.state.activePopupTextarea.length>0&&(d.state.activePopupTextarea=[],a(document.body).off(".alopexgridCellPopupEdit"+d.key),b.data.$popupWrap&&(b.data.$popupWrap.remove(),b.data.$popupWrap=null));var h=d._getRenderedDataFromRenderedIndex(f),i=A(d,g),j=$(d,h,i);$target=a(b.target);var k=$target.offset(),l=k.top+b.offsetY,m=k.left+b.offsetX+10;b.data.$popupWrap&&(b.data.$popupWrap.remove(),b.data.$popupWrap=null);var n=a('<div tabIndex="0" class="alopexgrid-popupwrap" style="top:'+l+"px;left:"+m+'px;">');b.data.$popupWrap=n,n.on("keydown.alopexgridCellPopupEdit",{self:d,$popupWrap:n},function(b){var c=b.data.self;27===b.which&&(c.state.activePopupTextarea=[],a(document.body).off(".alopexgridCellPopupEdit"+c.key),b.data.$popupWrap&&(b.data.$popupWrap.remove(),b.data.$popupWrap=null))});var o=null;j||(o=a('<button class="alopexgrid-popupbutton">저장</button>'),o.on("click.alopexgridCellPopupEdit",{self:d,$popupWrap:n},function(b){var c=b.data.self;c._endCellEdit({renderedIndex:f,columnIndex:g,value:q.val()}),c.state.activePopupTextarea=[],a(document.body).off(".alopexgridCellPopupEdit"+c.key),b.data.$popupWrap&&(b.data.$popupWrap.remove(),b.data.$popupWrap=null)}));var p=a('<button class="alopexgrid-popupbutton">닫기</button>');p.on("click.alopexgridCellPopupEdit",{self:d,$popupWrap:n},function(b){var c=b.data.self;c.state.activePopupTextarea=[],a(document.body).off(".alopexgridCellPopupEdit"+c.key),b.data.$popupWrap&&(b.data.$popupWrap.remove(),b.data.$popupWrap=null)});var q=a('<textarea class="alopexgrid-popuptextarea">'+$target.text()+"</textarea>");j&&q.attr("readonly",""),n.append(a("<div>").append(p,o),q),a(document.body).append(n),a(document.body).on("click.alopexgridCellPopupEdit"+d.key,{self:d,$popupWrap:n},c),setTimeout(function(){n.focus()},0)}}}),k.option.cellInlineEdit&&(m.on("dblclick"+o,".bodycell",{self:k},function(b){var c=b.data.self,d=a(this),e=b.pageX,g=b.pageY;if(!d.hasClass("editingcell")){var h=parseInt(d.attr("data-alopexgrid-renderedindex")),i=parseInt(d.attr("data-alopexgrid-columnindex"));c._endCellEdit(),c._startCellEdit(h,i),f(),setTimeout(function(){var a=tb(c,h,i);c._setCursorUnderPointer(a,e,g)},0)}}),m.on("mousedown"+o,".bodycell",{self:k},function(b){var c=b.data.self,d=a(this);if(!d.hasClass("editingcell")){var e=parseInt(d.attr("data-alopexgrid-renderedindex")),f=parseInt(d.attr("data-alopexgrid-columnindex"));c._endCellEdit(),ub(c,e,f)}}),m.on("keydown"+o,".bodycell",{self:k},function(b){var c=b.data.self,d=a(this),e=parseInt(d.attr("data-alopexgrid-renderedindex")),f=parseInt(d.attr("data-alopexgrid-columnindex")),g=c._isEditingCell(e,f);g?27===b.which?(c._cancelCellEdit(),ub(c,e,f)):13===b.which?b.ctrlKey?y(d.find("input,textarea").get(0),"\n"):(c._endCellEdit(),ub(c,e,f),xb(c,b.shiftKey?-1:1,0)):9===b.which&&(c._endCellEdit(),ub(c,e,f),xb(c,0,b.shiftKey?-1:1)):113===b.which&&(c._startCellEdit(e,f),ub(c,e,f))})),k._startCellSelectEngine(k.option.cellSelectable),k._enableHeaderSelect(!!k.option.enableHeaderSelect),"dynamic"===k.option.useTabindexOnEditable&&p.on("click"+o+k.key+k.eventns,{self:k},function(b){var c=b.data.self;a(b.target).closest(".alopexgrid").attr("data-alopexgrid")===c.key?c.state.__dynamicEditableTabindexPopulated||(c.state.__dynamicEditableTabindexPopulated=!0,c._populateEditableTabindex()):c.state.__dynamicEditableTabindexPopulated&&(c.state.__dynamicEditableTabindexPopulated=!1,c._populateEditableTabindex(!1))}),(k.option.enableContextMenu||k.option.enableDefaultContextMenu)&&l.on("contextmenu"+o,{self:k},function(b){function c(b,c,d,f){if(b.use===!1)return"";if(a.isFunction(b.use)&&b.use.call(e.$root,d,f,e)===!1)return"";if(b.seperator===!0)return'<li class="af-group-header"><hr></li>';var g=a("<li>"),h=a("<a>").appendTo(g),i=b.title;return a.isFunction(i)&&(i=i.call(e.$root,d,f,e)),h.text(e.option.contextMenuTitleMapper?e.option.contextMenuTitleMapper(i):i),h.attr("href","#"),h.on("click",{$grid:e.$root,gridInstance:e},function(a){b.processor.call(a.data.$grid,d,f,a.data.gridInstance),a.preventDefault()}),g}var e=b.data.self,f=[];if(e.option.enableDefaultContextMenu&&e.option.defaultContextMenu&&e.option.defaultContextMenu.length&&(f=f.concat(e.option.defaultContextMenu)),e.option.enableContextMenu&&e.option.contextMenu&&e.option.contextMenu.length&&(f=f.concat(e.option.contextMenu)),f.length){var g=e._getDataFromEvent(b),h=e._getCellFromEvent(b);g&&(g=a.extend(!0,{},g),g._index.column=parseInt(h.attr("data-alopexgrid-columnindex")));var i=b.pageX,j=b.pageY;a(".alopexgrid-contextmenu-wrapper-"+e.key).remove(),e.state.$contextMenuDropdown&&(e.state.$contextMenuDropdown.close().remove(),e.state.$contextMenuDropdown=null),a(document).off(".alopexgridContextMenuEvent"+e.key);var k=a("<div>"),l=(a("<div>").prop("id",d()).appendTo(k),d());k.css({"z-index":"99997",position:"absolute",left:i+"px",top:j+"px"}),k.prop("id",l),k.addClass("alopexgrid-contextmenu-wrapper-"+e.key);var m=e.state.$contextMenuDropdown=a('<ul data-type="dropdown">');if(a.each(f,function(a,b){m.append(c(b,a,g,h))}),!m.children().length)return m.remove(),void k.remove();m.appendTo(k),k.appendTo("body").addClass("alopexgrid-refer-"+e.key),k.convert(),m.open(),a(document).on("keydown.alopexgridContextMenuEvent"+e.key+e.eventns,{self:e},function(b){var c=b.data.self;27===b.keyCode&&(c.state.$contextMenuDropdown&&(c.state.$contextMenuDropdown.close().remove(),c.state.$contextMenuDropdown=null),a(document).off(".alopexgridContextMenuEvent"+c.key),ub(c))}),b.preventDefault()}}),k.option.pager&&k.$pager.on("click"+o,".pageset",{self:k},function(b){var c=b.data.self,d=this.getAttribute("href").split("#").pop();a(this).parent().removeClass("hovering"),c.pageSet(d),b.preventDefault()}).on("mouseover"+o,"div.pagination,li",function(){var b=a(this);b.siblings().removeClass("hovering"),b.addClass("hovering")}).on("mouseout"+o,"div.pagination,li",function(){a(this).removeClass("hovering").siblings().removeClass("hovering")}),k.option.autoResize&&q.on("resize"+o+k.key,{self:k,timer:null},function(a){var b=a.data.self;a.data.timer&&clearTimeout(a.data.timer),a.data.timer=setTimeout(function(){b.viewUpdate(),a.data.timer=null},b.option.autoResizeDelay)}),k._activateBoardScrollEvent()},Qb.prototype.addContextMenu=function(b,c){a.isPlainObject(b)&&b.hasOwnProperty("title")&&(a.isNumeric(c)?this.option.contextMenu.splice(c,0,b):this.option.contextMenu.push(b))},Qb.prototype.deleteContextMenu=function(a){this.option.contextMenu.splice(a,1)},Qb.prototype._populateEditableTabindex=function(b){var c=this;c.state.dynamicTabindexEnabled=b!==!1,c.$wrapper.find("input,select,textarea").prop("tabIndex",b===!1?0:function(){return this.alopexgridTabIndex=this.alopexgridTabIndex||a(this).attr("data-tabindex")})},Qb.prototype._enableDragDrop=function(){},Qb.prototype._calcCellWidth=function(){var a=this;a.state.columnWidth=0,a.state.columnWidthMap={},a.state.columnWidthExceptFixed=0,a.state.columnWidthExcepFixedMap={},a.state.columnIndexArr=[];for(var b,c=0;c<a.option.columnMapping.length;c++)b=a.option.columnMapping[c],b&&b.columnIndex>=0&&b.hidden!==!0&&(b.fixed===!0||(a.state.columnWidthExcepFixedMap[b.columnIndex]=parseInt(b.width),a.state.columnWidthExceptFixed+=parseInt(b.width)),a.state.columnWidthMap[b.columnIndex]=parseInt(b.width),a.state.columnWidth+=parseInt(b.width),a.state.columnIndexArr.push(parseInt(b.columnIndex)));a.state.standardColumnWidth=0,a.state.standardColumnWidthMap={},a.state.fixedColumnMapping.length>0?(a.state.standardColumnWidth=a.state.columnWidthExceptFixed,a.state.standardColumnWidthMap=a.state.columnWidthExcepFixedMap):(a.state.standardColumnWidth=a.state.columnWidth,a.state.standardColumnWidthMap=a.state.columnWidthMap)},Qb.prototype.import=function(b){"string"===a.type(b)&&(b=JSON.parse(b));var c=a.extend(!0,{},b.option);delete c.data;var d=a.extend(!0,[],b.data);this.updateOption(c),this.dataSet(d)},Qb.prototype.scrollOffset=function(){return this._scrollOffset()},Qb.prototype._scrollOffset=function(a){var b=this,c=a?a:{};return c.scrollTop=this.option.scroll?b.state.lastScrollTop:0,c.scrollLeft=this.option.scroll?b.state.lastScrollLeft:0,c},Qb.prototype._getGroupingRange=function(a,b){var c=this.state.groupingLookupTable;if(!c)return null;var d=c[b];if(!d)return null;var e=d[a];return e?e:null},Qb.prototype._getGroupingRangeByMapping=function(a,b){var c=b.key;return b.rowspan&&"string"==typeof b.rowspan.by&&(c=b.rowspan.by),this._getGroupingRange(a,c)};var Tb={lt:function(a,b,c){return Number(a[b])<Number(c)},lte:function(a,b,c){return Number(a[b])<=Number(c)},gt:function(a,b,c){return Number(a[b])>Number(c)},gte:function(a,b,c){return Number(a[b])>=Number(c)},equal:function(a,b,c){return String(a[b]).toLowerCase()===String(c).toLowerCase()},notequal:function(a,b,c){return String(a[b]).toLowerCase()!==String(c).toLowerCase()},contain:function(a,b,c){return String(a[b]).toLowerCase().indexOf(String(c).toLowerCase())>=0},notcontain:function(a,b,c){return String(a[b]).toLowerCase().indexOf(String(c).toLowerCase())<0},checkedList:function(a,b,c){return c.indexOf(a[b])>=0}};Qb.prototype._filterDataToFunction=function(a){var b=a.type;if(""==b)return null;var c=a.key,d=a.value;return function(a){return Tb[b](a,c,d)}},Qb.prototype._drawFilterUnit=function(a,b){var c=this,d=[],e=(a.columnIndex,a.type||""),f=a.value||"";"checkedList"===e&&(e="",f="");var g=a.key,h=["AlopexGrid.run('",c.key,"','_filterBtnEventhandler','",g,"' ,'",b,"', '",e,"', '",f,"', event);"].join("");return d.push('<input type="hidden" class="alopexgrid-filter-key" name="alopexgrid-filter-key" value="',g,'"/>'),d.push('<button class="alopexgrid-filter-dropdownbutton '+(a.filtered?"filtered":"")+'" type="button"'),d.push(' onclick="',h,'"'),d.push(">&nbsp;</button>"),d.join("")},Qb.prototype._filterBtnEventhandler=function(b,c,e,f,g){var h=this,i=a(g.target),j=i.offset();h.state.filterDropdownWrapper&&(h.state.filterDropdownWrapper.remove(),h.state.filterDropdownWrapper=null);var k=a("<div>");k.append(a("<div>").prop("id",d())),k.css({position:"absolute",left:+j.left+"px",top:j.top+i.height()+"px"});var l=d();k.prop("id",l),k.addClass("alopexgrid-filterdropdown-wrapper");var m=d()+"_"+h.key,n=a(E(h,b,e,f,m)),o=n.find(".filtertext"),p=n.find(".filterselect");a.trim(o.val()).length>0&&p.attr("disabled",!1),o[0].oldVal=f,o.on("keyup mouseup",function(){var b=this.value;a.trim(b).length>0?(this.oldVal!==b&&p.val(""),p.attr("disabled",!1)):p.val("").attr("disabled",!0)});var q=a('<div id="'+m+'">'),r=a('<div class="checkboxarea"></div>'),s=["AlopexGrid.run('",h.key,"','_setCheckedListFilter','",m,"','",c,"', event);"].join(""),t=a('<li class="af-buttonitem"></li>'),u=a('<input type="button" class="filtersubmit" data-key="'+b+'" value="적용" onclick="'+s+'"/>'),v=a('<input type="button" class="filterclose" value="닫기" />');v.click(function(){k.hide(),q.removeAlopexGrid()}),t.append(v,u),r.append(q,t),n.append(r),k.append(n),a("body").append(k),G(h,q,b,c,u);var w=Number(k.css("left").split("px")[0]),x=Number(k.css("top").split("px")[0]),y=k.width()+Number(k.css("margin-left").split("px")[0])+Number(k.css("margin-right").split("px")[0]),z=k.height()+Number(k.css("margin-top").split("px")[0])+Number(k.css("margin-bottom").split("px")[0]),A=k.offset().left-a("body").scrollLeft()+y,B=a(window).width();A>B&&(w-=A-B+10,0>w&&(w=0));var C=k.offset().top-a("body").scrollTop()+z,D=a(window).height();C>D&&(x-=C-D+10,0>x&&(x=0)),k.css({left:w+"px",top:x+"px"}),q.alopexGrid("viewUpdate"),h.state.filterDropdownWrapper=k,h.state.filterDropdown=n},Qb.prototype._setCheckedListFilter=function(b,c,d){var e=this,f=d.target?d.target:d.currentTarget,g=e._filterGetCheckedList(b);if(0==g.length)return void a(f).setEnabled(!1);e.state.filterDropdownWrapper&&(e.state.filterDropdownWrapper.hide(),a("#"+b).removeAlopexGrid());var h=g.indexOf("(Select All)"),i=!1;h>=0&&(i=!0),e._showProgress(function(){var b=e.$wrapper.find(".filter-cell-unit"),c=b.map(function(b,c){var f=e._parseFilterUnitForCheckList(c,g,i,d);return f?f.columnIndex=a(c).attr("data-alopexgrid-columnindex"):0,f||void 0});c.each(function(a,b){e.setFilter(b.columnIndex,b,!0)}),e.filterAndRedraw(),e.pageInfo()},20)},Qb.prototype._parseFilterUnitForCheckList=function(b,c,d,e){var f=this,g={},h=a(b),i=h.attr("data-alopexgrid-columnindex"),j=e.target?e.target:e.currentTarget,k=a(j).attr("data-key"),l=h.find('[name="alopexgrid-filter-key"]').val();return k!==l?null:(g.value=c,g.type=d?"remove":"checkedList","remove"==g.type?f.state.filter&&void 0!==f.state.filter[i]&&f.state.filter[i].key==k?(h.find("button").removeClass("filtered"),f.deleteFilter(i,!0),null):null:(g.key=h.find(".alopexgrid-filter-key").val(),0===g.value.length||void 0===g.value||null===g.value?null:(h.find("button").addClass("filtered"),g.filtered=!0,g)))},Qb.prototype._filterGetCheckedList=function(b){for(var c,d=this,e=[],f=a("#"+b).data(Qb.KEY_NAME),g=f.dataGet({checked:'checked="checked"'}),h=0;h<g.length;h++)if(c=g[h],"(필드 값 없음)"!==c.label){e.push(c.label);var i;if(d.state.isFilterRendered){f.state.filterRenderFuntion&&f.state.isDefaultRenderType?i=f.state.filterRenderFuntion(f.state.renderObj,c.label):f.state.filterRenderFuntion&&null!==f.state.isDefaultRenderType&&(i=f.state.filterRenderFuntion(c.label));for(var j in f.state.filterDuplicateMap)j===i&&(e=e.concat(f.state.filterDuplicateMap[j]))}}else e.push(void 0);return e},Qb.prototype._parseFilterUnit=function(b,c){var d,e=this,f={},g=a(b),h=g.attr("data-alopexgrid-columnindex"),i=c.target?c.target:c.currentTarget;d="A"==i.tagName?a(i):a(i).find(":selected");var j=d.attr("data-key"),k=g.find('[name="alopexgrid-filter-key"]').val();return j!==k?null:(f.value=e.state.filterDropdownWrapper.find(".filtertext").val(),f.type=d.attr("value"),"remove"==f.type?e.state.filter&&void 0!==e.state.filter[h]&&e.state.filter[h].key==j?(g.find("button").removeClass("filtered"),e.deleteFilter(h,!0),null):null:(f.key=g.find(".alopexgrid-filter-key").val(),""===f.value||void 0===f.value||null===f.value?null:(g.find("button").addClass("filtered"),f.filtered=!0,f)))},Qb.prototype._parseFilterHeader=function(b,c){var d=this;d.state.filterDropdownWrapper&&(d.state.filterDropdownWrapper.hide(),a("#"+b).removeAlopexGrid()),d._showProgress(function(){var b=d.$wrapper.find(".filter-cell-unit"),e=b.map(function(b,e){var f=d._parseFilterUnit(e,c);return f?f.columnIndex=a(e).attr("data-alopexgrid-columnindex"):0,f||void 0});e.each(function(a,b){d.setFilter(b.columnIndex,b,!0)}),d.calcAndRedraw(),d.pageInfo()},20)},Qb.prototype._filterCellRender=function(a,b){var c=this,d=a.columnIndex,e=document.createElement("div");if(e.className="cell filtercell"+(d===c.state.maxColumnIndex?" lastcell":""),c.state.forceRenderAll||e.setAttribute("data-alopexgrid-columnindex",d),a.key&&a.filter!==!1){var f=(c.state.filter?c.state.filter[d]:null)||{key:a.key};f.columnIndex=a.columnIndex;var g=document.createElement("div");if(g.className="filter-cell-unit",g.innerHTML=c._drawFilterUnit(f,d),c.state.forceRenderAll||g.setAttribute("data-alopexgrid-columnindex",d),b)return g;e.appendChild(g)}return e},Qb.prototype._needEditedRefresh=function(){},Qb.prototype._hasFooter=function(b){var c=this,d=c.option;return a.isPlainObject(d.footer)&&a.isArray(d.footer.footerMapping)&&d.footer.footerMapping.length?b&&d.footer.position&&d.footer.position!==b?!1:!0:!1},Qb.prototype._footerRowRender=function(b){var c=this,d=c.option;if(c._hasFooter()){d.footer.data={};for(var e={tag:"tr",attr:{styleclass:"row footerrow"},child:[]},f=0;f<=c.state.maxColumnIndex;f++)Q(c.option.columnMapping[f])&&(b&&c.option.columnMapping[f].columnIndex>b.columnLimit||(e.child[f]={tag:"td",child:"&nbsp;",attr:{styleclass:"cell footercell"+(f===c.state.maxColumnIndex?" lastcell":"")}}));for(var f=0,g=d.footer.footerMapping.length;g>f;f++){var h=d.footer.footerMapping[f],i=c._footerValueByMapping(h);if(null!==h.columnIndex&&void 0!==h.columnIndex&&!(c.isColumnHidden(h.columnIndex)||b&&h.columnIndex>b.columnLimit)){var j=A(c,h.columnIndex),k=e.child[j.columnIndex];if(k.attr["data-alopexgrid-columnindex"]=h.columnIndex,k.attr.styleclass+=" alopex-columnindex-"+h.columnIndex,h.align&&(k.attr.styleclass+=" align-"+h.align),h.styleclass){var l=h.styleclass;a.isFunction(l)&&(l=l(i,a.extend({},c.state.footerData),h)),l&&"string"==typeof l&&(k.attr.styleclass+=" "+l)}if(h.colspan){var m=h.colspan;k.attr.colspan=m}k.child=i}}for(var f=0;f<e.child.length;f++){var k=e.child[f];if(k&&k.attr.colspan)for(var n=f+1;n<f+Number(k.attr.colspan);n++)e.child[n]=null}return e}return null},Qb.prototype._footerRefresh=function(){var a=this,b=a.option;if(a._hasFooter())for(var c=a.$root.find(".footerrow"),d=0,e=b.footer.footerMapping.length;e>d;d++){var f=b.footer.footerMapping[d],g=f.columnIndex,h=a._footerValueByMapping(f);null!==g&&void 0!==g&&c.find(".alopex-columnindex-"+g).html(h)}};var Ub={sum:function(a){for(var b=this,c=I(b,a),d=0,e=0,f=0,g=b.state.data.length;g>f;f++){var h=b.state.data[f][c];isNaN(Number(h))||(d+=Number(h),e=i(e,(String(h).split(".")[1]||"").length))}return H(parseFloat(d).toFixed(e))},average:function(a){for(var b=this,c=I(b,a),d=0,e=0,f=0,g=b.state.data.length;g>f;f++){var h=b.state.data[f][c];isNaN(Number(h))||(d+=Number(h),e++)}return H(e?Math.round(d/e*10)/10:0)},stdev:function(a){for(var b=this,c=I(b,a),d=0,e=0,f=0,g=0,h=b.state.data.length;h>g;g++){var i=b.state.data[g][c];isNaN(Number(i))||(e+=Number(i),d+=Number(i)*Number(i),f++)}return H(f?Math.round(10*Math.sqrt(d/f-e/f*(e/f)))/10:0)},count:function(a){for(var b=this,c=I(b,a),d=0,e=0,f=b.state.data.length;f>e;e++){var h=b.state.data[e][c];g(h)&&h&&d++}return H(d)},countif:function(a,b){for(var c=this,d=I(c,a),e=0,f=0,g=c.state.data.length;g>f;f++){var h=c.state.data[f][d];void 0!==h&&null!==h&&h===b&&e++}return H(e)},min:function(a){for(var b=this,c=I(b,a),d=void 0,e=0,f=b.state.data.length;f>e;e++){var g=b.state.data[e][c];(void 0===d||Number(g)<Number(d))&&(d=Number(g))}return H(d)},max:function(a){for(var b=this,c=I(b,a),d=0,e=0,f=b.state.data.length;f>e;e++){var g=b.state.data[e][c];Number(g)>Number(d)&&(d=Number(g))}return H(d)},key:function(a){var b=this;b.state.footerData=b.state.footerData||{};var c=b.state.footerData[a];return g(c)?c:""}};Qb.prototype._footerValueByMapping=function(b){if("string"==typeof b.title)return b.title;var c=this,d=[];if(b.render){var e=b.render;"string"==typeof e&&(e=[e]);for(var f=0,g=e.length;g>f;f++){var h=e[f];if(a.isFunction(h))d.push(h(a.extend(!0,[],c.state.data)));else{var i=(h.match(/((^\w+)[(].+[)])/i)||[null]).pop(),j=(h.match(/[^(]*\(([^)]*)\)/)||["",null])[1],k=j?j.split(/\W+/):null;i?a.isFunction(Ub[i])&&d.push(Ub[i].apply(c,k)):d.push(h)}}}var l=d.join("");return b.key&&(c.state.footerData[b.key]=l),l&&l.length?l:"&nbsp;"},Qb.prototype._footerData=function(a,b){this.state.footerData=this.state.footerData||{},null===b||void 0===b?delete this.state.footerData[a]:this.state.footerData[a]=b},Qb.prototype.footerData=function(){var b=this,c=a.makeArray(arguments);b.state.footerData=b.state.footerData||{};var d=!1;if(a.isPlainObject(c[0]))for(var e in c[0])c[0].hasOwnProperty(e)&&(b._footerData(e,c[0][e]),d=!0);else if("string"==typeof c[0]){var f=c[0],h=c[1];if(c.length<2)return h=b.state.footerData[f],g(h)?h:null;b._footerData(f,h),d=!0}return d&&b._needEditedRefresh(),c.length?void 0:a.extend({},b.state.footerData)},Qb.prototype.sortClear=function(){var a=this;a.$wrapper.find(".headercell.sorting").removeClass("asc desc"),a.state.sortingColumn=void 0,a.state.sortingDirection=void 0,a.state.sortingMulti=void 0,a._showProgress(function(){var b=null;if(b=a._triggerGridEvent("sortClear",{paging:a.pageInfo()}),b!==!1&&a.state.columnRowspanned)for(var c in a.option.columnMapping){var d=a.option.columnMapping[c];if("asc"===d.rowspan||"desc"===d.rowspan){a.redraw();break}}},10)},Qb.prototype._noData=function(){return this.state.data&&this.state.data.length?!1:!0},Qb.prototype._sortInternalData=function(b,c,d,e){function f(b,c,d,e,f,h){var i="asc"===e?1:"desc"===e?-1:0;if(0===i)return!1;var j=!(!f&&!h);f=f||0,h=h||b.length;var k=d||"string";d===!0&&(k="string");var l="string"==typeof d?!0:!1,m=function(b,d){var e=b[c],f=d[c];if(a.isFunction(k)){var h=k(e,f)||0;return h*i}if(g.option.autoSortingType&&!l){var j=a.isNumeric(e),m=a.isNumeric(f);j&&m?(k="number",l=!0):j&&!f?(k="number",l=!0):!e&&m?(k="number",l=!0):e&&f&&!j&&!m&&(k="string",l=!0)}var n="number"==k?Number:String;(void 0===e||null===e)&&(e="number"===k?Number.NEGATIVE_INFINITY:""),(void 0===f||null===f)&&(f="number"===k?Number.NEGATIVE_INFINITY:""),"string"==typeof k&&(e=n(e),f=n(f));var o=g.state.pinnedDataIdMap?g.state.pinnedDataIdMap[b._index.id]:!1,p=g.state.pinnedDataIdMap?g.state.pinnedDataIdMap[d._index.id]:!1;if(o&&!p)return-1;if(!o&&p)return 1;var h=0;if(f>e)return-1*i;if(e>f)return 1*i;if(v)for(var q=0,r=g.state.sortingMulti.length;r>q;){var s=g.state.sortingMulti[q],t="desc"===s.sortingDirection?-1:1,u=g.state.columnIndexToKeyMap[s.sortingColumn]||s.sortingKey,w=s.sortingType||(g.state.columnIndexToMapping[s.sortingColumn]||{}).sorting||"string",x=String;if("number"===w&&(x=Number),!u)break;var y=x(b[u]),z=x(d[u]);if(y!==z)return z>y?-1*t:y>z?1*t:0;q++}return b._index.data-d._index.data||0},n=j?b.splice(f,h-f):b;return n.sort(m),j&&(n.unshift(f,0),b.splice.apply(b,n)),!0}var g=this,h=this.option;this.state.data=this.state.data||[];var i=a.isArray(b)?a.extend(!0,[],b):this.state.data,j=void 0!==c?c:Number(this.state.sortingColumn),l=null,m=d?d:this.state.sortingDirection,n=!1,o=!1,p=null,q=!1,r=[],s=0;g.state.groupRowspanned=!1,g.state.columnRowspanned=!1,delete g.state.rowspanindex,g.state.rowspanindex=null;for(var t in h.columnMapping){var u=h.columnMapping[t];!isNaN(Number(u.columnIndex))&&u.key&&s++,j===Number(u.columnIndex)&&(l=u),"always"===u.rowspan&&(q=u,p=Number(u.columnIndex)),u.rowspan&&(o=!0),(u.rowspan===!0||"always"===u.rowspan)&&r.push(u)}var v=a.isArray(g.state.sortingMulti)&&g.state.sortingMulti.length;if(!q&&m&&void 0!==j&&(!this.state.dynamicBinding||g.option.clientSortingOnDynamicDataSet))for(var t in h.columnMapping){var u=h.columnMapping[t],w=u.sorting;(w||b)&&Number(u.columnIndex)===j&&(f(i,u.key,e||w,m),n=!0)}if(q&&void 0!==j)if(p===j){var x=!1;for(var t in h.columnMapping){var u=h.columnMapping[t];if(u.key&&("asc"==u.rowspan||"desc"==u.rowspan)){x=u;break}}x&&f(i,x.key,null,x.rowspan),f(i,q.key,null,m),p===(l.rowspan?l.rowspan.by:!1)&&(f(i,l.key,null,m),_rowspanPack(i,q))}else{_rowspanPack(i,q);for(var t in h.columnMapping){var u=h.columnMapping[t];if("asc"===u.rowspan||"desc"===u.rowspan)for(var y=0,z=i.length,A=u.key;z>y;){for(var B=y,C=y+1;z>C&&i[B][q.key]===i[C][q.key];)C++;f(i,A,null,u.rowspan,B,C),y=C}}var y=0,z=i.length,A=null;for(var t in h.columnMapping)Number(h.columnMapping[t].columnIndex)===Number(j)&&(A=h.columnMapping[t].key);for(;z>y;){for(var B=y,C=y+1;z>C&&i[B][q.key]===i[C][q.key];)C++;f(i,A,null,m,B,C),y=C}}else!q||void 0!==j&&null!==j||_rowspanPack(i,q);if(g.option.grouping&&g.option.grouping.by&&g.option.grouping.useGrouping){var D=g.option.grouping.by;D=a.isArray(D)?D:[D],D[0]===!0&&(D=D.slice(1));var E={},F={};a.each(D,function(a,b){var c=F[b]={},d=0,e=i.map(function(a){var e=a[b];return void 0===c[e]?(c[e]=d++,e):void 0}),f=e.filter(function(a){return void 0!==a});E[b]=f});var G=D.length;g.option.grouping.useGroupRearrange&&i.sort(function(a,b){for(var c=0;G>c;c++){var d=D[c],e=a[d],f=b[d],g=F[d][e],h=F[d][f];if(h>g)return-1;if(g>h)return 1}return a._index.data-b._index.data}),g.state.groupRowspanned=!!g.option.grouping.useGroupRowspan,g.state.groupingLookupTable={},g.state.groupOccurrenceMap=E,g.state.groupOccurrenceOrder=F;for(var H=D.length,I=g.state.groupingLookupTable,J=[],t=0;H>t;t++)I[D[t]]=[];for(var t=0,K=i.length;K>t;t++){for(var L=i[t],M=i[t+1],N=[],O=[],P=0;H>P;P++){var Q=D[P];N.push(Q===!0?void 0:L[Q]),O.push(M?M[Q]:null),J[P]||(J[P]={from:t,value:L[Q],childGroup:[],childGroupValue:[],childGroupEndIndex:[]}),I[Q][t]=J[P]}for(var P=H-1;P>=0;P--){var R=!1;for(k=P;k>=0;k--)if(N[k]!==O[k]){R=!0;break}t===(g.state.pinnedDataIdList||[]).length-1&&g.option.hidePinnedData&&(R=!0);var S=[],T=[],Q=D[P];for(k=P-1;k>=0;k--)S.push(D[k]),T.push(L[D[k]]);if(R)for(J[P].to=t,J[P].under=S,J[P].underValue=T,J[P]=null,k=P-1;k>=0;k--)J[k].childGroup.push(Q),J[k].childGroupValue.push(L[Q]),J[k].childGroupEndIndex.push(t)}}}for(var t=i.length;t>=0;t--)i[t]||i.splice(t,1);if(void 0===b&&g._generateDataIndex(i),g._hasPinnedData()&&g.state.pinnedDataIdList.sort(function(a,b){return g.state.dataIdToIndexMap[a]-g.state.dataIdToIndexMap[b]||0}),g.option.grouping&&g.option.grouping.useGrouping&&g.option.grouping.by&&void 0===b);else if(o&&void 0===b){for(var U=[],t=0;s>t;t++)U.push(void 0);var V=1;a.each(r,function(a,b){var c=0,d=i.length;U[Number(b.columnIndex)]=[];for(var e=U[Number(b.columnIndex)],f=[];d>c;){for(var g=c,h=c+1;d>h&&i[g][b.key]===i[h][b.key];)h++;for(var j={from:g,to:h,index:V++},k=g;h>k;k++)f[k]=j;e.push(j),c=h}e.push(f)});for(var t in h.columnMapping){var u=h.columnMapping[t];if(u.rowspan&&"number"==typeof u.rowspan.by)if(u.rowspan.under){var W=U[u.rowspan.by];W=W[W.length-1];var y=0,z=i.length;U[Number(u.columnIndex)]=[];for(var X=U[Number(u.columnIndex)],Y=[];z>y;){for(var B=y,C=y+1;z>C&&i[B][u.key]===i[C][u.key]&&!(C+1>W[B].to);)C++;for(var Z={from:B,to:C,index:V++},t=B;C>t;t++)Y[t]=Z;X.push(Z),y=C}X.push(Y)}else U[u.columnIndex]=U[u.rowspan.by]}delete this.state.rowspanindex;var $=!1;for(var t in U)U[t]&&($=!0);$?(this.state.rowspanindex=U,this.state.columnRowspanned=!0):(this.state.rowspanindex=void 0,this.state.columnRowspanned=!1)}else this.state.rowspanindex=void 0,this.state.columnRowspanned=!1;return void 0!==b?i:n},Qb.prototype._dataMoveByDataindex=function(a,b){if(this.state.data&&this.state.data.length){var c=this.state.data;c.splice(b+(b>a?-1:0),0,c.splice(a,1)[0])}},Qb.prototype.dataMove=function(b,c,d){var e=this;if(!e._noData()&&!J(b)&&!J(c)){var f=e.dataGet(b),h=e.dataGet(c);if(f&&h&&f.length&&h.length&&h[0]&&h[0]._index){var i=h[0]._index.data;if(g(i)){var j=M(e,f,!0);a.each(e.state.data,function(a,b){if(b&&b._index&&i<=b._index.data){var c=0;return d===!0&&i===b._index.data&&c++,i=a+c,!1}}),i>=0&&e.state.data.splice.apply(e.state.data,[i,0].concat(j)),e.sortClear(),e.calcAndRedraw()}}}},Qb.prototype.dataScroll=function(b,c,d){var e=this;a.isFunction(c)&&(d=c,c=null);var f=0,h=0;if("string"==typeof b){if("top"===b)h=0;else if("middle"===b)h=parseInt(e.state.renderTargetDataList.length/2),e.state.refreshbodycell&&e.state.refreshbodycell.renderedDataIndexList&&(h-=parseInt(e.state.refreshbodycell.renderedDataIndexList.length/2));else if("bottom"===b)h=e.state.renderTargetDataList.length-1;else if(b.indexOf("%")>0){var i=parseInt(b.split("%")[0]);h=parseInt(e.state.renderTargetDataList.length*(i/100))}}else if("object"==typeof b&&b._index&&(f=b._index.column,h=b._index.row,void 0===h&&(h=b._index.rendered),!g(h))){var j=b._index.data;void 0===j&&b._index.id&&(j=e.state.dataIdToIndexMap[b._index.id]);var k=e.state.data[j];k&&(h=k._index.rendered)}var l=0,m=0;null!=c&&(l=null!=N(c.scrollX)?N(c.scrollX):0,m=null!=N(c.scrollY,!0)?N(c.scrollY,!0):0),null!=h&&e.state.scrollyMoveable&&O(h,m,e),null!=f&&e.state.scrollxMoveable&&P(f,l,e),(null!=h||null!=f)&&e._refreshBoard(),a.isFunction(d)&&setTimeout(function(){d()},10)},Qb.prototype._dataSetState=function(b,c,d){var e=this,f=e.dataGetByIndex(b._index);if(f){var g=null;(c.deleted===!0||f._state.deleted)&&(c.editing=!1),a.isFunction(e.option.rowOption.allowEdit)&&e.option.rowOption.allowEdit(f)===!1&&(c.editing=!1),!f._state.editing&&c.editing&&(g=Qb.trimData(f)),f=a.extend(!0,f,{_state:c||{}}),e.state.data[f._index.data]&&(g&&(e.state.data[f._index.data]._state.recent=g,f._state.recent=g),this.state.data[f._index.data]._state=f._state,f._state.editing||V(this.state.data[f._index.data]),f._state&&f._state.recent&&(f=a.extend(!0,{},f,f._state.recent)),d!==!0&&this.refreshRow({_index:{data:f._index.data}}))}},Qb.prototype.setFilter=function(b,c,e){var f=this;return c||(c=b,b=d()),g(b)||(b=d()),f.state.filter=a.extend({},f.state.filter),f.state.filter[b]=c,e!==!0&&f._showProgress(function(){f.calcAndRedraw()}),b},Qb.prototype.deleteFilter=function(b,c){var d=this;return b&&d.state.filter&&d.state.filter[b]?(delete d.state.filter[b],a.isEmptyObject(d.state.filter)&&delete d.state.filter,c||d._showProgress(function(){d.calcAndRedraw()}),!0):(d.pageInfo(),!1)},Qb.prototype.clearFilter=function(a){var b=this;b.state.filter&&(delete b.state.filter,a!==!0&&b._showProgress(function(){b.calcAndRedraw()}))},Qb.prototype.showSortDialog=function(){},Qb.prototype._isDataFolded=function(a,b){var c=this;if(c.state.folded=c.state.folded||[],a._meta){for(var d=a._groupValues,e=!1,f=!1,h=0,i=c.state.folded.length;i>h;h++){var j=c.state.folded[h];
if(j.length>d.length)return;if(j.length===d.length){for(var k=!0,l=0;l<j.length;l++)j[l]!==d[l]&&(k=!1);k&&(f=!0)}if(j.length<d.length){for(var k=!0,l=0;l<j.length;l++)j[l]!==d[l]&&(k=!1);k&&(e=!0)}}if(e)return!0;if(f)return"unfold"}else{var d=[],m=c.option.grouping.by;m[0]===!0&&(m=m.slice(1)),g(b)?b+=1:b=Number.POSITIVE_INFINITY;for(var l=0;l<m.length&&b>l;l++)d.push(String(a[m[l]]));for(var e=!1,n=!1,h=0,i=c.state.folded.length;i>h;h++){var j=c.state.folded[h];if(j.length<=d.length&&j.length<=b){for(var k=!0,l=0;l<j.length&&b>l;l++)j[l]!==d[l]&&(k=!1);k&&(Math.min(b,j.length)<d.length?e=j:n=j)}}if(c.option.grouping&&c.option.grouping.by&&c.option.grouping.by.length&&c.option.grouping.useGrouping&&!e&&n){var o=c.state.groupingLookupTable,p=o[m[n.length-1]],q=p[a._index.data],r=Math.max(1,parseInt(c.option.foldShowLength||1)),s=q.from,t=Math.min(s+Math.max(r)-1,q.to);if(a._index.data===t)return c.option.grouping.useSummary&&t-s+1===r?"unfold-line":"unfold";if(s<=a._index.data&&a._index.data<t)return"unfold-line"}if(e||n)return!0}return!1},Qb.prototype.foldGroup=function(b,c){var d=this;if(d.state.folded=d.state.folded||[],b&&d.option.grouping&&d.option.grouping.useGrouping&&a.isArray(b)&&b.length){var e=!1;a.each(d.state.folded,function(a,c){for(var d=!0,f=0,g=b.length,h=c.length;g>f||h>f;f++)if(b[f]!==c[f]){d=!1;break}return d?(e=!0,!1):void 0}),e||d.state.folded.push(a.extend(!0,[],b)),c!==!0&&d._showProgress(function(){d.calcAndRedraw()},10)}},Qb.prototype.unfoldGroup=function(b,c){var d=this;if(d.state.folded=d.state.folded||[],b&&a.isArray(b)&&b.length&&d.option.grouping&&d.option.grouping.useGrouping){var e=!1;a.each(d.state.folded,function(a,c){for(var d=!0,f=0;f<b.length||f<c.length;f++)if(b[f]!==c[f]){d=!1;break}return d?(e=a,!1):void 0}),e!==!1&&d.state.folded.splice(e,1),c!==!0&&d._showProgress(function(){d.calcAndRedraw()},10)}},Qb.prototype._generateDataIndex=function(a){var b=this,c=a||b.state.data;delete b.state.dataIdToIndexMap,b.state.dataIdToIndexMap={};for(var d=0,e=c.length;e>d;d++){var f=c[d];f._index.data=d,b.state.dataIdToIndexMap[f._index.id]=d}},Qb.prototype._getDataFromEvent=function(b){var c=a(b.target).closest(".bodycell");return c.length?this._getRenderedDataFromRenderedIndex(parseInt(c.attr("data-alopexgrid-renderedindex"))):null},Qb.prototype._getCellFromEvent=function(b){return a(b.target).closest(".cell")},Qb.prototype._renderedToDataIdList=function(){{var b=this;b.state.data}return a.map(b.state.rendered,function(a,c){return b._getRenderedDataFromRenderedIndex(a)._index.id||c})},Qb.prototype._getRenderedDataFromRenderedIndex=function(a){var b=this,c=b.state.renderTargetDataIndexList[a],d=b.state.data[c]||null;return d},Qb.prototype.columnInfo=function(b){var c=this,d=c.option,e=d.columnMapping,f=b,g=b,h=null;return a.each(e,function(c,d){var e=Number(f);return e===Number(d.columnIndex)||"string"==typeof d.key&&d.key===g||b===d?(h=a.extend(!0,{},d),!1):void 0}),h},Qb.prototype.columnGet=function(){var b=this,c=b.option.columnMapping,d=a.makeArray(arguments),e=[];return a.each(c,function(f,g){var h=Number(g.columnIndex),i=!0;if(a.each(d,function(b,d){if(a.isPlainObject(d))for(var e in d)"columnIndex"===e?h!==d[e]&&(i=!1):"hidden"===e?R(c,h)!==d[e]&&(i=!1):d[e]!==g[e]&&(i=!1)}),i){var j=b.columnInfo(g);e.push(j)}}),e},Qb.prototype.isColumnHidden=function(a){var b=this,c=b.option,d=c.columnMapping;return R(d,a)},Qb.prototype.hideCol=function(a,b){var c=this;return c.showCol(a,b,!0)},Qb.prototype.showCol=function(b,c,d){var e=this,f=e.option,h=f.columnMapping;return b===!0?(a.each(h,function(a,b){d?e.hideCol(b.key,!0):e.showCol(b.key,!0)}),void e.updateOption()):("string"==typeof b?b=b.split(","):a.isArray(b)||(b=[b]),a.each(e.option.columnMapping,function(c,e){g(e.columnIndex)&&(a.inArray(e.columnIndex,b)>=0||a.inArray(e.key,b)>=0)&&(e.hidden=d||!1)}),void(c!==!0&&e.updateOption()))},Qb.prototype.dataAdd=function(b,c){var e=this;if(e._triggerGridEvent("dataAdd",{data:b,query:c})===!1)return!1;if(b){e.state.data||(e.state.data=[]),delete e.state.editingCellInfo,delete e.state.cellSelection,e._rowSelectAllUncheck();var g=a.isArray(b)?b:[b];if(g.length){if(e.option.dataLengthLimit&&e.state.data.length+g.length>e.option.dataLengthLimit){var h=e.option.message.dataLengthLimit||"Exceed Limit.";return a.isFunction(h)&&(h=h(e.state.data.length+g.length)),void alert(h)}c&&c._index&&void 0!==c._index.row;for(var i=(e.state.data.length,!a.isEmptyObject(e.option.defaultState.dataAdd)&&e.option.defaultState.dataAdd),j=e.option.defaultState.dataAdd,k=a.isFunction(e.option.rowOption.allowEdit),l=0,m=g.length;m>l;l++){var n=g[l],o=n._state;if(n._state={edited:!1,editing:!1,selected:!1,added:!0,deleted:!1},i&&("boolean"==typeof j.edited?n._state.edited=j.edited:0,"boolean"==typeof j.editing?n._state.editing=j.editing:0,"boolean"==typeof j.selected?n._state.selected=j.selected:0,"boolean"==typeof j.added?n._state.added=j.added:0,"boolean"==typeof j.deleted?n._state.deleted=j.deleted:0),e.option.extendStateOnAdd&&o&&("boolean"==typeof o.edited?n._state.edited=o.edited:0,"boolean"==typeof o.editing?n._state.editing=o.editing:0,"boolean"==typeof o.selected?n._state.selected=o.selected:0,"boolean"==typeof o.added?n._state.added=o.added:0,"boolean"==typeof o.deleted?n._state.deleted=o.deleted:0),n._index=n._index||{},n._index.id=d(),e.state.dataFilltrimmer?e.state.dataFilltrimmer(e,n):0,e.state.dataCompositor?e.state.dataCompositor(e,n):0,k&&e.option.rowOption.allowEdit(n)===!1&&(n._state.editing=!1),e.option.setOriginalFromStart?n._original=Qb.trimObject(n):0,c&&c._index&&void 0!==c._index.data)e.state.data.splice(Number(c._index.data)+l,0,n);else if(c&&c._index&&void 0!==c._index.row){var p=e.state.rendered[c._index.row];e.state.data.splice(Number(p)+l,0,n)}else e.state.data.push(n)}e.state.dynamicBinding?"":e.sortClear();{e.state.rendered}if(e.state.renderingSuppressed)return e._sortInternalData(),e._generateRenderTarget(),void setTimeout(function(){e._triggerGridEvent("dataChanged",{api:"add",data:b,query:c})},0);e._refreshEditableCellAll(),f(),e.calcAndRedraw(),setTimeout(function(){e._triggerGridEvent("dataChanged",{api:"add",data:b,query:c})},0)}}},Qb.prototype._scrollerReset=function(){var a=this;delete a.state.lastScrollTop,delete a.state.lastScrollLeft,a.state.renderFromRenderedIndex=0,a.state.renderFromColumnIndex=0,a.state.scrollxEnd=!1,a.state.scrollyEnd=!1},Qb.prototype.dataSet=function(b,c){var e=this;if(e._triggerGridEvent("dataSet",{data:b})===!1)return!1;if(e.clearFilter(!0),delete e.state.editingCellInfo,delete e.state.cellSelection,delete e.state.rowHeightMapByDataId,delete e.state.pinnedDataIdList,delete e.state.pinnedDataIdMap,e._rowSelectAllUncheck(),e.state.rowHeightMapByDataId={},e.state.data=[],e.state.deletedData=[],!b)return void e.dataEmpty();if(!a.isArray(b)){if("object"!=typeof b)return void e.dataEmpty();b=[b]}if(e.option.dataLengthLimit&&e.state.data.length+items.length>e.option.dataLengthLimit){var f=e.option.message.dataLengthLimit||"Exceed Limit.";return a.isFunction(f)&&(f=f(e.state.data.length+items.length)),void alert(f)}for(var h=!a.isEmptyObject(e.option.defaultState.dataSet)&&e.option.defaultState.dataSet,i=e.option.defaultState.dataSet,j=a.isFunction(e.option.rowOption.allowEdit),k=0;k<b.length;k++){var l=b[k],m=l._state;l._state={edited:!1,editing:!1,selected:!1,added:!1,deleted:!1},h&&("boolean"==typeof i.edited?l._state.edited=i.edited:0,"boolean"==typeof i.editing?l._state.editing=i.editing:0,"boolean"==typeof i.selected?l._state.selected=i.selected:0,"boolean"==typeof i.added?l._state.added=i.added:0,"boolean"==typeof i.deleted?l._state.deleted=i.deleted:0),e.option.extendStateOnSet&&m&&("boolean"==typeof m.edited?l._state.edited=m.edited:0,"boolean"==typeof m.editing?l._state.editing=m.editing:0,"boolean"==typeof m.selected?l._state.selected=m.selected:0,"boolean"==typeof m.added?l._state.added=m.added:0,"boolean"==typeof m.deleted?l._state.deleted=m.deleted:0),l._index=l._index||{},l._index.id=d(),l._index.data=k,e.state.dataFilltrimmer?e.state.dataFilltrimmer(e,l):0,e.state.dataCompositor?e.state.dataCompositor(e,l):0,j&&e.option.rowOption.allowEdit(l)===!1&&(l._state.editing=!1),e.option.setOriginalFromStart?l._original=Qb.trimObject(l):0,e.state.data.push(l)}if(delete e.state.sortingColumn,delete e.state.sortingDirection,a.isPlainObject(c)){var n=a.extend({},c);if(g(n.dataLength)&&g(n.current)){var o={};o.current=Number(n.current),o.dataLength=Number(n.dataLength),o.perPage=Number(n.perPage||e.state.data.length),o.total=Number(o.dataLength&&o.perPage?(o.dataLength/o.perPage|0)+(o.dataLength%o.perPage?1:0):n.total),e.state._paddingDataLength=e.option.pager?o.perPage*(o.current-1)||0:0,e.option.paging.customPaging=o}if(g(n.sortingColumn)||g(n.sortingKey)){if(e.state.sortingColumn=Number(n.sortingColumn),!g(n.sortingColumn))for(var k=0,p=e.option.columnMapping.length;p>k;k++){var q=e.option.columnMapping[k],r=q.columnIndex;if(void 0!==r&&null!==r&&q.key===n.sortingKey){e.state.sortingColumn=Number(r);break}}e.state.sortingDirection=n.sortingDirection||"asc"}e.state.dynamicBinding=!0}else e.option.paging&&e.option.paging.customPaging&&delete e.option.paging.customPaging,e.option.defaultSortingOnDataSet&&e._processDefaultSorting(),e.state.dynamicBinding=!1,e.state._paddingDataLength=0;return e._scrollerReset(),e.state.renderingSuppressed?void setTimeout(function(){e._triggerGridEvent("dataChanged",{api:"set",data:b})},0):(c!==!0&&e.calcAndRedraw(),e._refreshEditableCellAll(),void setTimeout(function(){e._triggerGridEvent("dataChanged",{api:"set",data:b})},0))},Qb.prototype.clear=function(a){this.dataFlush(a),this.dataEmpty()},Qb.prototype.dataEmpty=function(){var a=this;if(a._triggerGridEvent("dataEmpty")===!1)return!1;a.clearFilter(!0),this.state.data=[],this.state.deletedData=[],this.state.rendered=[];var a=this;a._scrollerReset(),a.calcAndRedraw(),setTimeout(function(){a._triggerGridEvent("changed",{api:"dataEmpty"})},0)},Qb.prototype._getActualDataByIndex=function(a){var b=this;return a.hasOwnProperty("data")?b.state.data[a.data]:a.hasOwnProperty("row")?b.state.data[b.state.rendered[a.row]]:a.id?b.state.data[b.state.dataIdToIndexMap[a.id]]:null},Qb.prototype.dataGetByIndex=function(a){if(this._noData()||!a)return null;var b=this;if(a.id){var c=b.state.dataIdToIndexMap[a.id];return b.state.data[c]}return a.data>=0?b.state.data[a.data]:a.row>=0?b.state.data[b.state.renderTargetDataIndexList[a.row]]:a.rendered>=0?b.state.data[b.state.renderTargetDataIndexList[a.rendered]]:null};var Vb="__unreadable__";Qb.prototype.dataGet=function(b){var c=this,d=[],e=a.makeArray(a.isArray(b)?b:arguments);a.isArray(b)&&arguments[1]===!0&&e.push(!0);var f=arguments[arguments.length-1]===!0;if(f)for(;a.inArray(!0,e)>-1;)e.splice(a.inArray(!0,e),1);if(!c.option.leaveDeleted&&e.length){for(var g=[],h=0,i=e.length;i>h;h++)e[h]&&e[h]._state&&e[h]._state.deleted&&g.push(e[h]);if(g.length)for(var j=c.state.deletedData||[],h=0,i=j.length;i>h;h++){for(var k=j[h],l=!1,m=0,n=g.length;n>m;m++)U(c,j,h,g[m])&&(l=!0);l&&d.push(k)}}e.length||e.push({});for(var h=0,i=c.state.data.length;i>h;h++){for(var l=!1,m=0,n=e.length;n>m;m++)if(!c.state.data[h]._state.meta){if(U(c,c.state.data,h,e[m],f)){l=!0;break}if(e[m]&&e[m]._index&&e[m]._index.hasOwnProperty("row")&&c.state.rendered[e[m]._index.row]==h){l=!0;break}}if(l){var k=c.dataGetByIndex({data:h},f);d.push(k)}}return d},Qb.prototype.dataEdit=function(b,c,d){var e=this;if(b=b||{},e._triggerGridEvent("dataEdit",{data:b,query:c})===!1)return!1;if(!this._noData()){a.isArray(c)||(c=[c]);var f=Qb.trimData(b),h=[];a.each(c,function(c,d){var i=e.dataGet(d);a.isArray(i)&&i.length&&a.each(i,function(c,d){var i=d._index.data,j=d,k=Qb.trimObject(j),l=d._original,m=a.extend(!0,{_index:{},_state:{}},{_index:j._index,_state:j._state},{_index:b._index||{},_state:b._state||{}},d._state.edited?{_original:l}:{_original:k},k,f);j._state.editing&&a.isPlainObject(j._state.recent)&&(m._state.recent=a.extend({},k,Qb.trimObject(j._state.recent),f));var n=Qb.trimObject(m);if(a.isFunction(e.option.valueFilter))for(var o in n){var p=e.option.valueFilter(n[o],m);if(p===!1)return(a.isFunction(e.option.message.valueFilter)?e.option.message.valueFilter(n[o],m):e.option.message.valueFilter)||!1;("string"==typeof p||"number"==typeof p)&&(m[o]=String(p))}var q=[];for(var o in k)k[o]!==n[o]&&q.push(o);for(var o in n)n[o]!==k[o]&&a.inArray(o,q)<0&&q.push(o);var r=a.map(q,function(a){var b={key:a},c=S(e.option.columnMapping,a);return g(c)&&(b.column=c),b});if(m._prev=j,m._edited=r,e.option.fullCompareForEditedState?(m._state.edited=!1,m._original&&a.each(m._original,function(a,b){return b!==m[a]?(m._state.edited=!0,!1):void 0})):(q.length||e.option.forceEditedOnEdit)&&(m._state.edited=!0),e.state.dataCompositor?e.state.dataCompositor(e,m):0,e.state.data[i]=m,e.state.renderTargetDataList&&(e.state.renderTargetDataList[i]=m),h.push(Number(i)),e.option&&e.option.on&&e.option.on.edit){var s=e.option.on.edit;a.isFunction(s)&&(s=[s]),a.each(s,function(a,b){b.call(e,m)})}delete m._prev})}),e.option.flushOnEdit&&e.dataFlush(),h.length&&setTimeout(function(){e._triggerGridEvent("dataChanged",{api:"edit",data:b,query:c})},0),d&&d.norender===!0||e.state.renderingSuppressed||(e._refreshBodyCells({dataIndexList:h}),h.length&&e._needEditedRefresh())}},Qb.prototype.dataFlush=function(b,c){var d=this,e=this.option;if("object"==typeof b&&(c=b),c=c||{},"function"==typeof e.flushCallback||"function"==typeof b){var f=this.dataGet({_state:{edited:!0}},{_state:{added:!0}}),g=this.dataGet({_state:{deleted:!0}});"function"==typeof e.flushCallback&&e.flushCallback.call(this,f,g),"function"==typeof b&&b.call(this,f,g)}c.noCommit!==!0&&(a.each(this.state.data,function(a,b){var e=!1;b._state&&(b._state.edited||b._state.added)&&!c.leaveEdited&&(b._state.added=!1,b._state.edited=!1,e=!0),e&&(d.state.dataCompositor?d.state.dataCompositor(d,b):0,b._original=Qb.trimData(b))}),c.leaveDeleted||(d.option.leaveDeleted&&d.dataDelete({_state:{deleted:!0}},null,!0),this.state.deletedData=[]),c.leaveEdited||c.noredraw||d.calcAndRedraw())},Qb.prototype.dataRestore=function(b){var c=this,d=c.dataGet(b);if(d&&d.length){var e=J(b),f=0;a.each(d,function(b,d){var g=c.state.data[d._index.data];g._original&&a.extend(g,g._original),g._state.edited&&f++,V(g),g._state.edited=!1,e||c.refreshRow(d)}),e&&f&&c.calcAndRedraw()}},Qb.prototype.dataDelete=function(b,c,d){var e=this;if(e._triggerGridEvent(c===!0?"dataUndelete":"dataDelete",{query:b})===!1)return!1;if(!e._noData()){var f=e.dataGet(b),g=[];a.each(f,function(a,b){g.push(b._index.data)});var h=[];if(g.sort(function(a,b){var c=Number(""+a),d=Number(""+b);return d>c?1:c>d?-1:0}),e.option.leaveDeleted&&d!==!0)a.each(g,function(a,b){e.state.data[b]&&e.state.data[b]._state&&!e.state.data[b]._state.added?(e._dataSetState({_index:{data:b}},{deleted:c===!0?!1:!0},!0),e.state.dataCompositor?e.state.dataCompositor(e,e.state.data[b]):0,h.push(e.state.data[b])):(delete e.state.dataIdToIndexMap[e.state.data[b]._index.id],e.state.data.splice(b,1))});else if(c===!0){for(var i=e.state.deletedData.length-1;i>=0;i--)if(U(e,e.state.deletedData,i,b)){var j=e.state.deletedData[i];j._state.deleted=!1,e.state.data.splice(j._index.data,0,j),e.state.deletedData.splice(i,1)}}else a.each(g,function(a,b){delete e.state.dataIdToIndexMap[e.state.data[b]._index.id];var c=e.state.data.splice(b,1)[0];c._state.deleted=!0,e.state.deletedData=e.state.deletedData||[],c&&c._state&&!c._state.added&&(e.state.dataCompositor?e.state.dataCompositor(e,c):0,c._state.selected=!1,c._state.editing=!1,c._state.focused=!1,e.state.deletedData.push(c),h.push(c))});e._triggerGridEvent("dataDeleted",{list:h}),e.option.flushOnEdit&&e.dataFlush({noredraw:!0}),e.pageInfo(),e.calcAndRedraw(),setTimeout(function(){e._triggerGridEvent("dataChanged",{api:c===!0?"undelete":"delete",data:data})},0)}},Qb.prototype.dataUndelete=function(a){return this.dataDelete(a,!0)},Qb.prototype.dataFilter=function(){},Qb.prototype._hasPinnedData=function(b){var c=this;return"string"===a.type(b)?a.inArray(b,c.state.pinnedDataIdList)>=0:a.isArray(c.state.pinnedDataIdList)&&c.state.pinnedDataIdList.length},Qb.prototype.rowFix=function(a){var b=this;b.option.rowFixCount=a,b._refreshBoard(!0)},Qb.prototype.rowUnfix=function(){var a=this;a.option.rowFixCount=0,a._refreshBoard(!0)},Qb.prototype.rowPin=function(a,b){var c=this,d=b?0:a,e=a;if(g(a)&&!(0>=e-d+1)){for(var f=[],h=d;e>=h;h++){var i=c._getRenderedDataFromRenderedIndex(h);f.push({_index:{id:i._index.id}})}return c.addPin(f)}},Qb.prototype.addPin=function(b,c,d){var e=this,f=a.makeArray(arguments);return b=a.map(f,W),c=a.map(f,X)[0],d="add",e.dataPin(b,c,d)},Qb.prototype.dataPin=function(b,c,d){var e=this,f=a.makeArray(arguments);if(b=a.map(f,W),c=a.map(f,X)[0],d=a.map(f,Y)[0],"boolean"!==a.type(c)&&null!==c,a.isArray(b)||a.isPlainObject(b)&&!a.isEmptyObject(b)){var g=a.isArray(b)?e.dataGet.apply(e,b):e.dataGet(b);if(!g||!g.length)return;g=a.map(g,function(a){return a._index.id}),e.state.pinnedDataIdList="add"===d?e.state.pinnedDataIdList||[]:[],e.state.pinnedDataIdMap="add"===d?e.state.pinnedDataIdMap||{}:{};var h=[];if(a.each(g,function(b,d){if(a.inArray(d,e.state.pinnedDataIdList)<0){h.push(d),e.state.pinnedDataIdMap[d]=!0;var f={};"boolean"===a.type(c)?f[d]={editing:c}:delete f[d],e.state.pinnedDataStateMapById=a.extend({},e.state.pinnedDataStateMapById,f)}}),!h.length)return;e.state.pinnedDataIdList=e.state.pinnedDataIdList.concat(h),e.updateOption()}},Qb.prototype.dataUnpin=function(b,c){var d=this;if(d.option.rowFixCount=0,d._hasPinnedData()){if(a.isPlainObject(b)&&!a.isEmptyObject(b)){var e=d.dataGet(b);if(!e||!e.length)return;e=a.map(e,function(a){return a._index.id});var f=[];if(a.each(e,function(b,c){var e=a.inArray(c,d.state.pinnedDataIdList);e>=0&&f.push(e)}),!f.length)return;Z(d,f)}else d.state.pinnedDataIdList=!1,d.state.pinnedDataIdMap=!1;c!==!0&&d.updateOption()}},Qb.prototype._rowFocus=function(b){var c=this;c.state.focusedDataId=c.state.focusedDataId||[];var d=null;b&&b.nodeType&&b.className.indexOf("bodycell")>=0?d=c._getActualDataByIndex({id:b.getAttribute("data-alopexgrid-dataid")}):b&&b.index&&(d=c._getActualDataByIndex(b.index)),d&&!d._state.focused&&(a.each(c.state.focusedDataId,function(a,b){var d=c._getActualDataByIndex({id:b});d&&(d._state.focused=!1,c.rowElementGet({_index:{id:b}}).removeClass("focused"))}),c.state.focusedDataId=[],d._state.focused=!0,c.state.focusedDataId.push(d._index.id),c.rowElementGet({_index:{id:d._index.id}}).addClass("focused"))},Qb.prototype._rowSelectAllUncheck=function(){var a=this;a.state.selectAll=!1,a.$wrapper.find(".headercell.selector-column").find("input").prop("checked",!1)},Qb.prototype._rowSelectAll=function(b,c){var d=this;if(d.state.data&&d.state.data.length&&d.state.renderTargetDataIndexList&&d.state.renderTargetDataIndexList.length&&!d.option.rowSingleSelect&&"only"!==d.option.rowClickSelect){var e=!1;if(b){if(b=a.event.fix(b),!a(c||b.currentTarget).hasClass("selector-column"))return;"INPUT"!==b.target.tagName&&(e=!0)}var f=a(c||b.target),g=c||b.currentTarget?a(c||b.currentTarget):f.closest(".cell"),h=g.find("input"),i=h.prop("checked");e&&(i=!i);for(var j=0,k=d.state.renderTargetDataIndexList.length;k>j;j++){var l=d._getRenderedDataFromRenderedIndex(j);l&&!l._meta&&(l._state.selected=d._triggerGridEvent("dataSelect",{data:l,select:i})===!1||d.state.testRowAllowSelect&&d.option.rowOption.allowSelect(l)===!1?!1:i)}d.state.selectAll=i,d.redraw(),d._triggerGridEvent("dataChanged",{api:"select",data:a.map(d.state.rendered,function(b){return a.extend(!0,{},d.state.data[b])}),selected:i})}},Qb.prototype.rowSelect=function(b,c,d){var e=this,f=e.option;if(!e._noData()){if(d&&(d=a.event.fix(d)),d){var g=a(d.target);if(f.rowClickSelect){if("INPUT"===d.target.tagName&&!g.hasClass("selector-checkbox"))return;if("SELECT"===d.target.tagName||"TEXTAREA"===d.target.tagName)return}else if(e.option.limitSelectorColumnClickArea){if(!g.hasClass("selector-checkbox"))return!1}else if(!(g.hasClass("selector-checkbox")||g.hasClass("selector-column")||g.hasClass("selector-column-wrapper")))return;g.hasClass("selector-checkbox")&&Mb&&g.one("click",function(a){a.preventDefault()})}var h=b.nodeType?[e.state.data[b.getAttribute("data-alopexgrid-dataindex")]]:e.dataGet(b),i=null;("only"===e.option.rowClickSelect||e.option.rowSingleSelect)&&(h=[h[0]],h[0]&&(i=h[0]._index.data));for(var j=[],k=[],l=0,m=h.length;m>l;l++)if(h[l]){var n=h[l]._index.data,o=e.state.data[n];if(T(o)){n=Number(n);var p=!!o._state.selected,q="toggle"==c?!o._state.selected:!!c;if(p!==q&&j.push(n),(e._triggerGridEvent("dataSelect",{data:o,select:q})===!1||e.state.testRowAllowSelect&&e.option.rowOption.allowSelect(o)===!1)&&(q=!1),e.state.columnRowspanned&&e.option.rowspanGroupSelect)for(var r=L(e.state.rowspanindex,n),s=r.from,t=r.to,u=s;t>u;u++)e.state.data[u]._state.selected=q,e._rowSelectAllUncheck(),k.push(u);else o._state.selected=q,e._rowSelectAllUncheck(),k.push(n);e.state.dataCompositor?e.state.dataCompositor(e,o):0}}("only"===f.rowClickSelect||f.rowSingleSelect)&&a.each(e.state.data,function(a,b){!!b._state.selected!=!1&&a!==i&&(j.push(Number(a)),b._state.selected=!1,e.state.dataCompositor?e.state.dataCompositor(e,b):0)}),e._refreshBodyCells({dataIndexList:j}),e._triggerGridEvent("dataChanged",{api:"select",data:a.map(j,function(b){return a.extend(!0,{},e.state.data[b])}),selected:c})}},Qb.prototype._refreshEditableCellAll=function(){var b=this;b.option.parseNullValueCell&&a.each(b.state.data,function(a,c){c._state.editing&&!c._state._editableStarted&&b._refreshEditableCell(c._index.data,!0)})},Qb.prototype._refreshEditableCell=function(b){if(this.option.parseNullValueCell){var c=this,d=null;if("string"==typeof b){for(var e in c.state.data)if(c.state.data[e]._index&&c.state.data[e]._index.id===b){d=c.state.data[e];break}}else"number"==typeof b&&(d=c.state.data[b]);if(!d||d._state._editableStarted||!d._state.editing)return null;for(var f=[],e=0,g=c.option.columnMapping.length;g>e;e++){var h=c.option.columnMapping[e];Q(h)&&f.push(c._createCell(d,h))}var i=a(f);i.each(function(a,b){var e=b.getAttribute("data-alopexgrid-key");if(e){if(void 0!==d[e]&&null!==d[e])return;var f=v(c.option.columnMapping,{key:e},c,d);f&&c._cellEditUpdate(b,d._index.id,f)}}),d._state._editableStarted=!0,i.remove()}},Qb.prototype._getRecentData=function(b){var c=this,d=null;if("string"==typeof b){for(var e in c.state.data)if(c.state.data[e]._index&&c.state.data[e]._index.id===b){d=c.state.data[e];break}}else"number"==typeof b&&(d=c.state.data[b]);if(!d)return null;var f=a.extend(!0,{_index:d._index,_state:d._state},Qb.trimData(d),Qb.trimData(d._state.recent));return f},Qb.prototype.startEdit=function(b,c,d){var e=this;if(!this._noData()){var f=e.dataGet(b);if(f&&f.length){for(var g=[],h=0,i=f.length;i>h;h++){var j=f[h];if(j&&!j._state.deleted&&!(j._state.editing&&c!==!0||!j._state.editing&&c===!0||a.isFunction(e.option.rowOption.allowEdit)&&e.option.rowOption.allowEdit(j)===!1)){var k=j._index.data,l=[];if(e.state.columnRowspanned&&e.option.rowspanGroupEdit){var m=L(e.state.rowspanindex,k);if(m)for(var n=m.from,o=m.to,p=n;o>p;p++)l.push(Number(p));else l.push(Number(k))}else l.push(Number(k));for(var p=0,q=l.length;q>p;p++)g.push(Number(l[p])),c===!0&&(e.option.mergeEditingImmediately&&a.extend(e.state.data[k],e.state.data[k]._state._beforeEditing),V(e.state.data[k])),e._dataSetState({_index:{data:l[p]}},{editing:d===!0?!0:c===!0?!1:!0},!0)}}e.redraw(),g.length&&e._refreshEditableCellAll(),e._needEditedRefresh()}}},Qb.prototype.dataInvalidFocus=function(){var a=this,b=a.dataInvalid();if(!b)return null;var c=b._invalid&&b._invalid[0]?b._invalid[0].column:null;return a.dataScroll(b,function(){var d=a._elementGet(b,c),e=d.find("input,select,textarea");e.trigger("change"),setTimeout(function(){e.add(d).eq(0).focus()},1)}),b},Qb.prototype.dataInvalid=function(a){var b=this;return b.endEdit(a,void 0,!0)},Qb.prototype._endEditAllIfEditingExist=function(){for(var a=this,b=0,c=a.state.data.length;c>b;b++){var d=a.state.data[b];if(d&&d._state.editing){a.endEdit();break}}a._endCellEdit()},Qb.prototype.endEdit=function(b,c,d){var e=this;if(!e._noData()&&(b===!0&&(b=void 0,c=!0),!a.isArray(b)||b.length)){var f=[],h=[],i=e.dataGet(b,!0);if(i.length){for(var j=[],k=!!e.option.valueFilter,m=0,n=e.option.columnMapping.length;n>m;m++)if(e.option.columnMapping[m].valid||e.option.columnMapping[m].validate){k=!0;break}for(var o=[],m=0,n=i.length;n>m;m++){var p=i[m];if(p&&!p._state.deleted&&p._state.editing){var q=p._index.data;if(e.state.columnRowspanned&&e.option.rowspanGroupEdit){var r=L(e.state.rowspanindex,q);if(r)for(var s=r.from,t=r.to,u=s;t>u;u++)o.push(Number(u));else o.push(Number(q))}else o.push(Number(q))}}for(var v=a(),w=a(),x=Number(v.eq(0).attr("data-alopexgrid-dataindex")),y=Number(v.eq(-1).attr("data-alopexgrid-dataindex")),m=0,n=o.length;n>m;m++){var q=o[m],p=e.state.data[q];if(p&&p._state.editing){var z=q>=x&&y>=q?v.eq(q-x):a(),A=q>=x&&y>=q?w.eq(q-x):a();if(k){var B=!1,C=z.children(),D=A.children();for(var u in e.option.columnMapping){var E=!1,F=e.option.columnMapping[u];if(g(F.columnIndex)&&F.editable){var G=C.filter('[data-alopexgrid-columnindex="'+F.columnIndex+'"]');G.hasClass("cell-fixcol")&&(G=D.filter('[data-alopexgrid-columnindex="'+F.columnIndex+'"]'));var H=[],I=(p._state.recent?p._state.recent[F.key]:null)||p[F.key];if(F&&!l.call(e,F,G,I,p)&&(B=!0,E=!0,H.push("function"==typeof F.invalid?F.invalid(G,I,p):"string"==typeof F.invalid?F.invalid:null)),a.isFunction(e.option.valueFilter)){var J=e.option.valueFilter(I,p);J===!1?(B=!0,E=!0,H.push((a.isFunction(e.option.message.valueFilter)?e.option.message.valueFilter(I,p):e.option.message.valueFilter)||null)):("string"==typeof J||"number"==typeof J)&&p._state.recent&&p._state.recent.hasOwnProperty(F.key)&&(p._state.recent[F.key]=J)}G[E?"addClass":"removeClass"]("invalid"),E&&(f=f.concat(H),j.push({column:F.columnIndex,mapping:F,errorMessage:H}))}}if(B&&d===!0){var K=a.extend(!0,{},p,p._state.editing&&e.option.getEditingDataOnEvent?p._state.recent:null);return K._invalid=j,K}if(f.length){e._triggerGridEvent("invalidEdit",{data:p,messages:f});break}}if(d!==!0){var M=c===!0?!0:!1;p._state.editing=M,e.dataEdit(p._state.recent,{_index:{data:q}},{norender:!0}),V(p),e._dataSetState(p,{editing:M},!0),h.push(q),e._triggerGridEvent("endEdit",{data:p})}}}}return d===!0?null:(e.calcAndRedraw(),f.length?!1:void 0)}},Qb.prototype.cancelEdit=function(a,b){var c=this;c._noData()||(a===!0&&(a=void 0,b=!0),c.startEdit(a,!0,b))},Qb.prototype._cellIdFromData=function(a,b){return[this.key,a._index.rendered,b].join("-")},Qb.prototype._cellIdFromRendered=function(a,b){return[this.key,a,b].join("-")},Qb.prototype._isEditingCell=function(a,b){return this.state.editingCellInfo&&this.state.editingCellInfo.renderedIndex===a&&this.state.editingCellInfo.columnIndex===b?!0:!1},Qb.prototype._focusEditCell=function(b,c){var d=this,e=a("#"+d._cellIdFromRendered(b,c)),f=e.find("input,select,textarea");if(f.length)f.filter(document.activeElement).length||(f[0]!==document.activeElement?f.focus():"");else if(e.attr("tabindex")>=0)e[0]!==document.activeElement?e.focus():"";else{var g=d._getRenderedDataFromRenderedIndex(b),h=A(d,c),i=d._getGroupingRangeByMapping(g._index.data,h);if(i){var b=(i.from,g._index.rendered),j=0,k=Math.max(b,j);e=a("#"+d._cellIdFromRendered(k,c)),f=e.find("input,select,textarea"),f.length?f.filter(document.activeElement).length||f.focus():e.attr("tabindex")>=0&&e.focus()}}return e},Qb.prototype._startCellEdit=function(a,b,c){var d=this,e=(Math.max(0,d.state.rendered.length),d._getRenderedDataFromRenderedIndex(a)),f=A(d,b);if(!e||!f)return!1;if(R(f)||!f.editable||$(d,e,f))return!1;d.state.editingCellInfo;d._isEditingCell(a,b)||d._endCellEdit();var h=e[f.key];return g(h)||(h=""),d.state.editingCellInfo={renderedIndex:parseInt(a),columnIndex:parseInt(b),columnMapping:f,value:h},c===!0?null:(d._refreshBoard(!0),null)},Qb.prototype._endCellEdit=function(b,c){var d=this;if(a.isPlainObject(b)&&(d.state.editingCellInfo=b),d.state.editingCellInfo){var e=d.state.editingCellInfo,f=d._getRenderedDataFromRenderedIndex(e.renderedIndex),g=A(d,e.columnIndex);if(!f||!g)return delete d.state.editingCellInfo,null;if($(d,f,g))return delete d.state.editingCellInfo,null;var h=null,i=null;if(b!==!0){for(var j=f[g.key]!==e.value,k=!1,m=!1,n=0;n<d.option.columnMapping.length;n++){var o=d.option.columnMapping[n];R(o)&&(a.isFunction(o.refreshBy)&&(k=!0),o.refreshBy&&(m=!0))}var p=f[g.key];f._original||(f._original=Qb.trimObject(f));var q=e.value;if("string"==typeof q&&1===q.length&&160===q.charCodeAt(0)&&(q=""),!l.call(d,g,null,q,f)){delete d.state.editingCellInfo;var r=[];return"function"==typeof g.invalid?r.push(g.invalid($cell,value,f)):"string"==typeof g.invalid&&r.push(g.invalid),d._triggerGridEvent("invalidEdit",{data:f,mapping:g,messages:r}),c!==!0&&d._refreshBoard(!0),null}if(f[g.key]=q,j&&(d.option.fullCompareForEditedState?(f._state.edited=!1,f._original&&a.each(f._original,function(a,b){return b!==f[a]?(f._state.edited=!0,!1):void 0})):f._state.edited=!0,d.state.dataFilltrimmer&&d.state.dataFilltrimmer(d,f),d.state.dataCompositor&&d.state.dataCompositor(d,f)),m&&j){k&&(h=a.extend({},f,Qb.trimObject(f)),i=a.extend({},f,Qb.trimObject(f)),h[g.key]=p);for(var n=0;n<d.option.columnMapping.length;n++){var o=d.option.columnMapping[n];if(o.hasOwnProperty("refreshBy")){var s=!1,t=o.refreshBy;if(t===!0)s=!0;else if("string"==typeof t&&t===g.key)s=!0;else if(a.isArray(t)&&(a.inArray(g.key,t)>=0||a.inArray(Number(g.columnIndex),t)>=0))s=!0;else if(a.isFunction(t)){var u={};u.prevData=h,u.newData=i,u._key=o.key,u._column=o.columnIndex,u._index=a.extend({},f._index),u.mapping=o,u.done=function(){var b=d.refreshCell({_index:{data:this._index.data}},this._column);a.isFunction(this._done)?this._done():null,b?b.find("input,select,textarea").trigger("change"):null,this.complete=!0};var v=t.call(u,h,i,o,function(a){return function(){a.done()}}(u));v===!0?s=!0:"async"===v&&!function(a){a.complete||d._showProgress(function(b){a._done=b},0,!0)}(u)}s&&d.refreshCell({_index:{data:dataIndex}},o.columnIndex)}}}if(d.state.groupRowspanned&&d.option.rowspanGroupEdit&&g.rowspan){var w=d._getGroupingRangeByMapping(f._index.data,g);if(w)for(var n=w.from;n<=w.to;n++){var x=d.state.data[n][g.key]!==q;d.state.data[n][g.key]=q,x&&(d.option.fullCompareForEditedState?(d.state.data[n]._state.edited=!1,d.state.data[n]._original&&a.each(d.state.data[n]._original,function(a,b){return b!==d.state.data[n][a]?(d.state.data[n]._state.edited=!0,!1):void 0})):d.state.data[n]._state.edited=!0)}}}return d._triggerGridEvent("endCellEdit",{value:f[g.key],data:f,mapping:g}),delete d.state.editingCellInfo,c!==!0&&d._refreshBoard(!0),Ab(d),!0}return null},Qb.prototype._cancelCellEdit=function(){return this._endCellEdit(!0)};var Wb=["cell-selected","cell-selected-topline","cell-selected-bottomline","cell-selected-leftline","cell-selected-rightline","cell-selected-focus"].join(" ");Qb.prototype._startCellSelectEngine=function(b){var c=".alopexgridCellSelectEngine",d=".alopexgridCellSelectEngineMouseenter";if(this.$wrapper.off(c),this.$wrapper.off(d),this.$focusfixture.off(c),a(document).off(c+this.key),b){var e=null;this.$focusfixture.on("keydown"+c,{self:this,keytimer:{id:null}},function(b){var c=b.data.self;if(!e){var d=c.$focusfixture[0],h=b.shiftKey,i=(b.altKey,b.metaKey),j=b.ctrlKey,k=b.keyCode,l=String.fromCharCode(96<=b.keyCode&&b.keyCode<=105?b.keyCode-48:b.keyCode),m=d.renderedIndex,n=d.columnIndex,o=c._isEditingCell(m,n),p=20,q=null,r=!1;if(13===k)o&&c._endCellEdit(),xb(c,h?-1:1,0);else if(9===k)o&&c._endCellEdit(),xb(c,0,h?-1:1),b.preventDefault();else if(113===k&&c.option.cellInlineEdit){if(!o){var s=ob(c,m,n);s&&(m=s.from),c._startCellEdit(m,n);var t=tb(c,m,n).find("input,select,textarea");t.focus();var u=t.val();t.val("").val(u)}}else if(39===k){if(!o)if(h)yb(c,!1,!0,!1,!1);else{q="right";for(var v=Fb(c,n,1),w=c._getRenderedDataFromRenderedIndex(m),x=n;x>=0;x--){var y=A(c,x);
if(y&&Q(y)){var z=pb(c,w,y);if(z>x&&z>=n){v=Fb(c,z,1);break}}}wb(c,m,v,q)}}else if(37===k){if(!o)if(h)yb(c,!0,!1,!1,!1);else{q="left";for(var v=Eb(c,n,1),w=c._getRenderedDataFromRenderedIndex(m),x=n;x>=0;x--){var y=A(c,x);if(y&&Q(y)){var z=pb(c,w,y);if(z>=n){v=Eb(c,y.columnIndex,1);break}}}wb(c,m,v,q)}}else if(38===k||33===k){if(!o){var s=ob(c,m,n);s&&(m=s.from);var B=33===k?p:1;if(h)yb(c,!1,!1,B,!1);else{q="up";var C=Math.max(m-B,0);wb(c,C,n,q)}}b.preventDefault()}else if(40===k||34===k){if(!o){var s=ob(c,m,n);s&&(m=s.to);var B=34===k?p:1;if(h)yb(c,!1,!1,!1,B);else{q="down";var C=m+B;wb(c,C,n,q)}}b.preventDefault()}else if((j||i)&&"C"===l.toUpperCase()){var D=Bb(c);g(D)||(D=""),r=!0,window.clipboardData&&window.clipboardData.setData&&window.clipboardData.setData("text",String(D))}else if((j||i)&&"V"===l.toUpperCase())return void(b.data.keytimer.id&&clearTimeout(b.data.keytimer.id));if(Ab(c),c.state.cellSelection){(33===k||34===k||38===k||40===k)&&b.preventDefault();var E=c.state.cellSelection.focusRenderedIndex,F=c.state.cellSelection.focusColumnIndex,G=tb(c,E,F);b.data.keytimer.id&&clearTimeout(b.data.keytimer.id),b.data.keytimer.id=setTimeout(function(){var b=r?"":a.trim(d.innerText);d.innerHTML="";var g=A(c,F);if(b&&!c._isEditingCell(E,F)&&g&&g.editable&&c.option.cellInlineEdit){if(c._startCellEdit(E,F),G=tb(c,E,F),f(),G&&G.length){var h=G.find("input,select,textarea");h.length&&(h[0].focus(),h.val(b).change()),e=null}}else setTimeout(function(){e=null},1)},50)}}}),this.$focusfixture.on("copy"+c,{self:this},function(a){var b=a.data.self,c=Bb(b);if(g(c)||(c=""),c=String(c),a.originalEvent.clipboardData){a.preventDefault();var d="text/html";"string"==typeof c&&c.indexOf("<table")<0&&(d="text/plain"),a.originalEvent.clipboardData.setData(d,c),!c.length||c.length<100}else if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("text",c),!1}),this.$focusfixture.on("paste"+c,{self:this},function(a){var b=a.data.self,c="";if(a.originalEvent.clipboardData){if(c=a.originalEvent.clipboardData.getData("text/html"),!Db(b,c)){if(c=a.originalEvent.clipboardData.getData("text/plain"),!c||!c.length)return;var d=b.state.cellSelection.focusRenderedIndex,e=b.state.cellSelection.focusColumnIndex;return b._endCellEdit({value:c,renderedIndex:d,columnIndex:e}),void a.preventDefault()}b.$focusfixture.empty(),a.preventDefault()}else setTimeout(function(){if(c=b.$focusfixture.html(),b.$focusfixture.empty(),!Db(b,c)){if(!c||!c.length)return;var a=b.state.cellSelection.focusRenderedIndex,d=b.state.cellSelection.focusColumnIndex;return void b._endCellEdit({value:c,renderedIndex:a,columnIndex:d})}},5)});var h={id:null};this.$wrapper.on("mousedown"+c,".bodycell",{self:this},function(b){function c(a,b,c){return parseInt(Math.max(Math.min(500,Math.abs(a-b)/(5*(c||1))),1))}var e=b.data.self;if(1===b.which||3===b.which){var g=a(this);if(!(g.hasClass("editingcell")||(b.target.className||"").indexOf("alopexgrid-handle")>=0)){var i=parseInt(g.attr("data-alopexgrid-renderedindex")),j=parseInt(g.attr("data-alopexgrid-columnindex"));e._endCellEdit(),wb(e,i,j);var k=e.$wrapper.width(),l=e.$wrapper.height(),m=e.$wrapper.offset();h.id&&(clearInterval(h.id),h.id=null),Ab(e),e.$wrapper.off(d),a(document).off(d+e.key),a(document).on("mouseup"+d+e.key+e.eventns,{self:e,timer:h},function(b){var c=b.data.self;b.data.timer.id&&(clearInterval(b.data.timer.id),b.data.timer.id=null),b.data.self.$wrapper.off(d),a(document).off(d+b.data.self.key),setTimeout(function(){ub(c,null,null)},0)});a(document).on("mousemove"+d+e.key+e.eventns,{self:e,height:l,width:k,offset:m,timer:h},function(a){var b=a.data.self,d=a.data.width,e=a.data.height,f=a.data.offset,g=f.left,h=f.top,k=a.pageX,l=a.pageY,m=null,n=a.data.timer,o=25,p=b.state.headerHeight||0,q=b.option.rowFixCount,t=(b.state.fixedColumnMapping,0),u=b.state.fixedColumnWidth||0;if(q)for(var v=0;q>v;v++){var w=b.state.renderTargetDataIndexList[v];if(w>=0){var x=b.state.data[w];x&&(t+=b.state.rowHeightMapByDataId[x._index.id]||b.state.rowHeight)}}else{var y=b.state.pinnedDataIdList;if(y&&y.length)for(var v=0,z=y.length;z>v;v++){var A=y[v],w=b.state.dataIdToIndexMap[A];if(w>=0){var x=b.state.data[w];t+=b.state.rowHeightMapByDataId[A]||b.state.rowHeight}}}var B=h+p,C=B+t,D=g+u,E=80,F=hb(b),G=gb(b),H=(kb(b,i),lb(b,j),ib(b),jb(b),r(b),s(b),!1),I=!1;n.id&&(clearInterval(n.id),n.id=null),F&&C>l&&(H=!0),G&&D>k&&(I=!0),k<f.left+u+o&&!I?(m=function(){var a=c(k,f.left+u+o,8);b._scrollLeftEvent(1*a)},E=160):k>f.left+d-o&&!I?(m=function(){var a=c(k,f.left+d-o,8);b._scrollRightEvent(1*a)},E=160):l<f.top+o+p+t&&!H?m=function(){var a=c(l,f.top+o+p+t,1.5);b._scrollUpEvent(1*a)}:l>f.top+e-o&&!H&&(m=function(){var a=c(l,f.top+e-o,1.5);b._scrollDownEvent(1*a)}),m||(m=function(){n.id&&(clearInterval(n.id),n.id=null)}),a.preventDefault(),m(),n.id=setInterval(m,E)}),e.$wrapper.on("mouseenter"+d,".bodycell",{self:e},function(b){var c=b.data.self,d=c.state.cellSelection.focusColumnIndex,e=c.state.cellSelection.focusRenderedIndex,g=a(this),h=parseInt(g.attr("data-alopexgrid-renderedindex")),i=parseInt(g.attr("data-alopexgrid-columnindex")),j=(ob(c,h,i),hb(c)),k=gb(c),l=kb(c,h),m=lb(c,i),n=ib(c),o=jb(c),p=r(c),q=s(c),t=!1;f(),!j||l||o||(h=c.option.rowFixCount,c._scrollTopEvent(!0),t=!0),!k||m||n||(c._scrollLeftEvent(void 0,!0),i=c.state.visibleColumnMappingList[c.state.visibleIndexMapByColumnIndex[c.state.fixupto]+1].columnIndex||c.state.maxColumnIndex,t=!0),j||!l||o||p||(h=c.state.data[c.state.refreshbodycell.renderedDataIndexList[c.option.rowFixCount]].rendered),k||!m||n||q||(i=c.state.refreshbodycell.renderedColumnMappingList[c.state.refreshbodycell.renderedFixedColumnMappingList.length].columnIndex),t&&c._refreshBoard(),mb(c,e,d,h,i)})}}})}},Qb.prototype._enableHeaderSelect=function(b){var c=this,d=".alopexgridHeaderSelectEngine",e=d+c.key+c.key,f=d+c.key;c.$wrapper.off(d).off(f);var g=a(document);g.off(f).off(e),b===!0&&(c.state.headerSelection=c.state.headerSelection||{timer:{id:null}},c.$wrapper.on("mousedown"+d,".headercell",{self:c,info:c.state.headerSelection},function(b){var c=b.data.self;if(c.$wrapper.off(f),g.off(f),1===b.which&&!a(b.target).closest(".resizing-handle").length){var d=a(this),e=parseInt(d.attr("data-alopexgrid-columnindex"));c.$wrapper.find(".headercell").removeClass("header-selected"),b.data.info.from=e,c.$wrapper.on("mouseenter"+f,".headercell",{self:c,info:b.data.info},function(b){var c=b.data.self,d=a(this),e=parseInt(d.attr("data-alopexgrid-columnindex"));b.data.info.to=e;var f=Math.min(b.data.info.from,b.data.info.to),g=Math.max(b.data.info.from,b.data.info.to);c.$wrapper.find(".headercell").removeClass("header-selected").filter(function(){var a=this.getAttribute("data-alopexgrid-columnindex");return a&&a>=f&&g>=a}).addClass("header-selected")});var h=c.$wrapper.offset(),i=c.$wrapper.outerWidth();g.on("mousemove"+f+c.eventns,{self:c,offset:h,width:i},function(a){var b=a.data.self,c=a.data.offset,d=a.data.width,e=b.state.headerSelection.timer;a.preventDefault(),e.id&&(clearInterval(e.id),e.id=null),a.pageX-c.left<50?e.id=setInterval(function(){b._scrollLeftEvent(1)},80):c.left+d-a.pageX<50&&(e.id=setInterval(function(){b._scrollRightEvent(1)},80))}),g.on("mouseup"+f+c.eventns,{self:c,info:b.data.info},function(a){var b=a.data.self;b.$wrapper.off(f),g.off(f);var c=b.state.headerSelection.timer;c.id&&(clearInterval(c.id),c.id=null)})}}),g.on("mousedown"+e+c.eventns,{self:c,info:c.state.headerSelection},function(b){var c=a(b.target);c.closest(".alopexgrid").attr("data-alopexgrid")!==b.data.self.key?Gb(b.data.self):c.closest(".bodycell").length&&Gb(b.data.self)}))},Qb.prototype._pageDrawnIndex=function(){var a=this.option,b=this.state.data,c=0,d=b&&b.length?b.length:-1,e={};if(a.pager&&a.paging&&a.paging.perPage){var f=a.paging.total,g=a.paging.current,h=Number(a.paging.perPage);c=h*(g-1),d=0>d||0>=f?-1:c+h,b&&d>b.length+this.state._paddingDataLength&&(d=b.length+this.state._paddingDataLength),e.total=f,e.current=g,e.perPage=h}if(e.start=c,e.end=d,e.rowPadding=0,this.option.rowPadding){var i=0;i=Number("number"==typeof this.option.rowPadding?this.option.rowPadding:e.perPage),i>0&&(e.rowPadding=i-(d-c)),e.rowPadding<0&&(e.rowPadding=0)}if(this.state._paddingDataLength){var j=this.state._paddingDataLength;e.start-=j,e.end-=j}return e},Qb.prototype.sortingInfo=function(){var a=this,b={sortingKey:null};b.sortingColumn=g(a.state.sortingColumn)?Number(a.state.sortingColumn):null;for(var c=0,d=a.option.columnMapping.length;d>c;c++){var e=a.option.columnMapping[c];if(g(e.columnIndex)&&Number(e.columnIndex)===Number(a.state.sortingColumn)){b.sortingKey=e.key;break}}return b.sortingDirection=a.state.sortingDirection||null,b.sorted=g(a.state.sortingColumn),b},Qb.prototype.pageInfo=function(){return this.state.pagingInfo},Qb.prototype.pageSet=function(a){var b=this,c=b.pageInfo(),d=c.current;return"first"===a?a=1:"prev"===a?a=Math.max(d-1,1):"next"===a?a=Math.min(d+1,c.total):"last"===a&&(a=c.total),a||(a=1),a=Math.min(Math.max(1,Number(a)),c.total),b._triggerGridEvent("pageSet",{page:a,paging:c})===!1?!1:(b.option.paging.current=a,b._rowSelectAllUncheck(),b._scrollerReset(),void b.calcAndRedraw())},Qb.prototype._showProgress=function(b,c,d){var e=this;(null===c||void 0===c)&&(c=e.option.progressDelay);var f=e.$root.children("div.progress.alopexgrid-progress");f.length||(f=a("<div>"));var h=e.$root.children("div.modal.alopexgrid-progress-modal");h.length||(h=a("<div>"));var i=e.option.progressText;g(i)||(i="loading..."),f.addClass("progress alopexgrid-progress"),f.css(e.option.progressCss||{}).html(i),h.addClass("modal alopexgrid-progress-modal").css(e.option.modalCss||{}),h.appendTo(e.$root),f.appendTo(e.$root),e.state.progressStack++;var j=function(){function a(){e.state.progressStack--,e.state.progressStack<=0&&(e.state.progressStack=0,e.$root.children(".progress").remove(),f.remove(),h.remove())}return d?void b(a):(b(),void a())};null===c||void 0===c?j():setTimeout(j,c)},Qb.prototype.suppressRender=function(b){var c=this;"boolean"===a.type(b)?c.state.renderingSuppressed=b:a.isFunction(b)&&(c.state.renderingSuppressed=!0,b(),c.state.renderingSuppressed=!1)},a.fn._alopexGridInstance=function(){return Hb(this)},a.fn.removeAlopexGrid=function(){return this.each(function(){var b=Hb(this);b&&(a(window).off(b.eventns),a(document).off(b.eventns),a(document.body).off(b.eventns),a(".alopexgrid-refer-"+b.key).remove(),b.$root.remove(),delete Qb.instances[b.key],a(this).removeData(Qb.KEY_NAME))})},a.fn.alopexGrid=function(b){if(!this.length)return this;if("string"==typeof b){if(!Qb.prototype[b])throw new Error("[AlopexGrid] AlopexGrid has no method ["+b+"]");var c=void 0,d=void 0,e=a.makeArray(arguments).slice(1);return d=this.each(function(){var a=Hb(this);return a||(a=new Qb(this)),c=a[b].apply(a,e),void 0!==c?!1:void 0}),void 0!==c?c:d}return this.each(function(){var a=Hb(this);a||(a=new Qb(this,b)),a.updateOption(b)})},a.alopex&&(a.alopex.alopexGrid=Ib,a.isFunction(a.alopex.registerSetup)&&a.alopex.registerSetup("grid",Ib)),a.alopexGrid=Ib}(jQuery);